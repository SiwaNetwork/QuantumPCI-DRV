# Quantum-PCI Realistic Monitoring System

## ⚠️ ВАЖНОЕ ПРЕДУПРЕЖДЕНИЕ

**Система мониторинга ограничена возможностями ptp_ocp драйвера Linux.**

### Доступны ТОЛЬКО базовые метрики:
- ✅ PTP offset/drift
- ✅ GNSS статус синхронизации  
- ✅ SMA конфигурация
- ✅ Серийный номер

### НЕ доступны:
- ❌ Температурный мониторинг
- ❌ Мониторинг питания
- ❌ Детальный GNSS
- ❌ LED/FPGA статус

## Обзор

Система веб-мониторинга для устройств Quantum-PCI с **ограниченной** поддержкой ptp_ocp драйвера. Предоставляет мониторинг **ТОЛЬКО тех метрик**, которые реально доступны в драйвере.

## Возможности

### Веб-интерфейсы
- **📉 Реалистичный дашборд** - мониторинг ТОЛЬКО доступных метрик (адаптивный)
- **🔧 Realistic REST API** - программный интерфейс с disclaimer
- **🔌 WebSocket** - обновления базовых метрик в реальном времени
- **⚠️ Limitations API** - подробное описание ограничений

### Мониторинг метрик (РЕАЛЬНЫЕ)
- **PTP метрики**: offset (нс), drift (ppb) из sysfs
- **GNSS статус**: базовая синхронизация (SYNC/LOST)
- **SMA коннекторы**: конфигурация разъемов 1-4
- **Устройство**: серийный номер, источники времени

### Система алертов
- Настраиваемые пороги
- Уведомления в реальном времени
- Исторические данные

## Быстрый старт

### Требования
- Python 3.8+
- PCI устройство Quantum-PCI
- Загруженный драйвер ptp_ocp

### Запуск

```bash
# Установка зависимостей
pip install -r requirements.txt

# Запуск системы мониторинга
python3 quantum-pci-monitor.py
```

### Доступ
После запуска система будет доступна:
- **Realistic Dashboard**: http://localhost:8080/dashboard (с disclaimer об ограничениях)
- **Realistic API**: http://localhost:8080/api/
- **Limitations**: http://localhost:8080/api/limitations (ВАЖНО прочитать!)
- **WebSocket**: ws://localhost:8080/ws

## API Endpoints

### Основные
- `GET /api/devices` - список устройств
- `GET /api/device/<id>/status` - статус устройства
- `GET /api/metrics/extended` - расширенные метрики
- `GET /api/alerts` - активные алерты

### WebSocket
- Real-time обновления метрик
- События алертов
- Статус соединения

## Конфигурация

### Переменные окружения
```bash
export MONITORING_PORT=8080
export MONITORING_HOST=0.0.0.0
export LOG_LEVEL=INFO
```

### Настройка алертов
Алерты настраиваются в коде приложения в разделе alert thresholds.

## Разработка

### Структура проекта
```
ptp-monitoring/
├── api/                    # API и веб-интерфейсы
│   ├── quantum-pci-api.py # Основной API модуль
│   ├── dashboard.html     # Веб-интерфейс
│   └── prometheus-exporter.py # Опциональный Prometheus экспортер
├── web/                   # Дополнительные веб-ресурсы
│   └── dashboard.html     # Альтернативный интерфейс
├── quantum-pci-monitor.py # Главный скрипт запуска
├── requirements.txt       # Зависимости Python
└── README.md             # Документация
```

### Добавление новых метрик
1. Добавить функцию чтения в соответствующий модуль
2. Обновить API endpoints
3. Добавить отображение в шаблоны

## Устранение неполадок

### Распространенные проблемы
1. **Сервер не запускается** - проверить зависимости
2. **Quantum-PCI не обнаруживается** - проверить драйвер
3. **API не отвечает** - проверить логи
4. **Дашборд не загружается** - проверить JavaScript

### Логи
```bash
tail -f monitoring.log
```

## Лицензия

Система мониторинга распространяется под лицензией проекта.
