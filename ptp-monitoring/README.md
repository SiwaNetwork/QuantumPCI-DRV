# PTP Monitoring System

## Обзор

Расширенная система веб-мониторинга для устройств TimeCard с поддержкой PTP OCP драйвера. Предоставляет комплексный мониторинг состояния устройств, метрик синхронизации и системы алертов.

## Возможности

### Веб-интерфейсы
- **📉 Основной дашборд** - полный мониторинг всех подсистем
- **📱 PWA версия** - мобильная оптимизация
- **📸 Простой дашборд** - базовые метрики
- **🔧 REST API** - программный интерфейс

### Мониторинг метрик
- **PTP метрики**: смещение, задержка, частота
- **GNSS статус**: синхронизация, спутники, фикс
- **SMA коннекторы**: конфигурация, статус
- **Системные параметры**: температура, питание

### Система алертов
- Настраиваемые пороги
- Уведомления в реальном времени
- Исторические данные

## Быстрый старт

### Требования
- Python 3.8+
- PCI устройство TimeCard
- Загруженный драйвер ptp_ocp

### Запуск

```bash
# Установка зависимостей
pip install -r requirements.txt

# Запуск системы
python3 demo-extended.py
```

### Доступ
После запуска система будет доступна:
- **Dashboard**: http://localhost:8080/dashboard
- **API**: http://localhost:8080/api/
- **Simple Dashboard**: http://localhost:8080/simple-dashboard

## API Endpoints

### Основные
- `GET /api/devices` - список устройств
- `GET /api/device/<id>/status` - статус устройства
- `GET /api/metrics/extended` - расширенные метрики
- `GET /api/alerts` - активные алерты

### WebSocket
- Real-time обновления метрик
- События алертов
- Статус соединения

## Конфигурация

### Переменные окружения
```bash
export MONITORING_PORT=8080
export MONITORING_HOST=0.0.0.0
export LOG_LEVEL=INFO
```

### Настройка алертов
Алерты настраиваются в коде приложения в разделе alert thresholds.

## Разработка

### Структура проекта
```
ptp-monitoring/
├── api/                    # Основное приложение
│   ├── app.py             # Flask приложение
│   ├── timecard-*.py      # Модули мониторинга
│   └── templates/         # HTML шаблоны
├── config/                # Конфигурационные файлы
├── scripts/               # Скрипты запуска
└── requirements.txt       # Зависимости Python
```

### Добавление новых метрик
1. Добавить функцию чтения в соответствующий модуль
2. Обновить API endpoints
3. Добавить отображение в шаблоны

## Устранение неполадок

### Распространенные проблемы
1. **Сервер не запускается** - проверить зависимости
2. **Устройства не обнаруживаются** - проверить драйвер
3. **API не отвечает** - проверить логи
4. **Дашборд не загружается** - проверить JavaScript

### Логи
```bash
tail -f monitoring.log
```

## Лицензия

Система мониторинга распространяется под лицензией проекта.
