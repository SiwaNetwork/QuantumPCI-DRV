# üïê –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç: Quantum-PCI Time Keeper

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Quantum-PCI –∫–∞–∫ **—Ö—Ä–∞–Ω–∏—Ç–µ–ª—è –≤—Ä–µ–º–µ–Ω–∏** –¥–ª—è –∫–∞—Ä—Ç **–ë–ï–ó –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã—Ö –ø—Ä–∏–µ–º–Ω–∏–∫–æ–≤ GNSS**. –°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—ã—Å–æ–∫–æ—Ç–æ—á–Ω—ã–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä Quantum-PCI –¥–ª—è –∞–≤—Ç–æ–Ω–æ–º–Ω–æ–≥–æ –≤–µ–¥–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–∏ –ø—Ä–æ–ø–∞–¥–∞–Ω–∏–∏ NTP —Å–µ—Ä–≤–µ—Ä–æ–≤.

## üöÄ –ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —Å–¥–µ–ª–∞–Ω–æ)
git clone https://github.com/SiwaNetwork/QuantumPCI-DRV.git
cd QuantumPCI-DRV

# –ó–∞–ø—É—Å–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
sudo ./scripts/setup-quantum-timekeeper.sh
```

### 2. –†—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
sudo apt update
sudo apt install chrony ntpdate bc

# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
sudo cp chrony-holdover.conf /etc/chrony/chrony.conf

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
sudo chmod 666 /dev/ptp*
sudo mkdir -p /var/log/chrony
sudo chown chrony:chrony /var/log/chrony

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–ª—É–∂–±—ã
sudo systemctl restart chrony
sudo systemctl enable chrony
```

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
chronyc tracking

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –≤—Ä–µ–º–µ–Ω–∏
chronyc sources -v

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º—ã
/usr/local/bin/quantum-timekeeper-monitor.sh
```

## üìä –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –ü—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ —Å–µ—Ç–∏:
- **–û—Å–Ω–æ–≤–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏**: NTP —Å–µ—Ä–≤–µ—Ä—ã –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
- **Stratum**: 2-3
- **–¢–æ—á–Ω–æ—Å—Ç—å**: < 10 –º—Å
- **–°—Ç–∞—Ç—É—Å**: Normal

### –ü—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Å–µ—Ç–∏:
- **–û—Å–Ω–æ–≤–Ω–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫**: Quantum-PCI (PHC)
- **Stratum**: 2
- **–ê–≤—Ç–æ–Ω–æ–º–Ω–∞—è —Ä–∞–±–æ—Ç–∞**: –ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è
- **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å**: –í—ã—Å–æ–∫–∞—è (–¥—Ä–µ–π—Ñ < 100 ppm)

## üîß –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
/usr/local/bin/quantum-timekeeper-monitor.sh

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏—è
/usr/local/bin/test-timekeeper-scenario.sh

# –°—Ç–∞—Ç—É—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
chronyc tracking

# –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –≤—Ä–µ–º–µ–Ω–∏
chronyc sources -v

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–ª—É–∂–±—ã
sudo systemctl restart chrony

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
sudo tail -f /var/log/chrony/chrony.log
```

## üåê NTP —Å–µ—Ä–≤–µ—Ä –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ NTP —Å–µ—Ä–≤–µ—Ä:

- **–ü–æ—Ä—Ç**: 123
- **Stratum**: 2-3
- **–†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ —Å–µ—Ç–∏**: 192.168.0.0/16, 10.0.0.0/8, 172.16.0.0/12

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤:

```bash
# –ù–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –º–∞—à–∏–Ω–∞—Ö
sudo apt install ntpdate

# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å Quantum-PCI —Å–µ—Ä–≤–µ—Ä–æ–º
sudo ntpdate -s <IP_QUANTUM_PCI_SERVER>

# –ò–ª–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ chrony –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
echo "server <IP_QUANTUM_PCI_SERVER> iburst" | sudo tee -a /etc/chrony/chrony.conf
sudo systemctl restart chrony
```

## üö® –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### Quantum-PCI –Ω–µ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç—Å—è:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—Ä–∞–π–≤–µ—Ä–∞
lsmod | grep ptp_ocp
sudo modprobe ptp_ocp

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
ls -la /sys/class/timecard/
ls -la /dev/ptp*
```

### –ë–æ–ª—å—à–æ–π offset:
```bash
# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏
sudo chronyc makestep

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ PTP —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
# –í /etc/chrony/chrony.conf –∏–∑–º–µ–Ω–∏—Ç—å /dev/ptp0 –Ω–∞ /dev/ptp1
```

### NTP —Å–µ—Ä–≤–µ—Ä—ã –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ç–∏
ping -c 3 8.8.8.8

# –ü—Ä–æ–≤–µ—Ä–∫–∞ NTP —Å–µ—Ä–≤–µ—Ä–æ–≤
ntpdate -q 0.pool.ntp.org
```

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **–ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ**: `docs/guides/quantum-pci-timekeeper-guide.md`
- **–í–µ–±-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: `quantum-pci-monitoring/`
- **API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: http://localhost:8080/api/

## üéØ –°—Ü–µ–Ω–∞—Ä–∏–π —Ä–∞–±–æ—Ç—ã

1. **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é**: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å NTP —Å–µ—Ä–≤–µ—Ä–∞–º–∏ –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
2. **–ü—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Å–µ—Ç–∏**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ Quantum-PCI
3. **–ê–≤—Ç–æ–Ω–æ–º–Ω–∞—è —Ä–∞–±–æ—Ç–∞**: –í—ã—Å–æ–∫–æ—Ç–æ—á–Ω—ã–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –≤–µ–¥–µ—Ç –≤—Ä–µ–º—è
4. **–ü—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å–µ—Ç–∏**: –í–æ–∑–≤—Ä–∞—Ç –∫ NTP —Å–µ—Ä–≤–µ—Ä–∞–º —Å –∫–æ—Ä—Ä–µ–∫—Ü–∏–µ–π

## ‚úÖ –ì–æ—Ç–æ–≤–æ!

–°–∏—Å—Ç–µ–º–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ –∫–∞–∫ –Ω–∞–¥–µ–∂–Ω—ã–π —Ö—Ä–∞–Ω–∏—Ç–µ–ª—å –≤—Ä–µ–º–µ–Ω–∏ —Å –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–º —Ä–µ–∂–∏–º–æ–º –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Å–µ—Ç–µ–≤–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è.

