### –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏ Quantum‚ÄëPCI

–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞: 2.0  ‚Ä¢  –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è –ø–ª–∞—Ç—ã Quantum‚ÄëPCI –ø–æ–¥ Linux. –í–∫–ª—é—á–µ–Ω—ã –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –¥—Ä–∞–π–≤–µ—Ä—É, —Ä–∞–±–æ—Ç–µ —Å –ø—Ä–æ—à–∏–≤–∫–∞–º–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ Chrony/PTP.

---

### 1. –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∏ –æ–±–ª–∞—Å—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è

–ü–ª–∞—Ç–∞ Quantum‚ÄëPCI –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è –≤—ã—Å–æ–∫–æ—Ç–æ—á–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ø–æ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞–º PTP/IEEE‚Äë1588 –∏ NTP. –ù–∞—Å—Ç–æ—è—â–µ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –æ–ø–∏—Å—ã–≤–∞–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫—É, –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ, —É—Å—Ç–∞–Ω–æ–≤–∫—É –¥—Ä–∞–π–≤–µ—Ä–∞, —Ä–∞–±–æ—Ç—É —Å –ø—Ä–æ—à–∏–≤–∫–∞–º–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫—É —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –≤ Linux.

---

### 2. –ö–æ–º–ø–ª–µ–∫—Ç –ø–æ—Å—Ç–∞–≤–∫–∏

- **–ü–ª–∞—Ç–∞ Quantum‚ÄëPCI**: 1 —à—Ç.
- **–ê–Ω—Ç–µ–Ω–Ω–∞/–∫–∞–±–µ–ª—å GNSS** (–µ—Å–ª–∏ –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω–æ –∫–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏–µ–π): 1 —à—Ç.
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.

---

### 3. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

#### –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏

**–§–∏–∑–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- **–§–æ—Ä–º-—Ñ–∞–∫—Ç–æ—Ä**: PCIe x1 (–º–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∏ —Å–æ–≤–º–µ—Å—Ç–∏–º —Å x4/x8/x16)
- **–†–∞–∑–º–µ—Ä—ã**: 120 √ó 68 –º–º (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è PCIe –∫–∞—Ä—Ç–∞)
- **–ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ**: 3.3V/5V, –¥–æ 15W (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏)
- **–†–∞–±–æ—á–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞**: -40¬∞C –¥–æ +85¬∞C
- **–í–ª–∞–∂–Ω–æ—Å—Ç—å**: 5% –¥–æ 95% (–±–µ–∑ –∫–æ–Ω–¥–µ–Ω—Å–∞—Ü–∏–∏)

**–í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- **–¢–æ—á–Ω–æ—Å—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏**: ¬±100 –Ω—Å (—Å GNSS), ¬±1 –º–∫—Å (holdover)
- **–î—Ä–µ–π—Ñ —á–∞—Å–æ–≤**: < 1√ó10‚Åª¬π¬≤ (—Å OCXO), < 1√ó10‚Åª‚Åπ (—Å TCXO)
- **–í—Ä–µ–º—è –∑–∞—Ö–≤–∞—Ç–∞ GNSS**: < 30 —Å–µ–∫ (—Ö–æ–ª–æ–¥–Ω—ã–π —Å—Ç–∞—Ä—Ç), < 1 —Å–µ–∫ (–≥–æ—Ä—è—á–∏–π —Å—Ç–∞—Ä—Ç)
- **–í—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è**: > 24 —á–∞—Å–∞ (OCXO), > 1 —á–∞—Å (TCXO)

**–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –∏ —Ä–∞–∑—ä–µ–º—ã:**
- **PCIe**: x1 —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏, Gen 1/2/3
- **SMA —Ä–∞–∑—ä–µ–º—ã**: 4√ó –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º—ã—Ö + 1√ó GNSS –∞–Ω—Ç–µ–Ω–Ω–∞
- **–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ—Ä—Ç—ã**: GNSS, MAC, NMEA (UART)
- **I2C**: –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–Ω–µ—à–Ω–∏–º–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏
- **SPI**: –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å flash-–ø–∞–º—è—Ç—å—é

#### –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

**–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã:**
- **Ubuntu**: 20.04 LTS, 22.04 LTS, 24.04 LTS (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- **Debian**: 11 (Bullseye), 12 (Bookworm)
- **CentOS/RHEL**: 8, 9
- **Fedora**: 35+
- **openSUSE**: Leap 15.4+
- **–Ø–¥—Ä–æ**: Linux ‚â• 5.4 (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 5.15+)

**–ê–ø–ø–∞—Ä–∞—Ç–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- **–ü—Ä–æ—Ü–µ—Å—Å–æ—Ä**: x86_64, ARM64
- **–ü–∞–º—è—Ç—å**: –º–∏–Ω–∏–º—É–º 512 –ú–ë RAM
- **–î–∏—Å–∫**: 100 –ú–ë —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞
- **PCIe**: —Å–ª–æ—Ç x1 (—ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏), —Å–æ–≤–º–µ—Å—Ç–∏–º —Å x4/x8/x16 (–º–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∏)
- **–ü—Ä–∞–≤–∞**: root/`sudo` –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –¥—Ä–∞–π–≤–µ—Ä–æ–≤ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

**–°–µ—Ç–µ–≤—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- **Ethernet**: 1 –ì–±–∏—Ç/—Å (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è) —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π hardware timestamping
- **–ü–æ—Ä—Ç—ã**: UDP 319 (PTP Event), UDP 320 (PTP General)
- **Multicast**: –ø–æ–¥–¥–µ—Ä–∂–∫–∞ IGMP –¥–ª—è PTP —Å–æ–æ–±—â–µ–Ω–∏–π

#### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ BIOS/UEFI

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:**
- **–î–ª—è Intel CPU**: 
  - VT-d (Virtualization Technology for Directed I/O)
  - VT-x (Virtualization Technology)
  - SR-IOV (Single Root I/O Virtualization)
- **–î–ª—è AMD CPU**: 
  - IOMMU (Input-Output Memory Management Unit)
  - AMD-V (Virtualization)

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:**
- **Power Management**: –æ—Ç–∫–ª—é—á–∏—Ç—å C-states, P-states
- **CPU Frequency**: —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —á–∞—Å—Ç–æ—Ç–∞ (–æ—Ç–∫–ª—é—á–∏—Ç—å Turbo Boost)
- **PCIe**: –≤–∫–ª—é—á–∏—Ç—å ASPM (Active State Power Management)
- **Secure Boot**: –æ—Ç–∫–ª—é—á–∏—Ç—å –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–µ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã—Ö –º–æ–¥—É–ª–µ–π

#### –ü–∞–∫–µ—Ç—ã –¥–ª—è —Å–±–æ—Ä–∫–∏ –∏ —Ä–∞–±–æ—Ç—ã

**Ubuntu/Debian:**
```bash
sudo apt-get update
sudo apt-get install -y \
    build-essential \
    linux-headers-$(uname -r) \
    libncurses-dev \
    flex \
    bison \
    openssl \
    vim \
    libssl-dev \
    dkms \
    libelf-dev \
    libudev-dev \
    libpci-dev \
    libiberty-dev \
    autoconf \
    zstd \
    linuxptp \
    chrony \
    ethtool \
    pciutils \
    kmod \
    i2c-tools \
    gpsd \
    gpsd-clients \
    python3-gps \
    tio \
    python3-pip
```

**CentOS/RHEL/Fedora:**
```bash
sudo yum groupinstall -y "Development Tools"
sudo yum install -y \
    kernel-devel \
    kernel-headers \
    ncurses-devel \
    flex \
    bison \
    openssl-devel \
    dkms \
    elfutils-libelf-devel \
    libudev-devel \
    pciutils-devel \
    autoconf \
    zstd \
    linuxptp \
    chrony \
    ethtool \
    pciutils \
    kmod \
    i2c-tools \
    gpsd \
    gpsd-clients \
    python3-gps \
    tio \
    python3-pip
```

#### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —è–¥—Ä–∞ (–¥–ª—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã)

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏ —è–¥—Ä–∞:**
```
CONFIG_I2C_XILINX=m
CONFIG_MTD=y
CONFIG_MTD_SPI_NOR=m
CONFIG_SPI=y
CONFIG_SPI_ALTERA=m
CONFIG_SPI_BITBANG=m
CONFIG_SPI_MASTER=y
CONFIG_SPI_MEM=y
CONFIG_SPI_XILINX=m
CONFIG_I2C=y
CONFIG_I2C_OCORES=m
CONFIG_IKCONFIG=y
CONFIG_EEPROM_AT24=m
```

**PTP –∏ –≤—Ä–µ–º–µ–Ω–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è:**
```
CONFIG_PTP_INTEL_PMC_TGPIO=y    # TGPIO –ø–æ–¥–¥–µ—Ä–∂–∫–∞
CONFIG_PCIE_PTM=y               # PTM –ø–æ–¥–¥–µ—Ä–∂–∫–∞
CONFIG_PTP_1588_CLOCK=y         # PTP –ø–æ–¥—Å–∏—Å—Ç–µ–º–∞
CONFIG_PPS=y                    # Pulse Per Second
CONFIG_PPS_CLIENT_LDISC=y       # PPS line discipline
```

**–°–µ—Ç–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
```
CONFIG_NETWORK_FILESYSTEMS=y
CONFIG_NFS_FS=y
CONFIG_CIFS=y
CONFIG_IP_MULTICAST=y
CONFIG_IP_MROUTE=y
```

**Real-time –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
```
CONFIG_PREEMPT=y                # Preemptible kernel
CONFIG_HIGH_RES_TIMERS=y        # High resolution timers
CONFIG_NO_HZ=y                  # Tickless system
CONFIG_CPU_FREQ_GOV_PERFORMANCE=y
```

#### –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã:**
- **PTP**: IEEE 1588-2008, IEEE 1588-2019
- **NTP**: RFC 5905, RFC 5906, RFC 5907
- **GNSS**: GPS, GLONASS, Galileo, BeiDou
- **–í—Ä–µ–º–µ–Ω–Ω—ã–µ –∫–æ–¥—ã**: IRIG-B, DCF77, SMPTE
- **–°–µ—Ç–µ–≤—ã–µ**: Ethernet 10/100/1000 –ú–±–∏—Ç/—Å

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Windows –Ω–µ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç—Å—è –≤ –¥–∞–Ω–Ω–æ–º —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–µ
- –ú–∞–∫—Å–∏–º—É–º 4 SMA —Ä–∞–∑—ä–µ–º–∞ –Ω–∞ –∫–∞—Ä—Ç—É
- –û–¥–∏–Ω GNSS –ø—Ä–∏–µ–º–Ω–∏–∫ –Ω–∞ –∫–∞—Ä—Ç—É
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ IPv6 (—Ç–æ–ª—å–∫–æ IPv4 —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

---

### 4. –ú–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

- –ü–µ—Ä–µ–¥ —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π –æ—Ç–∫–ª—é—á–∞–π—Ç–µ –ø–∏—Ç–∞–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞ –∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–Ω—Ç–∏—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ä–µ–¥—Å—Ç–≤–∞.
- –ò–∑–±–µ–≥–∞–π—Ç–µ –∏–∑–≥–∏–±–∞ –ø–ª–∞—Ç—ã, —É—Å–∏–ª–∏–π –Ω–∞ —Ä–∞–∑—ä—ë–º—ã –∏ –∫–∞–±–µ–ª–∏.
- –ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –ø—Ä–æ—à–∏–≤–∫–∞–º–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ –ø–∏—Ç–∞–Ω–∏–µ –∏ –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞–π—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–ø–∏—Å–∏.

---

### 5. –û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–¥–µ–ª–∏—è –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ü–ª–∞—Ç–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π PCIe‚Äë–∫–∞—Ä—Ç—É –≤—ã—Å–æ–∫–æ—Ç–æ—á–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â—É—é:
- –ê–ø–ø–∞—Ä–∞—Ç–Ω—ã–µ —á–∞—Å—ã PHC, –¥–æ—Å—Ç—É–ø–Ω—ã–µ –≤ Linux –∫–∞–∫ `/dev/ptpX`.
- –í—Ö–æ–¥/–≤—ã—Ö–æ–¥ —Å–∏–≥–Ω–∞–ª–æ–≤ —Ç–æ—á–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 1PPS –∏ 10MHz) —á–µ—Ä–µ–∑ SMA‚Äë—Ä–∞–∑—ä—ë–º—ã.
- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∫–æ–¥–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, IRIG‚ÄëB/DCF), –∑–∞–≤–∏—Å—è—â–∏–µ –æ—Ç –∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–π —Ä–µ–≤–∏–∑–∏–∏.
- –î–∏—Å—Ü–∏–ø–ª–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã—Å–æ–∫–æ—Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ (OCXO/CSAC/TCXO) –æ—Ç GNSS –∏–ª–∏ –≤–Ω–µ—à–Ω–∏—Ö –æ–ø–æ—Ä.

–¢–∏–ø–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:
- –õ–æ–≥–∏–∫–∞ –Ω–∞ –ü–õ–ò–°/FPGA —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç PHC, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç PPS/10MHz –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç —Å –¥—Ä–∞–π–≤–µ—Ä–æ–º.
- GNSS‚Äë–ø—Ä–∏—ë–º–Ω–∏–∫ (–ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏) –¥–∞—ë—Ç –æ–ø–æ—Ä–Ω—ã–π PPS/TOD.
- –í—ã—Å–æ–∫–æ—Å—Ç–∞–±–∏–ª—å–Ω—ã–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —É–¥–µ—Ä–∂–∞–Ω–∏–µ (holdover) –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ –æ–ø–æ—Ä—ã.
- –î—Ä–∞–π–≤–µ—Ä —è–¥—Ä–∞ —ç–∫—Å–ø–æ–Ω–∏—Ä—É–µ—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –≤—Ä–µ–º–µ–Ω–∏, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Ä–∞–±–æ—Ç–∞—é—Ç —á–µ—Ä–µ–∑ `linuxptp`/`chrony`.
- **PTM (Precision Time Measurement)**: —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∫–∞—Ä—Ç—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç PCIe PTM –¥–ª—è –≤—ã—Å–æ–∫–æ—Ç–æ—á–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π.
- **TGPIO (Time-Aware GPIO)**: –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∫–∞—Ä—Ç—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –≤—Ä–µ–º–µ–Ω–Ω–æ-—É–ø—Ä–∞–≤–ª—è–µ–º—ã–µ GPIO –¥–ª—è –ø—Ä–µ—Ü–∏–∑–∏–æ–Ω–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞ —Å–∏–≥–Ω–∞–ª–æ–≤.

---

### 6. –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –∏ —Ä–∞–∑—ä—ë–º—ã

#### PCIe –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- **–°–ª–æ—Ç**: —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏ x1 (–º–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∏–π —Ä–∞–∑—ä—ë–º x4/x8/x16 —Å–æ–≤–º–µ—Å—Ç–∏–º)
- **–û–°**: Linux
- **–£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –≤ —Å–∏—Å—Ç–µ–º–µ**: PHC `/dev/ptpX`, –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ ‚Äî PPS `/dev/ppsY`

#### SMA —Ä–∞–∑—ä—ë–º—ã
–ö–∞—Ä—Ç–∞ –∏–º–µ–µ—Ç **4 –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º—ã—Ö SMA —Ä–∞–∑—ä—ë–º–∞** + **1 GNSS –∞–Ω—Ç–µ–Ω–Ω—ã–π –≤—Ö–æ–¥**.

**–ë–∞–∑–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ:**
- **ANT1** (INPUT): Default 10MHz ‚Äî –≤—Ö–æ–¥ –æ–ø–æ—Ä–Ω–æ–π —á–∞—Å—Ç–æ—Ç—ã 10 –ú–ì—Ü
- **ANT2** (INPUT): Default 1 PPS ‚Äî –≤—Ö–æ–¥ –æ–ø–æ—Ä–Ω–æ–≥–æ –∏–º–ø—É–ª—å—Å–∞ 1PPS  
- **ANT3** (OUTPUT): Default 10MHz ‚Äî –≤—ã—Ö–æ–¥ —á–∞—Å—Ç–æ—Ç—ã 10 –ú–ì—Ü –æ—Ç FPGA
- **ANT4** (OUTPUT): Default 1 PPS ‚Äî –≤—ã—Ö–æ–¥ –∏–º–ø—É–ª—å—Å–∞ 1PPS –æ—Ç FPGA
- **GNSS**: SMA‚Äë–≤—Ö–æ–¥ –ø–æ–¥ –∞–∫—Ç–∏–≤–Ω—É—é GNSS –∞–Ω—Ç–µ–Ω–Ω—É

#### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ SMA
–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–≤—Ö–æ–¥/–≤—ã—Ö–æ–¥) –∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ SMA —Ä–∞–∑—ä—ë–º–æ–≤ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–∑–º–µ–Ω–µ–Ω–æ —á–µ—Ä–µ–∑:
- **TC SMA Selector IP core** (2 AXI slaves)
- –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å sysfs: `/sys/class/timecard/ocp0/sma*_in` –∏ `/sys/class/timecard/ocp0/sma*_out`

–ü—Ä–∏–º–µ—Ä—ã –∫–æ–º–∞–Ω–¥ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞–Ω–∏—è:
```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤
cat /sys/class/timecard/ocp0/available_sma_inputs
cat /sys/class/timecard/ocp0/available_sma_outputs

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SMA1 –∫–∞–∫ –≤—Ö–æ–¥ –¥–ª—è 10MHz
echo "10MHz" > /sys/class/timecard/ocp0/sma1

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SMA4 –∫–∞–∫ –≤—ã—Ö–æ–¥ PPS
echo "PPS" > /sys/class/timecard/ocp0/sma4

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
cat /sys/class/timecard/ocp0/sma1
cat /sys/class/timecard/ocp0/sma4
```

#### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—é
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **50‚Äë–æ–º–Ω—ã–µ –∫–æ–∞–∫—Å–∏–∞–ª—å–Ω—ã–µ –∫–∞–±–µ–ª–∏** –∏ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥–Ω–∏–∫–∏
- –°–æ–±–ª—é–¥–∞–π—Ç–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –∏ —É—Ä–æ–≤–Ω–∏ —Å–∏–≥–Ω–∞–ª–æ–≤
- –ò–∑–±–µ–≥–∞–π—Ç–µ –¥–ª–∏–Ω–Ω—ã—Ö —Ç—Ä–∞—Å—Å –≤–æ–∑–ª–µ –í–ß‚Äë–∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –ø–æ–º–µ—Ö
- –î–ª—è —Ç–æ—á–Ω—ã—Ö –∏–∑–º–µ—Ä–µ–Ω–∏–π —É—á–∏—Ç—ã–≤–∞–π—Ç–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –∫–∞–±–µ–ª–µ–π –∏ –∫–∞–ª–∏–±—Ä—É–π—Ç–µ –∏—Ö —á–µ—Ä–µ–∑ sysfs

---

### 7. –°–≤–µ—Ç–æ–≤–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è

–ö–∞—Ä—Ç–∞ –∏–º–µ–µ—Ç 4 —Å–≤–µ—Ç–æ–¥–∏–æ–¥–∞ (LED1-LED4), –∫–æ—Ç–æ—Ä—ã–µ —É–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ FPGA –∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:

#### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Å–≤–µ—Ç–æ–¥–∏–æ–¥–æ–≤
- **LED1**: –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Ä–∞–±–æ—Ç—ã FPGA ‚Äî –º–∏–≥–∞–µ—Ç —Å —á–∞—Å—Ç–æ—Ç–æ–π –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —á–∞—Å–æ–≤ FPGA (50MHz)
- **LED2**: –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Ç–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è PCIe ‚Äî –º–∏–≥–∞–µ—Ç —Å —á–∞—Å—Ç–æ—Ç–æ–π PCIe clock (62.5MHz)  
- **LED3**: PPS –æ—Ç FPGA ‚Äî –º–∏–≥–∞–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ —Å 1PPS –æ—Ç –ª–æ–∫–∞–ª—å–Ω—ã—Ö —á–∞—Å–æ–≤ (PPS Master)
- **LED4**: PPS –æ—Ç MAC ‚Äî –º–∏–≥–∞–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ —Å 1PPS –æ—Ç MAC (—á–µ—Ä–µ–∑ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –±—É—Ñ–µ—Ä)

#### –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø–æ —Å–≤–µ—Ç–æ–¥–∏–æ–¥–∞–º
**–ù–æ—Ä–º–∞–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞:**
- LED1: –±—ã—Å—Ç—Ä–æ–µ –º–∏–≥–∞–Ω–∏–µ (50MHz) ‚Äî FPGA —Ä–∞–±–æ—Ç–∞–µ—Ç
- LED2: –±—ã—Å—Ç—Ä–æ–µ –º–∏–≥–∞–Ω–∏–µ (62.5MHz) ‚Äî PCIe —Ç–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –Ω–æ—Ä–º–µ
- LED3: –º–∏–≥–∞–Ω–∏–µ 1 —Ä–∞–∑ –≤ —Å–µ–∫—É–Ω–¥—É ‚Äî PPS –æ—Ç FPGA –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è
- LED4: –º–∏–≥–∞–Ω–∏–µ 1 —Ä–∞–∑ –≤ —Å–µ–∫—É–Ω–¥—É ‚Äî PPS –æ—Ç MAC –ø–æ—Å—Ç—É–ø–∞–µ—Ç

**–ü—Ä–æ–±–ª–µ–º—ã:**
- LED1 –Ω–µ –º–∏–≥–∞–µ—Ç ‚Äî –ø—Ä–æ–±–ª–µ–º–∞ —Å FPGA –∏–ª–∏ –ø–∏—Ç–∞–Ω–∏–µ–º
- LED2 –Ω–µ –º–∏–≥–∞–µ—Ç ‚Äî –ø—Ä–æ–±–ª–µ–º–∞ —Å PCIe —Ç–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- LED3 –Ω–µ –º–∏–≥–∞–µ—Ç ‚Äî –Ω–µ—Ç PPS –æ—Ç –ª–æ–∫–∞–ª—å–Ω—ã—Ö —á–∞—Å–æ–≤ FPGA
- LED4 –Ω–µ –º–∏–≥–∞–µ—Ç ‚Äî –Ω–µ—Ç PPS –æ—Ç MAC –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ —Å –≤—Ö–æ–¥–Ω—ã–º —Å–∏–≥–Ω–∞–ª–æ–º

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—ã
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —á–µ—Ä–µ–∑ dmesg
dmesg | grep -i "ptp_ocp\|led"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ PPS —Å–∏–≥–Ω–∞–ª–æ–≤
cat /sys/class/timecard/ocp0/clock_source
cat /sys/class/timecard/ocp0/gnss_sync

# –ü—Ä–æ–≤–µ—Ä–∫–∞ PTP —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
ls -la /dev/ptp*
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –°–≤–µ—Ç–æ–¥–∏–æ–¥—ã –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –Ω–∞–ø—Ä—è–º—É—é –∫ FPGA (–Ω–µ —á–µ—Ä–µ–∑ AXI GPIO Ext), –ø–æ—ç—Ç–æ–º—É –∏—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ—Ç—Ä–∞–∂–∞–µ—Ç –∞–ø–ø–∞—Ä–∞—Ç–Ω—É—é —Ä–∞–±–æ—Ç—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

---

### 8. –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã

- –†–µ–∂–∏–º Grandmaster: –∫–∞—Ä—Ç–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –æ—Ç GNSS –∏–ª–∏ –≤–Ω–µ—à–Ω–µ–≥–æ 1PPS/10MHz –∏ —Ä–∞–∑–¥–∞—ë—Ç –≤—Ä–µ–º—è –ø–æ PTP.
- –†–µ–∂–∏–º Ordinary/Slave: –∫–∞—Ä—Ç–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤—Ä–µ–º—è –ø–æ PTP, –º–æ–∂–µ—Ç –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å PHC ‚Üí —Å–∏—Å—Ç–µ–º–Ω—ã–µ —á–∞—Å—ã.
- –†–µ–∂–∏–º Boundary: –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ –º–æ–∂–µ—Ç —Ä–µ—Ç—Ä–∞–Ω—Å–ª–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–º—è –º–µ–∂–¥—É —Å–µ–≥–º–µ–Ω—Ç–∞–º–∏ —Å–µ—Ç–∏.
- –£–¥–µ—Ä–∂–∞–Ω–∏–µ (holdover): –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ –æ–ø–æ—Ä—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∑–∞ —Å—á—ë—Ç OCXO/CSAC; –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ —Ç–æ—á–Ω–æ—Å—Ç—å –∑–∞–≤–∏—Å—è—Ç –æ—Ç –∞–ø–ø–∞—Ä–∞—Ç—É—Ä—ã.

---

### 9. –¢–∏–ø–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏

1) Grandmaster c GNSS:
   - –ü–æ–¥–∫–ª—é—á–∏—Ç–µ GNSS‚Äë–∞–Ω—Ç–µ–Ω–Ω—É, –¥–æ–∂–¥–∏—Ç–µ—Å—å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è.
   - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ PTP‚Äë–¥–æ–º–µ–Ω –∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –≤ `ptp4l` –¥–ª—è —Ä–æ–ª–∏ –º–∞—Å—Ç–µ—Ä–∞.
   - –ü—Ä–∏–º–µ—Ä (—Ñ—Ä–∞–≥–º–µ–Ω—Ç `ptp4l.conf`):

```ini
[global]
time_stamping         hardware
twoStepFlag           1
domainNumber          0
gmCapable             1
priority1             10
priority2             10
```

2) –ö–ª–∏–µ–Ω—Ç PTP (Ordinary/Slave):
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∑–∞–ø—É—Å–∫ –∏–∑ —Ä–∞–∑–¥–µ–ª–∞ 15; PHC ‚Üí —Å–∏—Å—Ç–µ–º–Ω—ã–µ —á–∞—Å—ã —á–µ—Ä–µ–∑ `phc2sys`.

3) –í–Ω–µ—à–Ω—è—è –æ–ø–æ—Ä–∞ 10MHz/1PPS:
   - –ü–æ–¥–∞–π—Ç–µ —Å–∏–≥–Ω–∞–ª—ã –Ω–∞ –≤—Ö–æ–¥–Ω—ã–µ SMA, –≤–∫–ª—é—á–∏—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Ä–µ–∂–∏–º –≤ –ø—Ä–æ—à–∏–≤–∫–µ/–Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö.
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏ –∑–∞–¥–µ—Ä–∂–∫–∏ –ø–æ –∂—É—Ä–Ω–∞–ª–∞–º `ptp4l`/`phc2sys`.

---

### 10. –ë–∞–∑–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è FPGA

–ü—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–∞—Ä—Ç—ã **TC ConfMaster** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç –±–∞–∑–æ–≤—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏–∑ —Ñ–∞–π–ª–∞ `DefaultConfigFile.txt`. –≠—Ç–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤–∫–ª—é—á–∞–µ—Ç:

#### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ

| **IP Core**          | **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ**                                    |
|----------------------|---------------------------------------------------------------|
| **Adjustable Clock** | –í–∫–ª—é—á–µ–Ω —Å –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ 1 (ToD+PPS)               |
| **PPS Generator**     | –í–∫–ª—é—á–µ–Ω —Å –≤—ã—Å–æ–∫–æ–π –ø–æ–ª—è—Ä–Ω–æ—Å—Ç—å—é –≤—ã—Ö–æ–¥–Ω–æ–≥–æ –∏–º–ø—É–ª—å—Å–∞             |
| **PPS Slave**         | –í–∫–ª—é—á–µ–Ω —Å –≤—ã—Å–æ–∫–æ–π –ø–æ–ª—è—Ä–Ω–æ—Å—Ç—å—é –≤—Ö–æ–¥–Ω–æ–≥–æ –∏–º–ø—É–ª—å—Å–∞              |
| **ToD Slave**         | –í–∫–ª—é—á–µ–Ω —Å –≤—ã—Å–æ–∫–æ–π –ø–æ–ª—è—Ä–Ω–æ—Å—Ç—å—é UART –≤—Ö–æ–¥–∞                     |
| **SMA Selector**      | –ù–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –≤—ã–≤–æ–¥ FPGA PPS –∏ GNSS PPS —á–µ—Ä–µ–∑ SMA —Ä–∞–∑—ä—ë–º—ã     |

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
cat /sys/class/timecard/ocp0/clock_source

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
cat /sys/class/timecard/ocp0/available_clock_sources

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ SMA
cat /sys/class/timecard/ocp0/sma3  # –¥–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å "10MHz"
cat /sys/class/timecard/ocp0/sma4  # –¥–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å "PPS"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ PPS –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞
cat /sys/class/timecard/ocp0/pps_generator_enable 2>/dev/null || echo "PPS generator status not available"
```

#### –ò–∑–º–µ–Ω–µ–Ω–∏–µ –±–∞–∑–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

–î–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –º–æ–∂–Ω–æ:

1. **–ß–µ—Ä–µ–∑ sysfs –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** (–≤—Ä–µ–º–µ–Ω–Ω–æ, –¥–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏):
```bash
# –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
echo "GNSS" > /sys/class/timecard/ocp0/clock_source

# –ü–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ SMA –≤—ã—Ö–æ–¥–æ–≤
echo "IRIG" > /sys/class/timecard/ocp0/sma3
echo "DCF" > /sys/class/timecard/ocp0/sma4
```

2. **–ß–µ—Ä–µ–∑ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—é –ø—Ä–æ—à–∏–≤–∫–∏** (–ø–æ—Å—Ç–æ—è–Ω–Ω–æ):
   - –ò–∑–º–µ–Ω–∏—Ç—å `DefaultConfigFile.txt` –≤ –ø—Ä–æ—à–∏–≤–∫–µ
   - –ü–µ—Ä–µ–ø—Ä–æ—à–∏—Ç—å –∫–∞—Ä—Ç—É —Å –Ω–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π

#### –°–±—Ä–æ—Å –∫ –±–∞–∑–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```bash
# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –¥—Ä–∞–π–≤–µ—Ä–∞ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –±–∞–∑–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
sudo rmmod ptp_ocp
sudo modprobe ptp_ocp

# –ò–ª–∏ –ø–æ–ª–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–∏—Å—Ç–µ–º—ã
sudo reboot
```

### 11. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—á–∞–Ω–∏—è

- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ SMA‚Äë–ø–æ—Ä—Ç–æ–≤ –º–æ–≥—É—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –ø–æ —Ä–µ–≤–∏–∑–∏—è–º; —É—Ç–æ—á–Ω—è–π—Ç–µ –º–∞—Ä–∫–∏—Ä–æ–≤–∫—É –Ω–∞ –ø–∞–Ω–µ–ª–∏.
- –≠–∫—Å–ø–æ—Ä—Ç –ø—Ä–∏–∑–Ω–∞–∫–∞ –≤–∏—Å–æ–∫–æ—Å–Ω–æ–π —Å–µ–∫—É–Ω–¥—ã –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–∞–Ω–∞–ª—ã (IRIG‚ÄëB, DCF77, SMPTE) –∑–∞–≤–∏—Å—è—Ç –æ—Ç –ø—Ä–æ—à–∏–≤–∫–∏.
- –î–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–π —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–æ—Ä –≤—Ä–µ–º–µ–Ω–∏ –∏ —Ä–µ–≥—É–ª—è—Ä–Ω–∞—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞ –∑–∞–¥–µ—Ä–∂–µ–∫ –∫–∞–±–µ–ª–µ–π.
- –ë–∞–∑–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∞ —á–µ—Ä–µ–∑ sysfs –∏–ª–∏ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –ø—Ä–æ—à–∏–≤–∫–∏.

---

### 12. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–ª–∞—Ç—ã –∏ –ø–µ—Ä–≤–∏—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

1) **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º—ã**: —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ BIOS –≤–∫–ª—é—á–µ–Ω—ã VT-d/IOMMU (—Å–º. —Ä–∞–∑–¥–µ–ª 3).

2) **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–∏—Å—Ç–µ–º–µ** (–ø–æ–ª–µ–∑–Ω–æ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏):
```bash
# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–∞—Ç–µ—Ä–∏–Ω—Å–∫–æ–π –ø–ª–∞—Ç–µ
sudo dmidecode -t baseboard

# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ
sudo dmidecode -t system
```

3) –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–ª–∞—Ç—É –≤ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π —Å–ª–æ—Ç PCIe –∏ –∑–∞—Ñ–∏–∫—Å–∏—Ä—É–π—Ç–µ –≤–∏–Ω—Ç–æ–º.
4) –ü–æ–¥–∫–ª—é—á–∏—Ç–µ GNSS‚Äë–∞–Ω—Ç–µ–Ω–Ω—É (–µ—Å–ª–∏ –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω–æ) —Å–æ–≥–ª–∞—Å–Ω–æ –º–∞—Ä–∫–∏—Ä–æ–≤–∫–µ.
5) –í–∫–ª—é—á–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä –∏ –≤ Linux –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞:

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∫–∞—Ä—Ç—ã
sudo lspci -nn | grep -i 'ptp\|time\|quantum\|xilinx\|fpga' || true

# –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–∞—Ä—Ç–µ (–ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –¥—Ä–∞–π–≤–µ—Ä–∞)
sudo lspci -vvv | grep -A 20 -B 5 "ptp_ocp"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ PTM
sudo lspci -vvv | grep -A 10 "Precision Time Measurement"
```

6) **–ü—Ä–æ–≤–µ—Ä–∫–∞ PTM –ø–æ–¥–¥–µ—Ä–∂–∫–∏** (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ):
```bash
# –ü–æ–∏—Å–∫ PTM –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π
sudo lspci -vvv | grep -A 5 "PTMCap"
```

–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥ –¥–ª—è –∫–∞—Ä—Ç—ã —Å PTM:
```
PTMCap: Requester:+ Responder:- Root:-
PTMClockGranularity: 8ns
PTMControl: Enabled:+ RootSelected:-
PTMEffectiveGranularity: 4ns
```

–°–≤–µ—Ä—å—Ç–µ—Å—å —Å `–î–†–ê–ô–í–ï–†–ê/–¢A–ë–õ–ò–¶–ê_–°–û–û–¢–í–ï–¢–°–¢–í–ò–Ø_PCI.md` –∏ `–î–†–ê–ô–í–ï–†–ê/–°–û–ü–û–°–¢–ê–í–õ–ï–ù–ò–ï_PCI_–î–†–ê–ô–í–ï–†–ê.md` –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

---

### 13. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –¥—Ä–∞–π–≤–µ—Ä–∞ (Ubuntu)

–ò—Å—Ö–æ–¥–Ω–∏–∫–∏ –∏ –≥–æ—Ç–æ–≤—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã –≤ –∫–∞—Ç–∞–ª–æ–≥–µ `–î–†–ê–ô–í–ï–†–ê/` (—Ñ–∞–π–ª—ã `ptp_ocp.c`, `ptp_ocp.ko`, `Makefile` –∏ –¥—Ä.).

- **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (Ubuntu):**

```bash
sudo apt update
sudo apt install -y build-essential linux-headers-$(uname -r) ethtool linuxptp chrony pciutils dkms kmod
```

- **–°–±–æ—Ä–∫–∞ (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è):**

```bash
cd –î–†–ê–ô–í–ï–†–ê
make -j"$(nproc)"
```

- **–ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥—É–ª—è (–≤—Ä–µ–º–µ–Ω–Ω–∞—è, –¥–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏):**

```bash
cd –î–†–ê–ô–í–ï–†–ê
sudo insmod ptp_ocp.ko 2>/dev/null || sudo modprobe ptp_ocp
```

- **–ê–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥—É–ª—è (–ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏):**

```bash
echo ptp_ocp | sudo tee /etc/modules-load.d/quantum-pci.conf
```

- **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –¥—Ä–∞–π–≤–µ—Ä–∞:**

```bash
lsmod | grep ptp_ocp || true
dmesg -T | grep -i ptp_ocp || true
ls -l /dev/ptp*
```

–ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Secure Boot, –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –ø–æ–¥–ø–∏—Å—å –º–æ–¥—É–ª—è –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–ª—é—á–∞ (MOK). –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤–∞.

‚Äî –ü–æ–¥–ø–∏—Å—å –º–æ–¥—É–ª—è –¥–ª—è Secure Boot (Ubuntu):

```bash
# 1) –°–æ–∑–¥–∞—ë–º –∫–ª—é—á–∏
sudo mkdir -p /root/module-signing
cd /root/module-signing
openssl req -new -x509 -newkey rsa:2048 -keyout MOK.priv -outform DER -out MOK.der -nodes -days 36500 -subj "/CN=PTP OCP Module/"

# 2) –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –∫–ª—é—á (–ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ –≤ MOK Manager)
sudo mokutil --import MOK.der
sudo reboot

# 3) –ü–æ–¥–ø–∏—Å—ã–≤–∞–µ–º –º–æ–¥—É–ª—å –ø–æ—Å–ª–µ —Å–±–æ—Ä–∫–∏
sudo /usr/src/linux-headers-$(uname -r)/scripts/sign-file sha256 \
  /root/module-signing/MOK.priv /root/module-signing/MOK.der \
  –î–†–ê–ô–í–ï–†–ê/ptp_ocp.ko

# 4) –ó–∞–≥—Ä—É–∂–∞–µ–º –º–æ–¥—É–ª—å
sudo insmod –î–†–ê–ô–í–ï–†–ê/ptp_ocp.ko || sudo modprobe ptp_ocp
```

---

### 14. –†–∞–±–æ—Ç–∞ —Å –ø—Ä–æ—à–∏–≤–∫–∞–º–∏

–°–∫—Ä–∏–ø—Ç—ã —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã –≤ `–î–†–ê–ô–í–ï–†–ê/`:

- `check_firmware_type.sh` ‚Äî –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ç–∏–ø –ø—Ä–æ—à–∏–≤–∫–∏.
- `convert_firmware.sh` ‚Äî –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ–æ—Ä–º–∞—Ç –ø—Ä–æ—à–∏–≤–∫–∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.
- `switch_firmware_type.sh` ‚Äî –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–∏–ø –ø—Ä–æ—à–∏–≤–∫–∏.
- `modify_firmware.sh` / `simple_modify_firmware.sh` ‚Äî –≤–Ω–µ—Å—Ç–∏ –ø—Ä–∞–≤–∫–∏ (ID, –ø–∞—Ä–∞–º–µ—Ç—Ä—ã).
- `flash_programmer.sh` ‚Äî –∑–∞–ø–∏—Å—å –ø—Ä–æ—à–∏–≤–∫–∏ –≤–æ —Ñ–ª–µ—à‚Äë–ø–∞–º—è—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞.

–ü—Ä–∏–º–µ—Ä –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:

```bash
cd –î–†–ê–ô–í–ï–†–ê
./check_firmware_type.sh firmware.bin
./convert_firmware.sh firmware.bin firmware_conv.bin     # –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
./switch_firmware_type.sh firmware_conv.bin              # –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
sudo ./flash_programmer.sh firmware_conv.bin
```

–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ò–ë–ü –∏ –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞–π—Ç–µ –ø–∏—Ç–∞–Ω–∏–µ –≤–æ –≤—Ä–µ–º—è –ø—Ä–æ—à–∏–≤–∫–∏.
- –ü–æ—Å–ª–µ –ø—Ä–æ—à–∏–≤–∫–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫—É –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ `dmesg`.

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —Å–º. `–î–†–ê–ô–í–ï–†–ê/–ò–ù–°–¢–†–£–ö–¶–ò–Ø_–ü–û_–†–ê–ë–û–¢–ï_–°_–ü–†–û–®–ò–í–ö–ê–ú–ò.md` –∏ `–î–†–ê–ô–í–ï–†–ê/–ò–ù–°–¢–†–£–ö–¶–ò–Ø_–ü–†–û–®–ò–í–ö–ò_–ü–†–û–ì–†–ê–ú–ú–ê–¢–û–†–û–ú.md`.

---

### 15. –†–∞–±–æ—Ç–∞ —Å GNSS –ø—Ä–∏–µ–º–Ω–∏–∫–æ–º

–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –¥—Ä–∞–π–≤–µ—Ä–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–∞–±–æ—Ç—É —Å GNSS –ø—Ä–∏–µ–º–Ω–∏–∫–æ–º (–µ—Å–ª–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –Ω–∞ –∫–∞—Ä—Ç–µ).

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ GNSS –ø–æ—Ä—Ç–æ–≤

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ—Ä—Ç–æ–≤
ls -la /dev/ttyS* /dev/ttyGNSS* /dev/ttyMAC* /dev/ttyNMEA* 2>/dev/null

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –∫–∞—Ä—Ç–æ–π –ø–æ—Ä—Ç–æ–≤ (–ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –¥—Ä–∞–π–≤–µ—Ä–∞)
find /sys/class/timecard/ocp* -name "tty*" -exec readlink {} \; 2>/dev/null
```

#### –ú–µ—Ç–æ–¥ 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ gpsd (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞ gpsd –Ω–∞ Ubuntu:**

```bash
sudo apt update
sudo apt install gpsd gpsd-clients python3-gps
```

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ –∑–∞–ø—É—Å–∫:**

```bash
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø–æ—Ä—Ç–∞ (–æ–±—ã—á–Ω–æ ttyS5 –∏–ª–∏ ttyGNSS)
sudo stty -F /dev/ttyS5 speed 115200

# –ó–∞–ø—É—Å–∫ gpsd (–∑–∞–º–µ–Ω–∏—Ç–µ /dev/ttyS5 –Ω–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã–π –ø–æ—Ä—Ç)
sudo gpsd /dev/ttyS5

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã GNSS —á–µ—Ä–µ–∑ cgps
cgps
```

**–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ cgps –ø—Ä–∏ —Ä–∞–±–æ—Ç–∞—é—â–µ–º GNSS:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ    Time: 2024-01-15T12:34:56.000Z              ‚îÇ
‚îÇ Latitude:  55.123456789 N                      ‚îÇ
‚îÇLongitude:  37.987654321 E                      ‚îÇ
‚îÇ Altitude:    156.78 m                          ‚îÇ
‚îÇ    Speed:      0.12 kph                        ‚îÇ
‚îÇ  Heading:     45.6 deg (true)                  ‚îÇ
‚îÇ    Climb:      0.0 m/min                       ‚îÇ
‚îÇ   Status:      3D FIX (5 secs)                 ‚îÇ
‚îÇSatellites: 12 used, 15 in view                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### –ú–µ—Ç–æ–¥ 2: –ü—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ tio

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞ tio –Ω–∞ Ubuntu:**

```bash
sudo apt install tio
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π GPS:**

```bash
# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç GPS –º–æ–¥—É–ª—è
tio -b 115200 /dev/ttyS5

# –ü—Ä–æ–≤–µ—Ä–∫–∞ NMEA —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç FPGA
tio -b 115200 /dev/ttyS0
```

**–ü—Ä–∏–º–µ—Ä NMEA —Å–æ–æ–±—â–µ–Ω–∏–π:**
```
$GPGGA,123456.00,5512.34567,N,03759.87654,E,1,12,0.8,156.78,M,15.2,M,,*5A
$GPRMC,123456.00,A,5512.34567,N,03759.87654,E,0.12,45.6,150124,,,A*7B
$GPGSV,3,1,12,01,45,123,42,02,67,234,45,03,23,345,38,04,78,456,41*7C
```

–î–ª—è –≤—ã—Ö–æ–¥–∞ –∏–∑ tio –Ω–∞–∂–º–∏—Ç–µ `Ctrl+T`, –∑–∞—Ç–µ–º `q`.

#### –ú–µ—Ç–æ–¥ 3: GUI –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç pygpsclient

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ Ubuntu:**

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
sudo apt update
sudo apt install python3 python3-pip python3-tkinter

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ pip
python3 -m pip install --upgrade pip

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫
python3 -m pip install --upgrade Pillow
python3 -m pip install pygpsclient

# –î–ª—è —Ä–∞–±–æ—Ç—ã —á–µ—Ä–µ–∑ VNC (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è —É–¥–∞–ª–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø)
sudo apt install tigervnc-standalone-server tigervnc-xorg-extension
```

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ VNC (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è —É–¥–∞–ª–µ–Ω–Ω—ã–π GUI –¥–æ—Å—Ç—É–ø):**

```bash
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ VNC —Å–µ—Ä–≤–µ—Ä–∞
vncserver :1 -geometry 1024x768 -depth 24

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞—Ä–æ–ª—è VNC (–ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ)
vncpasswd
```

**–ó–∞–ø—É—Å–∫ pygpsclient:**

```bash
# –õ–æ–∫–∞–ª—å–Ω–æ (—Å GUI)
pygpsclient

# –ß–µ—Ä–µ–∑ VNC
DISPLAY=:1 pygpsclient
```

#### –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ GNSS

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è GNSS —á–µ—Ä–µ–∑ sysfs:**

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ GNSS —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
cat /sys/class/timecard/ocp0/gnss_sync 2>/dev/null || echo "GNSS sysfs –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –≤—Ä–µ–º–µ–Ω–∏
cat /sys/class/timecard/ocp0/clock_source 2>/dev/null || echo "Clock source –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –≤—Ä–µ–º–µ–Ω–∏
cat /sys/class/timecard/ocp0/available_clock_sources 2>/dev/null || echo "Available sources –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã"

# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã TOD (Time of Day)
cat /sys/class/timecard/ocp0/tod_protocol 2>/dev/null || echo "TOD protocol –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω"
cat /sys/class/timecard/ocp0/available_tod_protocols 2>/dev/null || echo "Available TOD protocols –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã"
cat /sys/class/timecard/ocp0/tod_baud_rate 2>/dev/null || echo "TOD baud rate –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∂–∏–º–∞ holdover
cat /sys/class/timecard/ocp0/holdover 2>/dev/null || echo "Holdover status –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω"

# –°—Ç–∞—Ç—É—Å –¥—Ä–µ–π—Ñ–∞ –∏ —Å–º–µ—â–µ–Ω–∏—è —á–∞—Å–æ–≤
cat /sys/class/timecard/ocp0/clock_status_drift 2>/dev/null || echo "Clock drift –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω"
cat /sys/class/timecard/ocp0/clock_status_offset 2>/dev/null || echo "Clock offset –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω"
```

**–í–æ–∑–º–æ–∂–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã GNSS:**
- `locked` - GNSS —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω
- `unlocked` - GNSS –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω
- `holdover` - —Ä–µ–∂–∏–º —É–¥–µ—Ä–∂–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏

#### –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å GNSS

**–ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**

1. **GNSS –ø–æ—Ä—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ—Ä—Ç–æ–≤
dmesg | grep -i "tty\|uart\|serial"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ –¥—Ä–∞–π–≤–µ—Ä–∞
lsmod | grep ptp_ocp
```

2. **–ù–µ—Ç NMEA —Å–æ–æ–±—â–µ–Ω–∏–π:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø–æ—Ä—Ç–∞
sudo stty -F /dev/ttyS5 -a

# –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Ä–∞–∑–Ω—ã–µ —Å–∫–æ—Ä–æ—Å—Ç–∏
for speed in 9600 38400 115200; do
    echo "Trying speed $speed"
    sudo stty -F /dev/ttyS5 speed $speed
    timeout 10s tio -b $speed /dev/ttyS5
done
```

3. **GNSS –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç —Ñ–∏–∫—Å–∞—Ü–∏—é:**
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ GNSS –∞–Ω—Ç–µ–Ω–Ω–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∞ –∏ –∏–º–µ–µ—Ç –ø–∏—Ç–∞–Ω–∏–µ
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∞–Ω—Ç–µ–Ω–Ω–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ —Å —Ö–æ—Ä–æ—à–∏–º –æ–±–∑–æ—Ä–æ–º –Ω–µ–±–∞
   - –î–æ–∂–¥–∏—Ç–µ—Å—å "—Ö–æ–ª–æ–¥–Ω–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞" (–º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –¥–æ 15 –º–∏–Ω—É—Ç)

#### –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∑–∞–ø—É—Å–∫–∞ gpsd

**–°–æ–∑–¥–∞–Ω–∏–µ systemd —Å–µ—Ä–≤–∏—Å–∞:**

```bash
sudo tee /etc/systemd/system/gpsd-timecard.service << EOF
[Unit]
Description=GPS daemon for TimeCard
After=network.target

[Service]
Type=forking
ExecStartPre=/bin/stty -F /dev/ttyS5 speed 115200
ExecStart=/usr/sbin/gpsd -n /dev/ttyS5
ExecReload=/bin/kill -HUP \$MAINPID
KillMode=mixed
Restart=on-failure

[Install]
WantedBy=multi-user.target
EOF

# –í–∫–ª—é—á–µ–Ω–∏–µ –∏ –∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞
sudo systemctl daemon-reload
sudo systemctl enable gpsd-timecard
sudo systemctl start gpsd-timecard

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
sudo systemctl status gpsd-timecard
```

---

### 16. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏: –≤–∞—Ä–∏–∞–Ω—Ç—ã

- **PTP (linuxptp):** —Ç–æ—á–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã–µ –º–µ—Ç–∫–∏ –≤—Ä–µ–º–µ–Ω–∏ (PHC, `/dev/ptpX`).
- **NTP (chrony/ntpd):** —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å NTP‚Äë—Å–µ—Ä–≤–µ—Ä–∞–º–∏ –∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω—ã–º PHC –∫–∞–∫ —Ä–µ—Ñ–µ—Ä–µ–Ω—Å–æ–º.

–†–æ–ª—å –∫–∞—Ä—Ç—ã Quantum‚ÄëPCI:
- –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç PHC‚Äë—á–∞—Å—ã (`/dev/ptpX`) –∏ –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã–µ –º–µ—Ç–∫–∏ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è `ptp4l`.
- –ú–æ–∂–µ—Ç –≤—ã—Å—Ç—É–ø–∞—Ç—å –∫–∞–∫ Grandmaster/Ordinary/Boundary –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–µ—Ç–∏ –∏ –ø—Ä–æ—à–∏–≤–∫–∏.

---

### 17. –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç: PTP (linuxptp)

–£—Å—Ç–∞–Ω–æ–≤–∫–∞:

```bash
sudo apt install -y linuxptp
```

–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Å–µ—Ç–µ–≤–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–π –æ—Ç–º–µ—Ç–∫–∏ (–ø—Ä–∏–º–µ—Ä: `eno1`), –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:

```bash
sudo ethtool -T eno1
```

–ó–∞–ø—É—Å–∫ `ptp4l` (Ordinary Clock, –¥–≤—É—Ö—Å—Ç—É–ø–µ–Ω—á–∞—Ç—ã–π, –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã–µ –º–µ—Ç–∫–∏):

```bash
sudo ptp4l -i eno1 -m -2 -s
# -m: –ª–æ–≥ –≤ –∫–æ–Ω—Å–æ–ª—å, -2: two-step, -s: slaveOnly (–ø—Ä–∏–º–µ—Ä –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞)
```

–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —á–∞—Å–æ–≤ –æ—Ç PHC:

```bash
sudo phc2sys -s /dev/ptp0 -c CLOCK_REALTIME -O 0 -m
```

–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ —É–∫–∞–∑–∞—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:

```bash
sudo phc2sys -s eno1 -c CLOCK_REALTIME -O 0 -m
```

–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —á–µ—Ä–µ–∑ `pmc`:

```bash
sudo pmc -u -b 0 'GET GRANDMASTER_SETTINGS_NP' 'GET TIME_STATUS_NP'
```

–ü—Ä–∏–º–µ—Ä –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ñ–∏–≥–∞ `ptp4l` (—Å–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª, –Ω–∞–ø—Ä–∏–º–µ—Ä `/etc/linuxptp/ptp4l.conf`):

```ini
[global]
verbose               1
twoStepFlag           1
time_stamping         hardware
tx_timestamp_timeout  50
logging_level         6

[eno1]
network_transport     UDPv4
delay_mechanism       E2E
```

–ó–∞–ø—É—Å–∫ —Å –∫–æ–Ω—Ñ–∏–≥–æ–º:

```bash
sudo ptp4l -f /etc/linuxptp/ptp4l.conf -m
```

–ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —á–µ—Ä–µ–∑ systemd‚Äë—é–Ω–∏—Ç—ã `ptp4l.service` –∏ `phc2sys.service` (–ø—Ä–∏–º–µ—Ä—ã –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ `linuxptp`).

---

### 18. –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç: NTP (chrony)

–£—Å—Ç–∞–Ω–æ–≤–∫–∞:

```bash
sudo apt install -y chrony
```

**–í–∞—Ä–∏–∞–Ω—Ç 1: –ë–∞–∑–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞ NTP** (`/etc/chrony/chrony.conf`):

```conf
pool pool.ntp.org iburst
rtcsync
makestep 1.0 3
```

**–í–∞—Ä–∏–∞–Ω—Ç 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ PHC –∫–∞–∫ —Ä–µ—Ñ–µ—Ä–µ–Ω—Å** (–ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ GNSS/—Ç–æ—á–Ω–æ–≥–æ PHC):

```conf
refclock PHC /dev/ptp0 poll 2 dpoll -2 offset 0.0 prefer
rtcsync
makestep 1.0 3
```

**–í–∞—Ä–∏–∞–Ω—Ç 3: –ü—Ä—è–º–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è PHC ‚Üí —Å–∏—Å—Ç–µ–º–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**

–°–æ–≥–ª–∞—Å–Ω–æ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Time Card, –Ω–∞–∏–±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–π —Å–ø–æ—Å–æ–±:

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—â–∏–µ —Å–ª—É–∂–±—ã
sudo systemctl stop systemd-timesyncd.service

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å PHC –≤—Ä–µ–º—è –æ—Ç —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ (–æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω–æ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ)
sudo phc_ctl /dev/ptp0 set

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é —Å–∏—Å—Ç–µ–º–∞ ‚Üê PHC
sudo phc2sys -c CLOCK_REALTIME -s /dev/ptp0 -O 0 -R 16 -u 8 -m
```

–ü—Ä–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç–µ PTM –≤—ã–≤–æ–¥ `phc2sys` –¥–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å **delay 0 +/-**:
```
phc2sys[4503.063]: CLOCK_REALTIME rms 26 max 40 freq -17250 +/- 17 delay 0+/- 0
phc2sys[4503.564]: CLOCK_REALTIME rms 46 max 85 freq -17346 +/- 17 delay 0+/- 0
```

–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ (–¥–ª—è –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ 1-2):

```bash
sudo systemctl restart chrony
chronyc tracking
chronyc sources -v
```

**–í–∞–∂–Ω–æ**: –∏–∑–±–µ–≥–∞–π—Ç–µ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Å–ª—É–∂–±–∞–º–∏. –û—Ç–∫–ª—é—á–∏—Ç–µ `systemd-timesyncd`:

```bash
sudo systemctl stop systemd-timesyncd
sudo systemctl disable systemd-timesyncd
```

---

### 19. –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

#### –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ Quantum-PCI

–í —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–∞—Ä—Ç—ã Quantum-PCI –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

**–ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:**
```bash
cd ptp-monitoring
python3 quantum-pci-monitor.py
```

**–î–æ—Å—Ç—É–ø –∫ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É:**
- **–û—Å–Ω–æ–≤–Ω–æ–π –¥–∞—à–±–æ—Ä–¥**: http://localhost:8080/realistic-dashboard
- **API**: http://localhost:8080/api/
- **Roadmap**: http://localhost:8080/api/roadmap

#### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–∞—Ä—Ç—ã:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
sudo lspci -nn | grep -i '1d9b:0400'

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥—Ä–∞–π–≤–µ—Ä–∞
lsmod | grep ptp_ocp

# –ü—Ä–æ–≤–µ—Ä–∫–∞ sysfs –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
ls -la /sys/class/timecard/ocp*/

# –ü—Ä–æ–≤–µ—Ä–∫–∞ PTP —É—Å—Ç—Ä–æ–π—Å—Ç–≤
ls -la /dev/ptp*
```

**–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —á–µ—Ä–µ–∑ sysfs:**
```bash
#!/bin/bash
# –°–∫—Ä–∏–ø—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è TimeCard

TIMECARD_BASE="/sys/class/timecard/ocp0"

if [ ! -d "$TIMECARD_BASE" ]; then
    echo "‚ùå TimeCard —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ"
    exit 1
fi

echo "=== –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ TimeCard ==="
echo "üìÖ –í—Ä–µ–º—è: $(date)"
echo

# –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
echo "üîß –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:"
echo "  –°–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä: $(cat $TIMECARD_BASE/serialnum 2>/dev/null || echo 'N/A')"
echo "  –ò—Å—Ç–æ—á–Ω–∏–∫ –≤—Ä–µ–º–µ–Ω–∏: $(cat $TIMECARD_BASE/clock_source 2>/dev/null || echo 'N/A')"
echo "  GNSS —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è: $(cat $TIMECARD_BASE/gnss_sync 2>/dev/null || echo 'N/A')"
echo

# –°—Ç–∞—Ç—É—Å —á–∞—Å–æ–≤
echo "‚è∞ –°—Ç–∞—Ç—É—Å —á–∞—Å–æ–≤:"
echo "  –°–º–µ—â–µ–Ω–∏–µ: $(cat $TIMECARD_BASE/clock_status_offset 2>/dev/null || echo 'N/A') –Ω—Å"
echo "  –î—Ä–µ–π—Ñ: $(cat $TIMECARD_BASE/clock_status_drift 2>/dev/null || echo 'N/A') ppb"
echo "  –†–µ–∂–∏–º —É–¥–µ—Ä–∂–∞–Ω–∏—è: $(cat $TIMECARD_BASE/holdover 2>/dev/null || echo 'N/A')"
echo

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è SMA
echo "üîå –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è SMA:"
for i in {1..4}; do
    if [ -f "$TIMECARD_BASE/sma$i" ]; then
        echo "  SMA$i: $(cat $TIMECARD_BASE/sma$i)"
    fi
done
echo

# –°–≤—è–∑–∞–Ω–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
echo "üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞:"
if [ -L "$TIMECARD_BASE/ptp" ]; then
    PTP_DEV=$(basename $(readlink $TIMECARD_BASE/ptp))
    echo "  PTP: /dev/$PTP_DEV"
fi

if [ -L "$TIMECARD_BASE/ttyGNSS" ]; then
    GNSS_TTY=$(basename $(readlink $TIMECARD_BASE/ttyGNSS))
    echo "  GNSS: /dev/$GNSS_TTY"
fi
echo

# –ü—Ä–æ–≤–µ—Ä–∫–∞ PTP —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
if [ -c "/dev/ptp0" ]; then
    echo "üì° PTP —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è:"
    sudo phc_ctl /dev/ptp0 cmp 2>/dev/null | head -3
fi
```

#### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ç–æ—á–Ω–æ—Å—Ç–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:**
```bash
#!/bin/bash
# –°–∫—Ä–∏–ø—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Ç–æ—á–Ω–æ—Å—Ç–∏ PTP

PTP_DEV="/dev/ptp0"
LOG_FILE="/var/log/ptp_accuracy.log"

if [ ! -c "$PTP_DEV" ]; then
    echo "PTP —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ"
    exit 1
fi

echo "–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ç–æ—á–Ω–æ—Å—Ç–∏ PTP - $PTP_DEV"
echo "–õ–æ–≥: $LOG_FILE"
echo "–ù–∞–∂–º–∏—Ç–µ Ctrl+C –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏"
echo

while true; do
    TIMESTAMP=$(date '+%Y-%m-%d %H:%M:%S')
    
    # –ü–æ–ª—É—á–µ–Ω–∏–µ offset –º–µ–∂–¥—É —Å–∏—Å—Ç–µ–º–Ω—ã–º –≤—Ä–µ–º–µ–Ω–µ–º –∏ PHC
    OFFSET=$(sudo phc_ctl $PTP_DEV cmp 2>/dev/null | grep "offset" | awk '{print $2}')
    
    # –ü–æ–ª—É—á–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã
    FREQ=$(sudo phc_ctl $PTP_DEV freq 2>/dev/null | grep "frequency" | awk '{print $2}')
    
    # –°—Ç–∞—Ç—É—Å ptp4l (–µ—Å–ª–∏ –∑–∞–ø—É—â–µ–Ω)
    PTP4L_STATUS=""
    if pgrep ptp4l > /dev/null; then
        PTP4L_STATUS="running"
    else
        PTP4L_STATUS="stopped"
    fi
    
    # –ó–∞–ø–∏—Å—å –≤ –ª–æ–≥
    echo "$TIMESTAMP,offset=$OFFSET,freq=$FREQ,ptp4l=$PTP4L_STATUS" >> $LOG_FILE
    
    # –í—ã–≤–æ–¥ –Ω–∞ —ç–∫—Ä–∞–Ω
    printf "\r%s | Offset: %8s ns | Freq: %8s ppb | PTP4L: %s" \
           "$TIMESTAMP" "$OFFSET" "$FREQ" "$PTP4L_STATUS"
    
    sleep 1
done
```

**–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ PTP:**
```bash
#!/bin/bash
# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ PTP —Ç—Ä–∞—Ñ–∏–∫–∞

INTERFACE="eth0"
DURATION=60

echo "–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ PTP —Ç—Ä–∞—Ñ–∏–∫–∞ –Ω–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ $INTERFACE"
echo "–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: $DURATION —Å–µ–∫—É–Ω–¥"
echo

# –ó–∞–ø—É—Å–∫ tcpdump –≤ —Ñ–æ–Ω–µ
sudo tcpdump -i $INTERFACE -n -c 1000 \
    'port 319 or port 320' \
    -tt \
    > /tmp/ptp_traffic.log 2>/dev/null &
TCPDUMP_PID=$!

sleep $DURATION

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ tcpdump
sudo kill $TCPDUMP_PID 2>/dev/null

# –ê–Ω–∞–ª–∏–∑ —Ç—Ä–∞—Ñ–∏–∫–∞
echo "=== –ê–Ω–∞–ª–∏–∑ PTP —Ç—Ä–∞—Ñ–∏–∫–∞ ==="
echo "–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞–∫–µ—Ç–æ–≤: $(wc -l < /tmp/ptp_traffic.log)"

echo
echo "–¢–∏–ø—ã PTP —Å–æ–æ–±—â–µ–Ω–∏–π:"
grep -o "port 319\|port 320" /tmp/ptp_traffic.log | sort | uniq -c

echo
echo "–ò—Å—Ç–æ—á–Ω–∏–∫–∏ PTP —Ç—Ä–∞—Ñ–∏–∫–∞:"
awk '{print $3}' /tmp/ptp_traffic.log | cut -d. -f1-4 | sort | uniq -c | head -10

echo
echo "–ù–∞–∑–Ω–∞—á–µ–Ω–∏—è PTP —Ç—Ä–∞—Ñ–∏–∫–∞:"
awk '{print $5}' /tmp/ptp_traffic.log | cut -d. -f1-4 | sort | uniq -c | head -10

# –û—á–∏—Å—Ç–∫–∞
rm -f /tmp/ptp_traffic.log
```

#### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ GNSS

**–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ GNSS —Å—Ç–∞—Ç—É—Å–∞:**
```bash
#!/bin/bash
# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ GNSS –ø—Ä–∏–µ–º–Ω–∏–∫–∞

GNSS_PORT="/dev/ttyS5"
GPSD_HOST="localhost"
GPSD_PORT="2947"

echo "=== –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ GNSS ==="

# –ü—Ä–æ–≤–µ—Ä–∫–∞ gpsd
if pgrep gpsd > /dev/null; then
    echo "‚úÖ gpsd –∑–∞–ø—É—â–µ–Ω"
    
    # –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —á–µ—Ä–µ–∑ gpsmon
    timeout 10s gpsmon -n 1 2>/dev/null | head -20
else
    echo "‚ùå gpsd –Ω–µ –∑–∞–ø—É—â–µ–Ω"
fi

# –ü—Ä–æ–≤–µ—Ä–∫–∞ GNSS –ø–æ—Ä—Ç–∞
if [ -c "$GNSS_PORT" ]; then
    echo "‚úÖ GNSS –ø–æ—Ä—Ç –¥–æ—Å—Ç—É–ø–µ–Ω: $GNSS_PORT"
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ NMEA —Å–æ–æ–±—â–µ–Ω–∏–π
    echo "–ü—Ä–æ–≤–µ—Ä–∫–∞ NMEA —Å–æ–æ–±—â–µ–Ω–∏–π (5 —Å–µ–∫—É–Ω–¥)..."
    timeout 5s tio -b 115200 $GNSS_PORT 2>/dev/null | head -5
else
    echo "‚ùå GNSS –ø–æ—Ä—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω: $GNSS_PORT"
fi

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ sysfs
if [ -d "/sys/class/timecard/ocp0" ]; then
    echo
    echo "=== –°—Ç–∞—Ç—É—Å —á–µ—Ä–µ–∑ sysfs ==="
    echo "GNSS —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è: $(cat /sys/class/timecard/ocp0/gnss_sync 2>/dev/null || echo 'N/A')"
    echo "–ò—Å—Ç–æ—á–Ω–∏–∫ –≤—Ä–µ–º–µ–Ω–∏: $(cat /sys/class/timecard/ocp0/clock_source 2>/dev/null || echo 'N/A')"
fi
```

#### –°–∏—Å—Ç–µ–º–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

**–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤:**
```bash
#!/bin/bash
# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ –¥–ª—è PTP

echo "=== –°–∏—Å—Ç–µ–º–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ ==="
echo "–í—Ä–µ–º—è: $(date)"
echo

# CPU –∏ –ø–∞–º—è—Ç—å
echo "üíª –†–µ—Å—É—Ä—Å—ã —Å–∏—Å—Ç–µ–º—ã:"
echo "  CPU –∑–∞–≥—Ä—É–∑–∫–∞: $(uptime | awk -F'load average:' '{print $2}')"
echo "  –ü–∞–º—è—Ç—å: $(free -h | grep '^Mem:' | awk '{print $3"/"$2}')"
echo "  –î–∏—Å–∫: $(df -h / | tail -1 | awk '{print $3"/"$2" ("$5")"}')"
echo

# –°–µ—Ç–µ–≤—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
echo "üåê –°–µ—Ç–µ–≤—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã:"
for iface in $(ip link show | grep -o 'eth[0-9]*'); do
    if [ -d "/sys/class/net/$iface" ]; then
        speed=$(cat /sys/class/net/$iface/speed 2>/dev/null || echo "unknown")
        duplex=$(cat /sys/class/net/$iface/duplex 2>/dev/null || echo "unknown")
        echo "  $iface: ${speed}Mbps, $duplex"
    fi
done
echo

# PTP –ø—Ä–æ—Ü–µ—Å—Å—ã
echo "‚öôÔ∏è PTP –ø—Ä–æ—Ü–µ—Å—Å—ã:"
ps aux | grep -E "(ptp4l|phc2sys|ts2phc)" | grep -v grep | while read line; do
    echo "  $line"
done
echo

# IRQ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
echo "üîß IRQ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:"
grep -E "(eth0|ptp)" /proc/interrupts | head -5
echo

# –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ)
if [ -f "/sys/class/thermal/thermal_zone0/temp" ]; then
    temp=$(cat /sys/class/thermal/thermal_zone0/temp)
    temp_c=$((temp / 1000))
    echo "üå°Ô∏è –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ CPU: ${temp_c}¬∞C"
fi
```

#### –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

**–°–æ–∑–¥–∞–Ω–∏–µ systemd —Å–µ—Ä–≤–∏—Å–∞ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:**
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
sudo tee /etc/systemd/system/quantum-pci-monitor.service << 'EOF'
[Unit]
Description=Quantum-PCI Monitoring Service
After=network.target

[Service]
Type=simple
User=root
ExecStart=/usr/local/bin/quantum-pci-monitor.sh
Restart=always
RestartSec=30
StandardOutput=journal
StandardError=journal

[Install]
WantedBy=multi-user.target
EOF

# –°–æ–∑–¥–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
sudo tee /usr/local/bin/quantum-pci-monitor.sh << 'EOF'
#!/bin/bash

LOG_DIR="/var/log/quantum-pci"
mkdir -p $LOG_DIR

while true; do
    TIMESTAMP=$(date '+%Y-%m-%d %H:%M:%S')
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è TimeCard
    if [ -d "/sys/class/timecard/ocp0" ]; then
        STATUS="OK"
        GNSS_SYNC=$(cat /sys/class/timecard/ocp0/gnss_sync 2>/dev/null || echo "unknown")
        CLOCK_SOURCE=$(cat /sys/class/timecard/ocp0/clock_source 2>/dev/null || echo "unknown")
    else
        STATUS="ERROR"
        GNSS_SYNC="N/A"
        CLOCK_SOURCE="N/A"
    fi
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ PTP
    if [ -c "/dev/ptp0" ]; then
        PTP_STATUS="OK"
        OFFSET=$(sudo phc_ctl /dev/ptp0 cmp 2>/dev/null | grep "offset" | awk '{print $2}' || echo "N/A")
    else
        PTP_STATUS="ERROR"
        OFFSET="N/A"
    fi
    
    # –ó–∞–ø–∏—Å—å –≤ –ª–æ–≥
    echo "$TIMESTAMP,$STATUS,$GNSS_SYNC,$CLOCK_SOURCE,$PTP_STATUS,$OFFSET" >> $LOG_DIR/monitor.log
    
    sleep 60
done
EOF

sudo chmod +x /usr/local/bin/quantum-pci-monitor.sh

# –í–∫–ª—é—á–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞
sudo systemctl daemon-reload
sudo systemctl enable quantum-pci-monitor
sudo systemctl start quantum-pci-monitor
```

---

### 20. –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è –∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ

#### –ü–ª–∞–Ω–æ–≤–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ

**–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:**
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å—Ç–∞—Ç—É—Å–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ GNSS
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ—á–Ω–æ—Å—Ç–∏ PTP —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- –ö–æ–Ω—Ç—Ä–æ–ª—å —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
- –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫

**–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –ø—Ä–æ—à–∏–≤–∫–∏
- –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –∑–∞–¥–µ—Ä–∂–µ–∫ –∫–∞–±–µ–ª–µ–π
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ª–æ–≥–æ–≤ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π

**–ï–∂–µ–º–µ—Å—è—á–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:**
- –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
- –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

#### –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π:**
```bash
#!/bin/bash
# –°–∫—Ä–∏–ø—Ç —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è

BACKUP_DIR="/backup/quantum-pci"
DATE=$(date +%Y%m%d_%H%M%S)

mkdir -p $BACKUP_DIR

# –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
if [ -d "/sys/class/timecard/ocp0" ]; then
    TIMECARD_BASE="/sys/class/timecard/ocp0"
    
    # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
    if [ -f "$TIMECARD_BASE/config" ]; then
        cp $TIMECARD_BASE/config $BACKUP_DIR/config_$DATE.bin
    fi
    
    # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
    if [ -f "$TIMECARD_BASE/disciplining_config" ]; then
        cp $TIMECARD_BASE/disciplining_config $BACKUP_DIR/disciplining_config_$DATE.bin
    fi
    
    # –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞
    if [ -f "$TIMECARD_BASE/temperature_table" ]; then
        cp $TIMECARD_BASE/temperature_table $BACKUP_DIR/temperature_table_$DATE.bin
    fi
fi

# –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π PTP
if [ -f "/etc/ptp4l.conf" ]; then
    cp /etc/ptp4l.conf $BACKUP_DIR/ptp4l_$DATE.conf
fi

# –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π Chrony
if [ -f "/etc/chrony/chrony.conf" ]; then
    cp /etc/chrony/chrony.conf $BACKUP_DIR/chrony_$DATE.conf
fi

# –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π (—Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π)
find $BACKUP_DIR -name "*.bin" -o -name "*.conf" | xargs ls -t | tail -n +31 | xargs rm -f

echo "–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ: $BACKUP_DIR"
```

#### –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏ –º–æ–¥–µ—Ä–Ω–∏–∑–∞—Ü–∏—è

**–ü—Ä–æ—Ü–µ–¥—É—Ä–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥—Ä–∞–π–≤–µ—Ä–∞:**
1. –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö PTP —Å–µ—Ä–≤–∏—Å–æ–≤
2. –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏ —Ç–µ–∫—É—â–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
3. –í—ã–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ä–æ–≥–æ –¥—Ä–∞–π–≤–µ—Ä–∞
4. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–æ–≤–æ–≥–æ –¥—Ä–∞–π–≤–µ—Ä–∞
5. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
6. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
7. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤

**–ü—Ä–æ—Ü–µ–¥—É—Ä–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ—à–∏–≤–∫–∏:**
1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –Ω–æ–≤–æ–π –ø—Ä–æ—à–∏–≤–∫–∏
2. –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–π —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏
3. –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
4. –ü—Ä–æ—à–∏–≤–∫–∞ –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏
5. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–∏—Å—Ç–µ–º—ã
6. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
7. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π

#### –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**–í–µ–¥–µ–Ω–∏–µ –∂—É—Ä–Ω–∞–ª–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π:**
- –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –í–µ—Ä—Å–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –ö–æ–Ω—Ç–∞–∫—Ç—ã –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ª–∏—Ü

**–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤:**
- –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã
- –í—Ä–µ–º—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è
- –ü—Ä–∏–Ω—è—Ç—ã–µ –º–µ—Ä—ã
- –í—Ä–µ–º—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
- –ê–Ω–∞–ª–∏–∑ –ø—Ä–∏—á–∏–Ω
- –ü—Ä–µ–≤–µ–Ω—Ç–∏–≤–Ω—ã–µ –º–µ—Ä—ã

---

### 21. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏

#### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Kubernetes

**–°–æ–∑–¥–∞–Ω–∏–µ DaemonSet –¥–ª—è PTP —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:**
```yaml
# ptp-daemonset.yaml
apiVersion: apps/v1
kind: DaemonSet
metadata:
  name: ptp-sync
  namespace: kube-system
spec:
  selector:
    matchLabels:
      name: ptp-sync
  template:
    metadata:
      labels:
        name: ptp-sync
    spec:
      hostNetwork: true
      hostPID: true
      containers:
      - name: ptp4l
        image: quantum-pci/ptp4l:latest
        securityContext:
          privileged: true
        volumeMounts:
        - name: dev
          mountPath: /dev
        - name: sys
          mountPath: /sys
        - name: config
          mountPath: /etc/ptp4l.conf
          subPath: ptp4l.conf
        command: ["/usr/sbin/ptp4l"]
        args: ["-f", "/etc/ptp4l.conf", "-i", "eth0"]
      - name: phc2sys
        image: quantum-pci/phc2sys:latest
        securityContext:
          privileged: true
        volumeMounts:
        - name: dev
          mountPath: /dev
        command: ["/usr/sbin/phc2sys"]
        args: ["-s", "/dev/ptp0", "-c", "CLOCK_REALTIME", "-O", "0"]
      volumes:
      - name: dev
        hostPath:
          path: /dev
      - name: sys
        hostPath:
          path: /sys
      - name: config
        configMap:
          name: ptp-config
```

#### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Docker

**Docker Compose –¥–ª—è PTP —Å—Ç–µ–∫–∞:**
```yaml
# docker-compose.ptp.yml
version: '3.8'

services:
  ptp4l:
    build:
      context: .
      dockerfile: Dockerfile.ptp
    container_name: ptp4l
    privileged: true
    network_mode: host
    volumes:
      - /dev:/dev
      - /sys:/sys
    environment:
      - PTP_INTERFACE=eth0
      - PTP_DOMAIN=0
    command: ["ptp4l", "-i", "eth0", "-f", "/etc/ptp4l.conf"]

  phc2sys:
    build:
      context: .
      dockerfile: Dockerfile.ptp
    container_name: phc2sys
    privileged: true
    network_mode: host
    volumes:
      - /dev:/dev
    depends_on:
      - ptp4l
    command: ["phc2sys", "-s", "/dev/ptp0", "-c", "CLOCK_REALTIME", "-O", "0"]
```

#### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Prometheus/Grafana

**Prometheus –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
```yaml
# prometheus.yml
global:
  scrape_interval: 15s

scrape_configs:
  - job_name: 'quantum-pci'
    static_configs:
      - targets: ['localhost:8080']
    metrics_path: '/api/metrics'
    scrape_interval: 5s

  - job_name: 'ptp4l'
    static_configs:
      - targets: ['localhost:9090']
    scrape_interval: 10s
```

#### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Ansible

**Ansible playbook –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è:**
```yaml
# quantum-pci-deploy.yml
---
- name: Deploy Quantum-PCI TimeCard
  hosts: timecard_servers
  become: yes
  vars:
    ptp_domain: 0
    ptp_interface: eth0

  tasks:
    - name: Install dependencies
      apt:
        name:
          - build-essential
          - linux-headers-{{ ansible_kernel }}
          - linuxptp
          - chrony
          - ethtool
          - pciutils
        state: present

    - name: Load PTP driver
      modprobe:
        name: ptp_ocp
        state: present

    - name: Start and enable PTP services
      systemd:
        name: "{{ item }}"
        state: started
        enabled: yes
      loop:
        - ptp4l
        - phc2sys
        - chrony
```

---

### 22. –†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

#### –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –ø—Ä–æ–±–ª–µ–º

| –ü—Ä–æ–±–ª–µ–º–∞ | –°–∏–º–ø—Ç–æ–º—ã | –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã | –†–µ—à–µ–Ω–∏—è |
|----------|----------|-------------------|---------|
| **–ö–∞—Ä—Ç–∞ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞** | `lspci` –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ | –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞, –ø—Ä–æ–±–ª–µ–º—ã —Å –ø–∏—Ç–∞–Ω–∏–µ–º, BIOS | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É, –ø–∏—Ç–∞–Ω–∏–µ, BIOS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ |
| **–î—Ä–∞–π–≤–µ—Ä –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è** | `lsmod \| grep ptp_ocp` –ø—É—Å—Ç–æ–π | –ù–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —è–¥—Ä–∞, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π | –û–±–Ω–æ–≤–∏—Ç—å —è–¥—Ä–æ, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ |
| **PTP –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è** | –ë–æ–ª—å—à–æ–π offset, –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ | –ü—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ç—å—é, –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Ç—å, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é PTP |
| **GNSS –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç** | –ù–µ—Ç NMEA —Å–æ–æ–±—â–µ–Ω–∏–π, —Å—Ç–∞—Ç—É—Å "unlocked" | –ü—Ä–æ–±–ª–µ–º—ã —Å –∞–Ω—Ç–µ–Ω–Ω–æ–π, –ø–æ—Ä—Ç–æ–º, –ø–∏—Ç–∞–Ω–∏–µ–º | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–Ω—Ç–µ–Ω–Ω—É, –ø–æ—Ä—Ç, –ø–∏—Ç–∞–Ω–∏–µ |
| **–ù–∏–∑–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å** | –í—ã—Å–æ–∫–∏–π –¥–∂–∏—Ç—Ç–µ—Ä, –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–π offset | –ü—Ä–æ–±–ª–µ–º—ã —Å –∫–∞–±–µ–ª—è–º–∏, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–æ–π, –ø–∏—Ç–∞–Ω–∏–µ–º | –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞, —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è —É—Å–ª–æ–≤–∏–π |

#### –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

**–°–∫—Ä–∏–ø—Ç –ø–æ–ª–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:**
```bash
#!/bin/bash
# full-diagnostics.sh

LOG_FILE="/var/log/quantum-pci-diagnostics.log"
TIMESTAMP=$(date '+%Y-%m-%d %H:%M:%S')

echo "=== –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ Quantum-PCI ===" | tee -a $LOG_FILE
echo "–í—Ä–µ–º—è: $TIMESTAMP" | tee -a $LOG_FILE

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–ø–ø–∞—Ä–∞—Ç—É—Ä—ã
if lspci -nn | grep -q "1d9b:0400"; then
    echo "‚úÖ –ê–ø–ø–∞—Ä–∞—Ç—É—Ä–∞: TimeCard –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞" | tee -a $LOG_FILE
else
    echo "‚ùå –ê–ø–ø–∞—Ä–∞—Ç—É—Ä–∞: TimeCard –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞" | tee -a $LOG_FILE
fi

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—Ä–∞–π–≤–µ—Ä–∞
if lsmod | grep -q "ptp_ocp"; then
    echo "‚úÖ –î—Ä–∞–π–≤–µ—Ä: ptp_ocp –∑–∞–≥—Ä—É–∂–µ–Ω" | tee -a $LOG_FILE
else
    echo "‚ùå –î—Ä–∞–π–≤–µ—Ä: ptp_ocp –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω" | tee -a $LOG_FILE
fi

# –ü—Ä–æ–≤–µ—Ä–∫–∞ PTP —É—Å—Ç—Ä–æ–π—Å—Ç–≤
if [ -c "/dev/ptp0" ]; then
    echo "‚úÖ PTP —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ: /dev/ptp0 –¥–æ—Å—Ç—É–ø–µ–Ω" | tee -a $LOG_FILE
else
    echo "‚ùå PTP —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ: /dev/ptp0 –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω" | tee -a $LOG_FILE
fi

# –ü—Ä–æ–≤–µ—Ä–∫–∞ GNSS
if [ -c "/dev/ttyS5" ]; then
    GNSS_STATUS=$(cat /sys/class/timecard/ocp0/gnss_sync 2>/dev/null || echo "unknown")
    echo "‚úÖ GNSS: –ü–æ—Ä—Ç –¥–æ—Å—Ç—É–ø–µ–Ω, —Å—Ç–∞—Ç—É—Å: $GNSS_STATUS" | tee -a $LOG_FILE
else
    echo "‚ùå GNSS: –ü–æ—Ä—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω" | tee -a $LOG_FILE
fi

# –ü—Ä–æ–≤–µ—Ä–∫–∞ PTP –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
if pgrep ptp4l > /dev/null; then
    echo "‚úÖ PTP4L: –ü—Ä–æ—Ü–µ—Å—Å –∑–∞–ø—É—â–µ–Ω" | tee -a $LOG_FILE
else
    echo "‚ùå PTP4L: –ü—Ä–æ—Ü–µ—Å—Å –Ω–µ –∑–∞–ø—É—â–µ–Ω" | tee -a $LOG_FILE
fi

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ—á–Ω–æ—Å—Ç–∏
if [ -c "/dev/ptp0" ]; then
    OFFSET=$(sudo phc_ctl /dev/ptp0 cmp 2>/dev/null | grep "offset" | awk '{print $2}' || echo "N/A")
    if [ "$OFFSET" != "N/A" ] && [ "${OFFSET#-}" -lt 1000000 ]; then
        echo "‚úÖ –¢–æ—á–Ω–æ—Å—Ç—å: Offset: ${OFFSET}ns" | tee -a $LOG_FILE
    else
        echo "‚ö†Ô∏è  –¢–æ—á–Ω–æ—Å—Ç—å: Offset: ${OFFSET}ns (–≤—ã—Å–æ–∫–∏–π)" | tee -a $LOG_FILE
    fi
else
    echo "‚ùå –¢–æ—á–Ω–æ—Å—Ç—å: PTP —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ" | tee -a $LOG_FILE
fi

echo "–ü–æ–ª–Ω—ã–π –ª–æ–≥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤: $LOG_FILE" | tee -a $LOG_FILE
```

#### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

**1. –ö–∞—Ä—Ç–∞ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ —Å–∏—Å—Ç–µ–º–æ–π:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ BIOS –Ω–∞—Å—Ç—Ä–æ–µ–∫
# - –í–∫–ª—é—á–∏—Ç—å VT-d/IOMMU
# - –û—Ç–∫–ª—é—á–∏—Ç—å Secure Boot
# - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å PCIe —Å–ª–æ—Ç

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏
lspci -nn | grep -i time
dmesg | grep -i ptp
```

**2. –î—Ä–∞–π–≤–µ—Ä –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
sudo modprobe --show-depends ptp_ocp

# –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
sudo insmod /path/to/ptp_ocp.ko

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏ —è–¥—Ä–∞
uname -r
```

**3. PTP –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ç–µ–≤–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
ethtool -T eth0

# –ü—Ä–æ–≤–µ—Ä–∫–∞ firewall
sudo ufw status | grep -E "(319|320)"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ PTP —Ç—Ä–∞—Ñ–∏–∫–∞
sudo tcpdump -i eth0 port 319 or port 320
```

**4. GNSS –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–Ω—Ç–µ–Ω–Ω—ã
# - –ü–æ–¥–∫–ª—é—á–µ–Ω–∞ –∫ GNSS —Ä–∞–∑—ä–µ–º—É
# - –ò–º–µ–µ—Ç –ø–∏—Ç–∞–Ω–∏–µ (–∞–∫—Ç–∏–≤–Ω–∞—è –∞–Ω—Ç–µ–Ω–Ω–∞)
# - –•–æ—Ä–æ—à–∏–π –æ–±–∑–æ—Ä –Ω–µ–±–∞

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–∞
sudo stty -F /dev/ttyS5 speed 115200
tio -b 115200 /dev/ttyS5
```

**5. –ù–∏–∑–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:**
```bash
# –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –∑–∞–¥–µ—Ä–∂–µ–∫ –∫–∞–±–µ–ª–µ–π
echo "100" > /sys/class/timecard/ocp0/external_pps_cable_delay

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã
cat /sys/class/thermal/thermal_zone0/temp

# –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–µ—Ç–∏
sudo ethtool -s eth0 speed 1000 duplex full autoneg off
```

---

### 23. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

#### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —è–¥—Ä–∞ –¥–ª—è real-time —Ä–∞–±–æ—Ç—ã:**
```bash
# /etc/default/grub
GRUB_CMDLINE_LINUX_DEFAULT="quiet splash isolcpus=1,2 nohz_full=1,2 rcu_nocbs=1,2"

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ grub
sudo update-grub
```

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è CPU:**
```bash
# –û—Ç–∫–ª—é—á–µ–Ω–∏–µ —ç–Ω–µ—Ä–≥–æ—Å–±–µ—Ä–µ–∂–µ–Ω–∏—è
echo performance | sudo tee /sys/devices/system/cpu/cpu*/cpufreq/scaling_governor

# –û—Ç–∫–ª—é—á–µ–Ω–∏–µ C-states
echo 1 | sudo tee /sys/devices/system/cpu/cpu*/cpuidle/state*/disable

# –ü—Ä–∏–≤—è–∑–∫–∞ IRQ –∫ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º CPU
echo 2 > /proc/irq/$(grep eth0 /proc/interrupts | cut -d: -f1 | tr -d ' ')/smp_affinity
```

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–µ—Ç–∏:**
```bash
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ç–µ–≤–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
sudo ethtool -s eth0 speed 1000 duplex full autoneg off
sudo ethtool -G eth0 rx 4096 tx 4096
sudo ethtool -C eth0 rx-usecs 1 tx-usecs 1

# –û—Ç–∫–ª—é—á–µ–Ω–∏–µ offloading
sudo ethtool -K eth0 gro off gso off tso off
```

#### –ü—Ä–æ—Ñ–∏–ª–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–í—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å (–¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–π):**
```ini
# /etc/ptp4l.conf - High Accuracy Profile
[global]
time_stamping         hardware
twoStepFlag           1
domainNumber          0
priority1             128
priority2             128
clockClass            6
clockAccuracy         0x20
offsetScaledLogVariance 0x436A
free_running          0
freq_est_interval     1
assume_two_step       0
tx_timestamp_timeout  1
check_fup_sync        0
clock_servo           pi
step_threshold        0.000000002
first_step_threshold  0.000000020
max_frequency         900000000
pi_proportional_const 0.0
pi_integral_const     0.0
pi_proportional_scale 0.0
pi_proportional_exponent -0.3
pi_proportional_norm_max 0.7
pi_integral_scale     0.0
pi_integral_exponent  0.4
pi_integral_norm_max  0.3
servo_num_offset_values 10
servo_offset_threshold 0
write_phase_mode      0
network_transport     UDPv4
delay_mechanism       E2E
summary_interval      0
kernel_leap           1
check_fup_sync        0

[eth0]
logAnnounceInterval   -2
logSyncInterval       -5
logMinDelayReqInterval -5
announceReceiptTimeout 3
syncReceiptTimeout    3
delay_mechanism       E2E
network_transport     UDPv4
```

**–°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
```ini
# /etc/ptp4l.conf - Balanced Profile
[global]
time_stamping         hardware
twoStepFlag           1
domainNumber          0
priority1             128
priority2             128
clockClass            248
clockAccuracy         0xFE
offsetScaledLogVariance 0xFFFF
free_running          0
freq_est_interval     1
assume_two_step       0
tx_timestamp_timeout  10
check_fup_sync        0
clock_servo           pi
step_threshold        0.000002
first_step_threshold  0.000020
max_frequency         900000000
pi_proportional_const 0.0
pi_integral_const     0.0
pi_proportional_scale 0.0
pi_proportional_exponent -0.3
pi_proportional_norm_max 0.7
pi_integral_scale     0.0
pi_integral_exponent  0.4
pi_integral_norm_max  0.3
servo_num_offset_values 10
servo_offset_threshold 0
write_phase_mode      0
network_transport     UDPv4
delay_mechanism       E2E
summary_interval      0
kernel_leap           1
check_fup_sync        0

[eth0]
logAnnounceInterval   1
logSyncInterval       0
logMinDelayReqInterval 0
announceReceiptTimeout 3
syncReceiptTimeout    0
delay_mechanism       E2E
network_transport     UDPv4
```

#### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–°–∫—Ä–∏–ø—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:**
```bash
#!/bin/bash
# performance-monitor.sh

LOG_FILE="/var/log/ptp-performance.log"
INTERVAL=1

echo "–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ PTP (–Ω–∞–∂–º–∏—Ç–µ Ctrl+C –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏)"
echo "–õ–æ–≥: $LOG_FILE"
echo

while true; do
    TIMESTAMP=$(date '+%Y-%m-%d %H:%M:%S.%3N')
    
    # PTP offset
    OFFSET=$(sudo phc_ctl /dev/ptp0 cmp 2>/dev/null | grep "offset" | awk '{print $2}' || echo "N/A")
    
    # PTP frequency
    FREQ=$(sudo phc_ctl /dev/ptp0 freq 2>/dev/null | grep "frequency" | awk '{print $2}' || echo "N/A")
    
    # CPU –∑–∞–≥—Ä—É–∑–∫–∞
    CPU_LOAD=$(uptime | awk -F'load average:' '{print $2}' | awk '{print $1}' | tr -d ',')
    
    # –ü–∞–º—è—Ç—å
    MEM_USED=$(free | grep '^Mem:' | awk '{printf "%.1f", $3/$2*100}')
    
    # –°–µ—Ç–µ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    RX_PACKETS=$(cat /proc/net/dev | grep eth0 | awk '{print $2}')
    TX_PACKETS=$(cat /proc/net/dev | grep eth0 | awk '{print $10}')
    
    # –ó–∞–ø–∏—Å—å –≤ –ª–æ–≥
    echo "$TIMESTAMP,$OFFSET,$FREQ,$CPU_LOAD,$MEM_USED,$RX_PACKETS,$TX_PACKETS" >> $LOG_FILE
    
    # –í—ã–≤–æ–¥ –Ω–∞ —ç–∫—Ä–∞–Ω
    printf "\r%s | Offset: %8s ns | Freq: %8s ppb | CPU: %5s%% | Mem: %5s%%" \
           "$TIMESTAMP" "$OFFSET" "$FREQ" "$CPU_LOAD" "$MEM_USED"
    
    sleep $INTERVAL
done
```

#### –ë–µ–Ω—á–º–∞—Ä–∫–∏ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**–°–∫—Ä–∏–ø—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–æ—á–Ω–æ—Å—Ç–∏:**
```bash
#!/bin/bash
# accuracy-benchmark.sh

DURATION=300  # 5 –º–∏–Ω—É—Ç
LOG_FILE="/var/log/ptp-accuracy-benchmark.log"

echo "–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ—á–Ω–æ—Å—Ç–∏ PTP –≤ —Ç–µ—á–µ–Ω–∏–µ $DURATION —Å–µ–∫—É–Ω–¥"
echo "–õ–æ–≥: $LOG_FILE"
echo

# –û—á–∏—Å—Ç–∫–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –ª–æ–≥–∞
> $LOG_FILE

# –ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –≤ —Ñ–æ–Ω–µ
{
    for ((i=0; i<$DURATION; i++)); do
        TIMESTAMP=$(date '+%Y-%m-%d %H:%M:%S.%3N')
        OFFSET=$(sudo phc_ctl /dev/ptp0 cmp 2>/dev/null | grep "offset" | awk '{print $2}' || echo "N/A")
        echo "$TIMESTAMP,$OFFSET" >> $LOG_FILE
        sleep 1
    done
} &

MONITOR_PID=$!

# –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
wait $MONITOR_PID

# –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
echo
echo "=== –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ ==="

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ offset
if [ -f "$LOG_FILE" ]; then
    # –°—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
    AVG_OFFSET=$(awk -F',' '{sum+=$2; count++} END {if(count>0) print sum/count; else print "N/A"}' $LOG_FILE)
    
    # –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
    MIN_OFFSET=$(awk -F',' '$2 != "N/A" {print $2}' $LOG_FILE | sort -n | head -1)
    
    # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
    MAX_OFFSET=$(awk -F',' '$2 != "N/A" {print $2}' $LOG_FILE | sort -n | tail -1)
    
    # –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ
    STD_DEV=$(awk -F',' -v avg="$AVG_OFFSET" '$2 != "N/A" {sum+=($2-avg)^2; count++} END {if(count>0) print sqrt(sum/count); else print "N/A"}' $LOG_FILE)
    
    echo "–°—Ä–µ–¥–Ω–∏–π offset: ${AVG_OFFSET} –Ω—Å"
    echo "–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π offset: ${MIN_OFFSET} –Ω—Å"
    echo "–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π offset: ${MAX_OFFSET} –Ω—Å"
    echo "–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ: ${STD_DEV} –Ω—Å"
    
    # –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞
    if [ "$AVG_OFFSET" != "N/A" ] && [ "${AVG_OFFSET#-}" -lt 1000 ]; then
        echo "‚úÖ –û—Ç–ª–∏—á–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å (< 1 –º–∫—Å)"
    elif [ "$AVG_OFFSET" != "N/A" ] && [ "${AVG_OFFSET#-}" -lt 10000 ]; then
        echo "‚úÖ –•–æ—Ä–æ—à–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å (< 10 –º–∫—Å)"
    elif [ "$AVG_OFFSET" != "N/A" ] && [ "${AVG_OFFSET#-}" -lt 100000 ]; then
        echo "‚ö†Ô∏è  –£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å (< 100 –º–∫—Å)"
    else
        echo "‚ùå –ù–∏–∑–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å (> 100 –º–∫—Å)"
    fi
else
    echo "‚ùå –õ–æ–≥ —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω"
fi
```

#### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

**–¢–µ–ª–µ–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è:**
```bash
# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —Ç–µ–ª–µ–∫–æ–º–∞
echo "–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è —Ç–µ–ª–µ–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã—Ö –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–π..."

# –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –≤—Å–µ—Ö –Ω–µ–Ω—É–∂–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
sudo systemctl stop bluetooth
sudo systemctl disable bluetooth
sudo systemctl stop cups
sudo systemctl disable cups

# –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–µ—Ç–∏
sudo ethtool -s eth0 speed 1000 duplex full autoneg off
sudo ethtool -G eth0 rx 8192 tx 8192
sudo ethtool -C eth0 rx-usecs 1 tx-usecs 1

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ PTP –¥–ª—è —Ç–µ–ª–µ–∫–æ–º–∞
sudo tee /etc/ptp4l.conf << 'EOF'
[global]
dataset_comparison         G.8275.x
G.8275.defaultDS.localPriority 128
domainNumber               24
priority1                  128
priority2                  128
clockClass                 165
clockAccuracy              0x21
offsetScaledLogVariance    0x4E5D
free_running               0
freq_est_interval          1
assume_two_step            0
tx_timestamp_timeout       10
check_fup_sync             0
clock_servo                linreg
step_threshold             0.000002
first_step_threshold       0.000020
max_frequency              900000000
sanity_freq_limit          200000000
network_transport          L2
ptp_dst_mac                01:1B:19:00:00:00
p2p_dst_mac                01:80:C2:00:00:0E
verbose                    0
use_syslog                 1
logging_level              6

[eth0]
logAnnounceInterval        0
logSyncInterval           -4
logMinDelayReqInterval    -4
logMinPdelayReqInterval   -4
announceReceiptTimeout     3
syncReceiptTimeout         3
delay_mechanism            P2P
network_transport          L2
masterOnly                 0
G.8275.portDS.localPriority 128
EOF
```

**–ü—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è:**
```bash
# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç–∏
echo "–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã—Ö –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–π..."

# –û—Ç–∫–ª—é—á–µ–Ω–∏–µ GUI –∏ –Ω–µ–Ω—É–∂–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
sudo systemctl set-default multi-user.target

# –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
echo 'vm.swappiness=10' | sudo tee -a /etc/sysctl.conf
echo 'vm.dirty_ratio=15' | sudo tee -a /etc/sysctl.conf
echo 'vm.dirty_background_ratio=5' | sudo tee -a /etc/sysctl.conf

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ PTP –¥–ª—è –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç–∏
sudo tee /etc/ptp4l.conf << 'EOF'
[global]
dataset_comparison         ieee1588
domainNumber               0
priority1                  128
priority2                  128
clockClass                 248
clockAccuracy              0xFE
offsetScaledLogVariance    0xFFFF
free_running               0
freq_est_interval          1
assume_two_step            0
tx_timestamp_timeout       50
check_fup_sync             0
clock_servo                pi
step_threshold             0.000002
first_step_threshold       0.000020
max_frequency              900000000
pi_proportional_const      0.0
pi_integral_const          0.0
pi_proportional_scale      0.0
pi_proportional_exponent   -0.3
pi_proportional_norm_max   0.7
pi_integral_scale          0.0
pi_integral_exponent       0.4
pi_integral_norm_max       0.3
servo_num_offset_values    10
servo_offset_threshold     0
write_phase_mode           0
network_transport          UDPv4
delay_mechanism            E2E
verbose                    1
use_syslog                 1
summary_interval           0
kernel_leap                1
check_fup_sync             0

[eth0]
logAnnounceInterval        1
logSyncInterval            0
logMinDelayReqInterval     0
announceReceiptTimeout     3
syncReceiptTimeout         0
delay_mechanism            E2E
network_transport          UDPv4
EOF
```

---

### 24. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º

#### –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã:**
- **IEEE 1588-2008**: Precision Time Protocol (PTP) v2
- **IEEE 1588-2019**: Precision Time Protocol (PTP) v2.1
- **ITU-T G.8275.1**: PTP Profile for Phase/Timing Applications with Full Timing Support from the Network
- **ITU-T G.8275.2**: PTP Profile for Phase/Timing Applications with Partial Timing Support from the Network
- **RFC 5905**: Network Time Protocol Version 4: Protocol and Algorithms Specification
- **RFC 5906**: Network Time Protocol Version 4: Autokey Specification
- **RFC 5907**: Definitions of Managed Objects for Network Time Protocol Version 4 (NTPv4)

**–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ:**
- **CE Marking**: –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –µ–≤—Ä–æ–ø–µ–π—Å–∫–∏–º –¥–∏—Ä–µ–∫—Ç–∏–≤–∞–º
- **FCC Part 15**: –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º FCC –¥–ª—è —Ü–∏—Ñ—Ä–æ–≤—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- **RoHS**: –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –¥–∏—Ä–µ–∫—Ç–∏–≤–µ RoHS –ø–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—é –æ–ø–∞—Å–Ω—ã—Ö –≤–µ—â–µ—Å—Ç–≤
- **ISO 9001**: –°–∏—Å—Ç–µ–º–∞ –º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–∞ –∫–∞—á–µ—Å—Ç–≤–∞

#### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã

**–§–∏–∑–∏—á–µ—Å–∫–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
```bash
# –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–µ—Ä–≤–µ—Ä—É
# - –†–∞–∑–º–µ—â–µ–Ω–∏–µ –≤ –∑–∞—â–∏—â–µ–Ω–Ω–æ–º –ø–æ–º–µ—â–µ–Ω–∏–∏
# - –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–µ—Ä–≤–µ—Ä–Ω–æ–π –∫–æ–º–Ω–∞—Ç–µ
# - –í–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ
# - –ó–∞—â–∏—Ç–∞ –æ—Ç —ç–ª–µ–∫—Ç—Ä–æ–º–∞–≥–Ω–∏—Ç–Ω—ã—Ö –ø–æ–º–µ—Ö
```

**–°–µ—Ç–µ–≤–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
```bash
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ firewall –¥–ª—è PTP
sudo ufw allow 319/udp comment "PTP Event"
sudo ufw allow 320/udp comment "PTP General"

# –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ PTP –ø–æ—Ä—Ç–∞–º
sudo iptables -A INPUT -p udp --dport 319 -s 192.168.1.0/24 -j ACCEPT
sudo iptables -A INPUT -p udp --dport 320 -s 192.168.1.0/24 -j ACCEPT
sudo iptables -A INPUT -p udp --dport 319 -j DROP
sudo iptables -A INPUT -p udp --dport 320 -j DROP

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ VPN –¥–ª—è —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
sudo openvpn --config /etc/openvpn/server.conf
```

**–ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞:**
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã –¥–ª—è PTP –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
sudo groupadd ptp-admin
sudo usermod -a -G ptp-admin ptp-user

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ sudo –¥–ª—è PTP –∫–æ–º–∞–Ω–¥
sudo tee /etc/sudoers.d/ptp-admin << 'EOF'
%ptp-admin ALL=(ALL) NOPASSWD: /usr/sbin/ptp4l, /usr/sbin/phc2sys, /usr/sbin/ts2phc
%ptp-admin ALL=(ALL) NOPASSWD: /bin/cat /sys/class/timecard/ocp*/*
%ptp-admin ALL=(ALL) NOPASSWD: /bin/echo * > /sys/class/timecard/ocp*/*
EOF

# –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ sysfs
sudo chmod 640 /sys/class/timecard/ocp0/*
sudo chown root:ptp-admin /sys/class/timecard/ocp0/*
```

#### –ê—É–¥–∏—Ç –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞—É–¥–∏—Ç–∞:**
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ auditd
sudo apt install auditd audispd-plugins

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤–∏–ª –∞—É–¥–∏—Ç–∞
sudo tee /etc/audit/rules.d/ptp.rules << 'EOF'
# –ê—É–¥–∏—Ç PTP –æ–ø–µ—Ä–∞—Ü–∏–π
-w /usr/sbin/ptp4l -p x -k ptp
-w /usr/sbin/phc2sys -p x -k ptp
-w /usr/sbin/ts2phc -p x -k ptp

# –ê—É–¥–∏—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ sysfs
-w /sys/class/timecard/ocp0/ -p rwxa -k timecard

# –ê—É–¥–∏—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
-w /etc/ptp4l.conf -p wa -k ptp-config
-w /etc/chrony/chrony.conf -p wa -k chrony-config
EOF

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ auditd
sudo systemctl restart auditd
```

**–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```bash
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ rsyslog –¥–ª—è —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
sudo tee /etc/rsyslog.d/50-ptp.conf << 'EOF'
# PTP –ª–æ–≥–∏
:programname, isequal, "ptp4l" /var/log/ptp/ptp4l.log
:programname, isequal, "phc2sys" /var/log/ptp/phc2sys.log
:programname, isequal, "ts2phc" /var/log/ptp/ts2phc.log

# TimeCard –ª–æ–≥–∏
:programname, isequal, "ptp_ocp" /var/log/ptp/timecard.log
EOF

# –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –¥–ª—è –ª–æ–≥–æ–≤
sudo mkdir -p /var/log/ptp
sudo chown syslog:syslog /var/log/ptp

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ rsyslog
sudo systemctl restart rsyslog
```

#### –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```bash
#!/bin/bash
# backup-security.sh

BACKUP_DIR="/backup/quantum-pci-security"
DATE=$(date +%Y%m%d_%H%M%S)

mkdir -p $BACKUP_DIR

# –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
sudo cp /etc/ptp4l.conf $BACKUP_DIR/ptp4l_$DATE.conf
sudo cp /etc/chrony/chrony.conf $BACKUP_DIR/chrony_$DATE.conf
sudo cp /etc/udev/rules.d/99-ptp.rules $BACKUP_DIR/udev-rules_$DATE.rules

# –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–ª—é—á–µ–π –∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
sudo cp -r /etc/ssl/private $BACKUP_DIR/ssl-private_$DATE/
sudo cp -r /etc/ssl/certs $BACKUP_DIR/ssl-certs_$DATE/

# –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–æ–≤ –∞—É–¥–∏—Ç–∞
sudo cp /var/log/audit/audit.log $BACKUP_DIR/audit_$DATE.log

# –°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ö–∏–≤–∞
tar -czf $BACKUP_DIR/quantum-pci-security-backup_$DATE.tar.gz -C $BACKUP_DIR .

# –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π (—Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π)
find $BACKUP_DIR -name "*.tar.gz" -mtime +30 -delete

echo "–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–æ: $BACKUP_DIR"
```

#### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**–°–∫—Ä–∏–ø—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**
```bash
#!/bin/bash
# security-monitor.sh

LOG_FILE="/var/log/quantum-pci-security.log"
TIMESTAMP=$(date '+%Y-%m-%d %H:%M:%S')

echo "=== –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Quantum-PCI ===" | tee -a $LOG_FILE
echo "–í—Ä–µ–º—è: $TIMESTAMP" | tee -a $LOG_FILE
echo | tee -a $LOG_FILE

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ —Ñ–∞–π–ª–æ–≤
echo "üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ —Ñ–∞–π–ª–æ–≤:" | tee -a $LOG_FILE
if [ -f "/var/lib/dpkg/info/ptp4l.md5sums" ]; then
    if md5sum -c /var/lib/dpkg/info/ptp4l.md5sums >/dev/null 2>&1; then
        echo "‚úÖ PTP4L: –§–∞–π–ª—ã –Ω–µ –∏–∑–º–µ–Ω–µ–Ω—ã" | tee -a $LOG_FILE
    else
        echo "‚ùå PTP4L: –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ñ–∞–π–ª–∞—Ö" | tee -a $LOG_FILE
    fi
else
    echo "‚ö†Ô∏è  PTP4L: –ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å" | tee -a $LOG_FILE
fi

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
echo "üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞:" | tee -a $LOG_FILE
if [ -d "/sys/class/timecard/ocp0" ]; then
    PERMS=$(ls -la /sys/class/timecard/ocp0/ | head -5)
    echo "–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ sysfs:" | tee -a $LOG_FILE
    echo "$PERMS" | tee -a $LOG_FILE
else
    echo "‚ùå TimeCard sysfs –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω" | tee -a $LOG_FILE
fi

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
echo "üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π:" | tee -a $LOG_FILE
PTP_CONNECTIONS=$(netstat -tuln | grep -E ":319|:320" | wc -l)
echo "–ê–∫—Ç–∏–≤–Ω—ã–µ PTP –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: $PTP_CONNECTIONS" | tee -a $LOG_FILE

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
echo "üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤:" | tee -a $LOG_FILE
PTP_PROCESSES=$(ps aux | grep -E "(ptp4l|phc2sys|ts2phc)" | grep -v grep | wc -l)
echo "–ê–∫—Ç–∏–≤–Ω—ã–µ PTP –ø—Ä–æ—Ü–µ—Å—Å—ã: $PTP_PROCESSES" | tee -a $LOG_FILE

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
echo "üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤:" | tee -a $LOG_FILE
SUSPICIOUS_ACTIVITY=$(grep -i -E "(error|fail|denied|unauthorized)" /var/log/syslog | grep -i ptp | wc -l)
echo "–ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤ –ª–æ–≥–∞—Ö: $SUSPICIOUS_ACTIVITY" | tee -a $LOG_FILE

echo | tee -a $LOG_FILE
echo "–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∑–∞–≤–µ—Ä—à–µ–Ω" | tee -a $LOG_FILE
```

#### –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º:**
```bash
#!/bin/bash
# compliance-check.sh

echo "=== –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º ==="
echo "–í—Ä–µ–º—è: $(date)"
echo

# –ü—Ä–æ–≤–µ—Ä–∫–∞ IEEE 1588 —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è
echo "üîç IEEE 1588 —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ:"
if [ -c "/dev/ptp0" ]; then
    echo "‚úÖ PTP —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –¥–æ—Å—Ç—É–ø–Ω–æ"
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–≤—É—Ö—Å—Ç—É–ø–µ–Ω—á–∞—Ç–æ–≥–æ —Ä–µ–∂–∏–º–∞
    if grep -q "twoStepFlag.*1" /etc/ptp4l.conf; then
        echo "‚úÖ –î–≤—É—Ö—Å—Ç—É–ø–µ–Ω—á–∞—Ç—ã–π —Ä–µ–∂–∏–º –≤–∫–ª—é—á–µ–Ω"
    else
        echo "‚ùå –î–≤—É—Ö—Å—Ç—É–ø–µ–Ω—á–∞—Ç—ã–π —Ä–µ–∂–∏–º –Ω–µ –≤–∫–ª—é—á–µ–Ω"
    fi
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã—Ö –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫
    if grep -q "time_stamping.*hardware" /etc/ptp4l.conf; then
        echo "‚úÖ –ê–ø–ø–∞—Ä–∞—Ç–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ –≤–∫–ª—é—á–µ–Ω—ã"
    else
        echo "‚ùå –ê–ø–ø–∞—Ä–∞—Ç–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ –Ω–µ –≤–∫–ª—é—á–µ–Ω—ã"
    fi
else
    echo "‚ùå PTP —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ"
fi

# –ü—Ä–æ–≤–µ—Ä–∫–∞ NTP —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è
echo
echo "üîç NTP —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ:"
if systemctl is-active --quiet chronyd; then
    echo "‚úÖ Chrony –∞–∫—Ç–∏–≤–µ–Ω"
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è PHC
    if grep -q "refclock PHC" /etc/chrony/chrony.conf; then
        echo "‚úÖ PHC –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –∏—Å—Ç–æ—á–Ω–∏–∫ –≤—Ä–µ–º–µ–Ω–∏"
    else
        echo "‚ùå PHC –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –∏—Å—Ç–æ—á–Ω–∏–∫ –≤—Ä–µ–º–µ–Ω–∏"
    fi
else
    echo "‚ùå Chrony –Ω–µ –∞–∫—Ç–∏–≤–µ–Ω"
fi

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
echo
echo "üîç –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:"
if [ -f "/etc/audit/rules.d/ptp.rules" ]; then
    echo "‚úÖ –ê—É–¥–∏—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω"
else
    echo "‚ùå –ê—É–¥–∏—Ç –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω"
fi

if ufw status | grep -q "319.*ALLOW"; then
    echo "‚úÖ Firewall –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è PTP"
else
    echo "‚ùå Firewall –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è PTP"
fi

echo
echo "–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞"
```

#### –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –∞—É–¥–∏—Ç–∞

**–°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–∞ –æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏:**
```bash
#!/bin/bash
# compliance-report.sh

REPORT_FILE="/var/log/quantum-pci-compliance-report.txt"
DATE=$(date '+%Y-%m-%d %H:%M:%S')

echo "=== –û—Ç—á–µ—Ç –æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º Quantum-PCI ===" > $REPORT_FILE
echo "–î–∞—Ç–∞: $DATE" >> $REPORT_FILE
echo "–°–∏—Å—Ç–µ–º–∞: $(hostname)" >> $REPORT_FILE
echo "–í–µ—Ä—Å–∏—è —è–¥—Ä–∞: $(uname -r)" >> $REPORT_FILE
echo >> $REPORT_FILE

# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ
echo "=== –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ ===" >> $REPORT_FILE
echo "–û–°: $(lsb_release -d | cut -f2)" >> $REPORT_FILE
echo "–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: $(uname -m)" >> $REPORT_FILE
echo "–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã: $(uptime -p)" >> $REPORT_FILE
echo >> $REPORT_FILE

# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ TimeCard
echo "=== –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ TimeCard ===" >> $REPORT_FILE
if [ -d "/sys/class/timecard/ocp0" ]; then
    echo "–°–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä: $(cat /sys/class/timecard/ocp0/serialnum 2>/dev/null || echo 'N/A')" >> $REPORT_FILE
    echo "–ò—Å—Ç–æ—á–Ω–∏–∫ –≤—Ä–µ–º–µ–Ω–∏: $(cat /sys/class/timecard/ocp0/clock_source 2>/dev/null || echo 'N/A')" >> $REPORT_FILE
    echo "GNSS —Å—Ç–∞—Ç—É—Å: $(cat /sys/class/timecard/ocp0/gnss_sync 2>/dev/null || echo 'N/A')" >> $REPORT_FILE
else
    echo "TimeCard –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞" >> $REPORT_FILE
fi
echo >> $REPORT_FILE

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è PTP
echo "=== –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è PTP ===" >> $REPORT_FILE
if [ -f "/etc/ptp4l.conf" ]; then
    echo "–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª: /etc/ptp4l.conf" >> $REPORT_FILE
    echo "–û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:" >> $REPORT_FILE
    grep -E "(domainNumber|priority1|priority2|clockClass|time_stamping|twoStepFlag)" /etc/ptp4l.conf >> $REPORT_FILE
else
    echo "–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª PTP –Ω–µ –Ω–∞–π–¥–µ–Ω" >> $REPORT_FILE
fi
echo >> $REPORT_FILE

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è NTP
echo "=== –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è NTP ===" >> $REPORT_FILE
if [ -f "/etc/chrony/chrony.conf" ]; then
    echo "–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª: /etc/chrony/chrony.conf" >> $REPORT_FILE
    echo "–ò—Å—Ç–æ—á–Ω–∏–∫–∏ –≤—Ä–µ–º–µ–Ω–∏:" >> $REPORT_FILE
    grep -E "(server|refclock)" /etc/chrony/chrony.conf >> $REPORT_FILE
else
    echo "–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª Chrony –Ω–µ –Ω–∞–π–¥–µ–Ω" >> $REPORT_FILE
fi
echo >> $REPORT_FILE

# –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤
echo "=== –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤ ===" >> $REPORT_FILE
systemctl is-active ptp4l >> $REPORT_FILE
systemctl is-active phc2sys >> $REPORT_FILE
systemctl is-active chrony >> $REPORT_FILE
echo >> $REPORT_FILE

# –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
echo "=== –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å ===" >> $REPORT_FILE
echo "Firewall —Å—Ç–∞—Ç—É—Å:" >> $REPORT_FILE
ufw status >> $REPORT_FILE
echo >> $REPORT_FILE

echo "–û—Ç—á–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤: $REPORT_FILE"
```

---

### 25. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: –ø—Ä–∏–º–µ—Ä—ã systemd‚Äë—é–Ω–∏—Ç–æ–≤

`/etc/systemd/system/ptp4l.service`:

```ini
[Unit]
Description=linuxptp ptp4l
After=network-online.target
Wants=network-online.target

[Service]
Type=simple
ExecStart=/usr/sbin/ptp4l -f /etc/linuxptp/ptp4l.conf -m
Restart=always
RestartSec=2

[Install]
WantedBy=multi-user.target
```

`/etc/systemd/system/phc2sys.service`:

```ini
[Unit]
Description=linuxptp phc2sys
After=ptp4l.service
Requires=ptp4l.service

[Service]
Type=simple
ExecStart=/usr/sbin/phc2sys -s /dev/ptp0 -c CLOCK_REALTIME -O 0 -m
Restart=always
RestartSec=2

[Install]
WantedBy=multi-user.target
```

–ê–∫—Ç–∏–≤–∞—Ü–∏—è:

```bash
sudo systemctl daemon-reload
sudo systemctl enable --now ptp4l phc2sys
```

---

### 21. –°—Å—ã–ª–∫–∏ –Ω–∞ –º–∞—Ç–µ—Ä–∏–∞–ª—ã —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

- `–î–†–ê–ô–í–ï–†–ê/–ò–ù–°–¢–†–£–ö–¶–ò–Ø_–ü–û_–†–ê–ë–û–¢–ï_–°_–ü–†–û–®–ò–í–ö–ê–ú–ò.md`
- `–î–†–ê–ô–í–ï–†–ê/–ò–ù–°–¢–†–£–ö–¶–ò–Ø_–ü–†–û–®–ò–í–ö–ò_–ü–†–û–ì–†–ê–ú–ú–ê–¢–û–†–û–ú.md`
- `docs/guides/installation.md` –∏ `docs/guides/linuxptp-guide.md`
- `docs/guides/chrony-guide.md` –∏ `docs/guides/precision-time-protocols.md`

---

### 22. –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –ø—Ä–∏–ª–æ–∂–∏—Ç–µ –≤–µ—Ä—Å–∏–∏ —è–¥—Ä–∞ (`uname -a`), –¥—Ä–∞–π–≤–µ—Ä–∞, –≤—ã–≤–æ–¥ `dmesg` –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã `ptp4l`/`chrony`.



---

### 23. –ö–æ–Ω—Å–æ–ª–∏–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞ docs

–≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –∫–ª—é—á–µ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∏–∑ –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏: –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç, —É—Å—Ç–∞–Ω–æ–≤–∫–∞, LinuxPTP, Chrony, –¥–µ—Ç–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫.

‚Äî –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (—É—Å—Ç–∞–Ω–æ–≤–∫–∞, —Å–±–æ—Ä–∫–∞, –∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥—É–ª—è): —Å–º. —Ä–∞–∑–¥–µ–ª—ã 6, 9‚Äì10 –∏ —Å–≤–æ–¥–∫–∞ –Ω–∏–∂–µ.
‚Äî –ü–æ–ª–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: —Å–≤–æ–¥–∫–∞ –ø–æ `installation` –Ω–∏–∂–µ.
‚Äî LinuxPTP/Chrony: —Å–≤–æ–¥–∫–∏ –Ω–∏–∂–µ + —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π.
‚Äî –î–µ—Ç–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥—Ä–∞–π–≤–µ—Ä–∞ –∏ sysfs: —Å–≤–æ–¥–∫–∞ –Ω–∏–∂–µ.
‚Äî –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞: —Å–≤–æ–¥–∫–∞ –Ω–∏–∂–µ.

---

### 24. –°–≤–æ–¥–∫–∞: —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥—Ä–∞–π–≤–µ—Ä–∞

- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (Debian/Ubuntu):

```bash
sudo apt update && sudo apt install -y \
  build-essential linux-headers-$(uname -r) git make gcc dkms pkg-config \
  linuxptp chrony ethtool pciutils usbutils kmod
```

- –°–±–æ—Ä–∫–∞ –∏ –∑–∞–≥—Ä—É–∑–∫–∞:

```bash
cd –î–†–ê–ô–í–ï–†–ê
make clean && make
sudo insmod ptp_ocp.ko || sudo modprobe ptp_ocp
lsmod | grep ptp_ocp || true
dmesg -T | grep -i ptp_ocp || true
```

- –ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞:

```bash
sudo make install && sudo depmod -a
echo "ptp_ocp" | sudo tee -a /etc/modules
sudo tee /etc/modprobe.d/ptp-ocp.conf << 'EOF'
# PTP OCP driver configuration
options ptp_ocp debug=0
EOF
```

- Udev –ø—Ä–∞–≤–∏–ª–∞ (–¥–æ—Å—Ç—É–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º):

```bash
sudo tee /etc/udev/rules.d/99-ptp.rules << 'EOF'
SUBSYSTEM=="ptp", GROUP="dialout", MODE="0664"
KERNEL=="ptp[0-9]*", GROUP="dialout", MODE="0664"
EOF
sudo udevadm control --reload-rules && sudo udevadm trigger
```

- Systemd –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥—É–ª—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):

```bash
sudo tee /etc/systemd/system/ptp-ocp.service << 'EOF'
[Unit]
Description=PTP OCP Driver
After=multi-user.target

[Service]
Type=oneshot
ExecStart=/sbin/modprobe ptp_ocp
ExecStop=/sbin/rmmod ptp_ocp
RemainAfterExit=yes

[Install]
WantedBy=multi-user.target
EOF
sudo systemctl enable --now ptp-ocp.service
```

- –í–∞—Ä–∏–∞–Ω—Ç —á–µ—Ä–µ–∑ DKMS (–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —è–¥—Ä–∞):

```bash
sudo mkdir -p /usr/src/ptp-ocp-1.0
sudo cp -r –î–†–ê–ô–í–ï–†–ê/* /usr/src/ptp-ocp-1.0/
sudo tee /usr/src/ptp-ocp-1.0/dkms.conf << 'EOF'
PACKAGE_NAME="ptp-ocp"
PACKAGE_VERSION="1.0"
BUILT_MODULE_NAME[0]="ptp_ocp"
DEST_MODULE_LOCATION[0]="/kernel/drivers/ptp/"
AUTOINSTALL="yes"
EOF
sudo dkms add -m ptp-ocp -v 1.0
sudo dkms build -m ptp-ocp -v 1.0
sudo dkms install -m ptp-ocp -v 1.0
```

---

### 25. –°–≤–æ–¥–∫–∞: LinuxPTP (ptp4l, phc2sys, ts2phc)

- –£—Å—Ç–∞–Ω–æ–≤–∫–∞:

```bash
sudo apt update && sudo apt install -y linuxptp
```

- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã—Ö –º–µ—Ç–æ–∫ –∏ PHC:

```bash
ethtool -T eth0
ls /dev/ptp*
```

- –ë–∞–∑–æ–≤—ã–π –∑–∞–ø—É—Å–∫ `ptp4l` –∏ `phc2sys`:

```bash
sudo ptp4l -i eth0 -m            # –∞–≤—Ç–æ-—Ä–æ–ª—å (OC)
sudo ptp4l -i eth0 -s -m         # –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ slaveOnly
sudo phc2sys -s /dev/ptp0 -c CLOCK_REALTIME -O 0 -m
```

- –ö–æ–Ω—Ñ–∏–≥ `ptp4l` (–º–∏–Ω–∏–º—É–º):

```ini
[global]
time_stamping         hardware
twoStepFlag           1
delay_mechanism       E2E
network_transport     UDPv4
```

- `ts2phc` –¥–ª—è –≤–Ω–µ—à–Ω–µ–≥–æ PPS (GPS/–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä):

```bash
sudo tee /etc/ts2phc.conf << 'EOF'
[global]
verbose 1
logging_level 6

[/dev/ptp0]
ts2phc.pin_index 0
ts2phc.channel 0
ts2phc.extts_polarity rising
ts2phc.extts_correction 0

[/dev/pps0]
ts2phc.master 1
EOF
sudo ts2phc -f /etc/ts2phc.conf -m
```

- –ü—Ä–æ—Ñ–∏–ª–∏ (–ø—Ä–∏–º–µ—Ä): —Ç–µ–ª–µ–∫–æ–º/–≤—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å —Å–º. —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ PTP. 

---

### 26. –°–≤–æ–¥–∫–∞: Chrony (—Ä–∞–±–æ—Ç–∞ —Å PHC/PPS)

- –£—Å—Ç–∞–Ω–æ–≤–∫–∞:

```bash
sudo apt update && sudo apt install -y chrony
```

- –ë–∞–∑–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞ `/etc/chrony/chrony.conf`:

```conf
pool pool.ntp.org iburst
rtcsync
makestep 1.0 3
```

- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ PHC –∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) PPS –∫–∞–∫ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤:

```conf
refclock PHC /dev/ptp0 poll 0 dpoll -2 offset 0 stratum 1 prefer
# refclock PPS /dev/pps0 lock PHC precision 1e-9
```

- –ö–æ–º–∞–Ω–¥—ã –ø—Ä–æ–≤–µ—Ä–∫–∏:

```bash
sudo systemctl restart chrony
chronyc tracking
chronyc sources -v
chronyc refclocks
```

---

### 27. –°–≤–æ–¥–∫–∞: –¥–µ—Ç–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥—Ä–∞–π–≤–µ—Ä–∞ –∏ sysfs

- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥—É–ª—è `/etc/modprobe.d/ptp-ocp.conf`:

```bash
options ptp_ocp debug=0
```

- –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã —è–¥—Ä–∞:
  - PTP: `/sys/class/ptp/ptpN`, —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ `/dev/ptpN`.
  - –ö–ª–∞—Å—Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞: `/sys/class/timecard/ocpN` (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω –≤ –≤–∞—à–µ–π —Å–±–æ—Ä–∫–µ/–ø—Ä–æ—à–∏–≤–∫–µ).

- –ü—Ä–∏–º–µ—Ä—ã –æ–ø–µ—Ä–∞—Ü–∏–π —á–µ—Ä–µ–∑ sysfs (–µ—Å–ª–∏ –∫–ª–∞—Å—Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –¥–æ—Å—Ç—É–ø–µ–Ω):

```bash
BASE="/sys/class/timecard/ocp0"
[ -d "$BASE" ] || exit 0
cat $BASE/available_clock_sources
echo "GNSS" > $BASE/clock_source
echo "10MHz" > $BASE/sma1
echo "PPS"   > $BASE/sma2
echo "10MHz" > $BASE/sma3
echo "PPS"   > $BASE/sma4
echo "100"   > $BASE/external_pps_cable_delay
echo "37"    > $BASE/utc_tai_offset
```

- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–∏–Ω–æ–≤ PTP (–µ—Å–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è):

```bash
PTP="/sys/class/ptp/ptp0"
echo "perout 0 0" > $PTP/pins/SMA1   # –≤—ã—Ö–æ–¥ 1PPS/–ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π
echo "extts 0 0"  > $PTP/pins/SMA2   # –≤—Ö–æ–¥ PPS
```

---

### 28. –°–µ—Ç–µ–≤–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è PTP

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ hardware timestamping
ethtool -T eth0

# –ë–∞–∑–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–∏–Ω–∫–∞
sudo ethtool -s eth0 speed 1000 duplex full autoneg off

# –ë—É—Ñ–µ—Ä—ã –∏ coalesce
sudo ethtool -G eth0 rx 4096 tx 4096
sudo ethtool -C eth0 rx-usecs 1 tx-usecs 1

# Multicast –¥–ª—è PTP (–ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)
sudo ip maddr add 01:1B:19:00:00:00 dev eth0
sudo ip maddr add 01:80:C2:00:00:0E dev eth0

# –ü—Ä–∏–º–µ—Ä netplan (Ubuntu) –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è PTP –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
sudo tee /etc/netplan/01-ptp.yaml << 'EOF'
network:
  version: 2
  ethernets:
    eth0:
      dhcp4: true
      dhcp6: false
      optional: true
EOF
sudo netplan apply

# –û—Ç–∫—Ä—ã—Ç—å UFW –ø–æ—Ä—Ç—ã PTP (–µ—Å–ª–∏ UFW –≤–∫–ª—é—á—ë–Ω)
sudo ufw allow 319/udp comment "PTP Event"
sudo ufw allow 320/udp comment "PTP General"
```

–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: IRQ affinity –∏ –∏–∑–æ–ª—è—Ü–∏—è CPU –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è –¥–∂–∏—Ç—Ç–µ—Ä–∞.

---

### 29. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ A: –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç ‚Äî –ø–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç

# –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

## –û–±–∑–æ—Ä

–î–∞–Ω–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–º–æ–∂–µ—Ç –≤–∞–º –±—ã—Å—Ç—Ä–æ –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –¥—Ä–∞–π–≤–µ—Ä–æ–º PTP OCP –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏.

## –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Linux —è–¥—Ä–æ –≤–µ—Ä—Å–∏–∏ 5.4 –∏–ª–∏ –≤—ã—à–µ
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ PCI –≤ —è–¥—Ä–µ
- –ú–æ–¥—É–ª–∏ PTP –≤–∫–ª—é—á–µ–Ω—ã –≤ —è–¥—Ä–æ
- Root –ø—Ä–∞–≤–∞ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –¥—Ä–∞–π–≤–µ—Ä–∞

### –ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–∞–∫–µ—Ç—ã

```bash
# Ubuntu/Debian
sudo apt-get install build-essential linux-headers-$(uname -r) git

# CentOS/RHEL/Fedora
sudo yum install gcc kernel-devel kernel-headers git
# –∏–ª–∏ –¥–ª—è –Ω–æ–≤—ã—Ö –≤–µ—Ä—Å–∏–π
sudo dnf install gcc kernel-devel kernel-headers git
```

## –ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –ü–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞

```bash
git clone <repository-url>
cd ptp-ocp-driver
```

### 2. –°–±–æ—Ä–∫–∞ –¥—Ä–∞–π–≤–µ—Ä–∞

```bash
cd –î–†–ê–ô–í–ï–†–ê
make
```

### 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥—Ä–∞–π–≤–µ—Ä–∞

```bash
sudo make install
sudo modprobe ptp_ocp
```

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥—É–ª—è
lsmod | grep ptp_ocp

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è TimeCard —É—Å—Ç—Ä–æ–π—Å—Ç–≤
ls /sys/class/timecard/

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è PTP —É—Å—Ç—Ä–æ–π—Å—Ç–≤
ls /dev/ptp*

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ dmesg
dmesg | grep ptp_ocp
```

## –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ TimeCard —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
if [ -d "/sys/class/timecard/ocp0" ]; then
    echo "TimeCard device found"
    cat /sys/class/timecard/ocp0/serialnum
    cat /sys/class/timecard/ocp0/clock_source
else
    echo "TimeCard device not found"
fi

# –ü–æ–ª—É—á–µ–Ω–∏–µ PTP —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∏–∑ TimeCard
if [ -L "/sys/class/timecard/ocp0/ptp" ]; then
    PTP_DEV=$(basename $(readlink /sys/class/timecard/ocp0/ptp))
    echo "PTP device: /dev/$PTP_DEV"
else
    PTP_DEV="ptp0"
fi

# –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ PTP —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
sudo testptp -d /dev/$PTP_DEV -c

# –ü—Ä–æ–≤–µ—Ä–∫–∞ capabilities
sudo testptp -d /dev/$PTP_DEV -k
```

### –ë–∞–∑–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```bash
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ TimeCard (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ)
if [ -d "/sys/class/timecard/ocp0" ]; then
    echo "Configuring TimeCard..."
    echo "GNSS" > /sys/class/timecard/ocp0/clock_source
    echo "PPS" > /sys/class/timecard/ocp0/sma3
    echo "TimeCard configured"
fi

# –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
sudo testptp -d /dev/$PTP_DEV -g

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ (–ø—Ä–∏–º–µ—Ä)
sudo testptp -d /dev/$PTP_DEV -t $(date +%s)

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ—á–Ω–æ—Å—Ç–∏
sudo testptp -d /dev/$PTP_DEV -o
```

## –ü–µ—Ä–≤—ã–π —Ç–µ—Å—Ç

### –ó–∞–ø—É—Å–∫ –¥–µ–º–æ–Ω–∞ PTP

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ LinuxPTP (–µ—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
sudo apt-get install linuxptp  # Ubuntu/Debian
# –∏–ª–∏
sudo yum install linuxptp      # CentOS/RHEL

# –ó–∞–ø—É—Å–∫ PTP master (–∏—Å–ø–æ–ª—å–∑—É—è –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é PTP_DEV –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Ä–∞–∑–¥–µ–ª–∞)
sudo ptp4l -i eth0 -m -p /dev/$PTP_DEV

# –í –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
sudo phc2sys -s /dev/$PTP_DEV -m
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ TimeCard (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ)
if [ -d "/sys/class/timecard/ocp0" ]; then
    echo "GNSS sync status: $(cat /sys/class/timecard/ocp0/gnss_sync)"
fi

# –ü—Ä–æ–≤–µ—Ä–∫–∞ offset –º–µ–∂–¥—É PTP –∏ —Å–∏—Å—Ç–µ–º–Ω—ã–º –≤—Ä–µ–º–µ–Ω–µ–º
sudo phc2sys -s /dev/$PTP_DEV -c CLOCK_REALTIME -O 0 -u 10

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
sudo testptp -d /dev/$PTP_DEV -o
```

## –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –î—Ä–∞–π–≤–µ—Ä –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—à–∏–±–æ–∫ –≤ dmesg
dmesg | tail -20

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
modinfo ptp_ocp

# –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
sudo insmod ./ptp_ocp.ko
```

### –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ PCI —É—Å—Ç—Ä–æ–π—Å—Ç–≤
lspci | grep -i ptp
lspci | grep -i time

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
lspci -nn | grep -E "(1d9b|8086)"
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞

```bash
# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –≥—Ä—É–ø–ø—É
sudo usermod -a -G dialout $USER

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∞–≤–∏–ª udev
echo 'SUBSYSTEM=="ptp", GROUP="dialout", MODE="0664"' | sudo tee /etc/udev/rules.d/99-ptp.rules
sudo udevadm control --reload-rules
```

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–î–µ—Ç–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**: –°–º. [configuration.md](configuration.md)
2. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —Å–∏—Å—Ç–µ–º—É**: –°–º. [integration examples](../examples/integration/)
3. **–û—Ç–ª–∞–¥–∫–∞**: –°–º. [troubleshooting.md](troubleshooting.md)
4. **API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: –°–º. [API reference](../api/)

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–∏
date; sudo testptp -d /dev/ptp0 -g

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ PTP
sudo pmc -u -b 0 'GET DEFAULT_DATA_SET'
sudo pmc -u -b 0 'GET CURRENT_DATA_SET'
```

### –û—Ç–ª–∞–¥–∫–∞

```bash
# –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
echo 8 > /proc/sys/kernel/printk

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ª–æ–≥–∞
journalctl -k -f | grep ptp
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

–ü—Ä–∏–º–µ—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `examples/`:

- `basic-setup/` - –±–∞–∑–æ–≤—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- `advanced-config/` - –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- `integration/` - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏

---

### 30. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ B: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ ‚Äî –ø–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

## –û–±–∑–æ—Ä

–î–µ—Ç–∞–ª—å–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –¥—Ä–∞–π–≤–µ—Ä–∞ PTP OCP.

## –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **–û–°**: Linux —Å —è–¥—Ä–æ–º –≤–µ—Ä—Å–∏–∏ 5.4+
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: x86_64, ARM64
- **–û–ó–£**: –º–∏–Ω–∏–º—É–º 512 –ú–ë
- **–î–∏—Å–∫–æ–≤–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ**: 100 –ú–ë –¥–ª—è –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤ –∏ —Å–±–æ—Ä–∫–∏

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **–û–°**: Linux —Å —è–¥—Ä–æ–º –≤–µ—Ä—Å–∏–∏ 5.15+
- **–û–ó–£**: 2 –ì–ë –∏ –±–æ–ª–µ–µ
- **–ü—Ä–æ—Ü–µ—Å—Å–æ—Ä**: —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –º–Ω–æ–≥–æ—è–¥–µ—Ä–Ω—ã–π CPU

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤—ã

- **Ubuntu**: 20.04 LTS, 22.04 LTS, 24.04 LTS
- **Debian**: 11 (Bullseye), 12 (Bookworm)
- **CentOS**: 8, 9
- **RHEL**: 8, 9
- **Fedora**: 35+
- **openSUSE**: Leap 15.4+

## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º—ã

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

#### Ubuntu/Debian

```bash
# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
sudo apt update && sudo apt upgrade -y

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –ø–∞–∫–µ—Ç–æ–≤
sudo apt install -y \
    build-essential \
    linux-headers-$(uname -r) \
    git \
    make \
    gcc \
    dkms \
    pkg-config \
    linuxptp \
    chrony

# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã
sudo apt install -y \
    ethtool \
    pciutils \
    usbutils \
    kmod
```

#### CentOS/RHEL 8+

```bash
# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
sudo dnf update -y

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ EPEL —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
sudo dnf install -y epel-release

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –ø–∞–∫–µ—Ç–æ–≤
sudo dnf groupinstall -y "Development Tools"
sudo dnf install -y \
    kernel-devel \
    kernel-headers \
    git \
    make \
    gcc \
    dkms \
    pkg-config \
    linuxptp \
    chrony

# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã
sudo dnf install -y \
    ethtool \
    pciutils \
    usbutils \
    kmod
```

#### Fedora

```bash
# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
sudo dnf update -y

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –ø–∞–∫–µ—Ç–æ–≤
sudo dnf groupinstall -y "Development Tools" "C Development Tools and Libraries"
sudo dnf install -y \
    kernel-devel \
    kernel-headers \
    git \
    make \
    gcc \
    dkms \
    pkg-config \
    linuxptp \
    chrony
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —è–¥—Ä–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏ —è–¥—Ä–∞
uname -r

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ PTP
grep -i ptp /boot/config-$(uname -r)

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–¥—É–ª–µ–π PTP
find /lib/modules/$(uname -r) -name "*ptp*"
```

## –°–±–æ—Ä–∫–∞ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥—Ä–∞–π–≤–µ—Ä–∞

### –ü–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
git clone <repository-url> ptp-ocp-driver
cd ptp-ocp-driver

# –ü–µ—Ä–µ—Ö–æ–¥ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å –¥—Ä–∞–π–≤–µ—Ä–æ–º
cd –î–†–ê–ô–í–ï–†–ê
```

### –°–±–æ—Ä–∫–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ Makefile
cat Makefile

# –°–±–æ—Ä–∫–∞ –º–æ–¥—É–ª—è
make clean
make

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–±—Ä–∞–Ω–Ω–æ–≥–æ –º–æ–¥—É–ª—è
ls -la *.ko
modinfo ptp_ocp.ko
```

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

#### –í—Ä–µ–º–µ–Ω–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥—É–ª—è
sudo insmod ptp_ocp.ko

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏
lsmod | grep ptp_ocp
dmesg | tail -10
```

#### –ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –º–æ–¥—É–ª—è –≤ —Å–∏—Å—Ç–µ–º—É
sudo make install

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –º–æ–¥—É–ª–µ–π
sudo depmod -a

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
echo "ptp_ocp" | sudo tee -a /etc/modules

# –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ modprobe
sudo tee /etc/modprobe.d/ptp-ocp.conf << EOF
# PTP OCP driver configuration
options ptp_ocp debug=0
EOF
```

#### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —á–µ—Ä–µ–∑ DKMS

```bash
# –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–ª—è DKMS
sudo mkdir -p /usr/src/ptp-ocp-1.0
sudo cp -r * /usr/src/ptp-ocp-1.0/

# –°–æ–∑–¥–∞–Ω–∏–µ dkms.conf
sudo tee /usr/src/ptp-ocp-1.0/dkms.conf << EOF
PACKAGE_NAME="ptp-ocp"
PACKAGE_VERSION="1.0"
BUILT_MODULE_NAME[0]="ptp_ocp"
DEST_MODULE_LOCATION[0]="/kernel/drivers/ptp/"
AUTOINSTALL="yes"
EOF

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ DKMS
sudo dkms add -m ptp-ocp -v 1.0
sudo dkms build -m ptp-ocp -v 1.0
sudo dkms install -m ptp-ocp -v 1.0
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º—ã

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ udev –ø—Ä–∞–≤–∏–ª

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª –¥–ª—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤ PTP
sudo tee /etc/udev/rules.d/99-ptp-ocp.rules << EOF
# PTP OCP device rules
SUBSYSTEM=="ptp", GROUP="dialout", MODE="0664"
KERNEL=="ptp[0-9]*", GROUP="dialout", MODE="0664"
EOF

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∞–≤–∏–ª udev
sudo udevadm control --reload-rules
sudo udevadm trigger
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥—Ä—É–ø–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

```bash
# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –≥—Ä—É–ø–ø—ã
sudo usermod -a -G dialout,tty $USER

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–ª–µ–Ω—Å—Ç–≤–∞ –≤ –≥—Ä—É–ø–ø–∞—Ö
groups $USER
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ systemd —Å–µ—Ä–≤–∏—Å–æ–≤

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞ –¥–ª—è –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∏ –¥—Ä–∞–π–≤–µ—Ä–∞
sudo tee /etc/systemd/system/ptp-ocp.service << EOF
[Unit]
Description=PTP OCP Driver
After=multi-user.target

[Service]
Type=oneshot
ExecStart=/sbin/modprobe ptp_ocp
ExecStop=/sbin/rmmod ptp_ocp
RemainAfterExit=yes

[Install]
WantedBy=multi-user.target
EOF

# –í–∫–ª—é—á–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞
sudo systemctl enable ptp-ocp.service
sudo systemctl start ptp-ocp.service
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—Ä–∞–π–≤–µ—Ä–∞

```bash
# –°—Ç–∞—Ç—É—Å –º–æ–¥—É–ª—è
lsmod | grep ptp

# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–æ–¥—É–ª–µ
modinfo ptp_ocp

# –°–æ–æ–±—â–µ–Ω–∏—è —è–¥—Ä–∞
dmesg | grep -i ptp | tail -10
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤

```bash
# PTP —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
ls -la /dev/ptp*

# PCI —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
lspci | grep -i time
lspci | grep -i ptp

# Sysfs –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
ls -la /sys/class/ptp/
```

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

```bash
# –¢–µ—Å—Ç PTP —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
sudo testptp -d /dev/ptp0 -c
sudo testptp -d /dev/ptp0 -g

# –ü—Ä–æ–≤–µ—Ä–∫–∞ capabilities
sudo testptp -d /dev/ptp0 -k

# –¢–µ—Å—Ç GPIO (–µ—Å–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è)
sudo testptp -d /dev/ptp0 -L
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ç–∏

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ç–µ–≤–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ hardware timestamping
ethtool -T eth0

# –í–∫–ª—é—á–µ–Ω–∏–µ hardware timestamping
sudo ethtool -s eth0 speed 1000 duplex full autoneg off

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±—É—Ñ–µ—Ä–æ–≤
sudo ethtool -G eth0 rx 4096 tx 4096
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ PTP –ø—Ä–æ—Ñ–∏–ª—è

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ PTP
sudo tee /etc/ptp4l.conf << EOF
[global]
dataset_comparison         G.8275.x
G.8275.defaultDS.localPriority 128
domainNumber               24
priority1                  128
priority2                  128
clockClass                 248
clockAccuracy              0xFE
offsetScaledLogVariance    0xFFFF
free_running               0
freq_est_interval          1
dscp_event                 0
dscp_general               0

[eth0]
network_transport          UDPv4
delay_mechanism            E2E
EOF
```

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û–±—â–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

#### –ú–æ–¥—É–ª—å –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
sudo modprobe --show-depends ptp_ocp

# –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
sudo modprobe ptp
sudo modprobe pps_core
```

#### –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ PCI —É—Å—Ç—Ä–æ–π—Å—Ç–≤
sudo lspci -vvv | grep -A 20 -B 5 -i time

# –ü—Ä–æ–≤–µ—Ä–∫–∞ IOMMU
dmesg | grep -i iommu

# –û—Ç–∫–ª—é—á–µ–Ω–∏–µ IOMMU (–µ—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ)
# –î–æ–±–∞–≤–∏—Ç—å –≤ GRUB: intel_iommu=off –∏–ª–∏ amd_iommu=off
```

#### –ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–ª–∞–¥–µ–ª—å—Ü–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
ls -la /dev/ptp*

# –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–∞–≤ –≤—Ä–µ–º–µ–Ω–Ω–æ
sudo chmod 666 /dev/ptp*

# –ü—Ä–æ–≤–µ—Ä–∫–∞ SELinux/AppArmor
sudo getenforce  # –¥–ª—è SELinux
sudo aa-status   # –¥–ª—è AppArmor
```

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–ª–∞–¥–∫–∞

```bash
# –í–∫–ª—é—á–µ–Ω–∏–µ –æ—Ç–ª–∞–¥–æ—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
echo 'module ptp_ocp +p' | sudo tee /sys/kernel/debug/dynamic_debug/control

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
sudo journalctl -k | grep ptp
tail /var/log/messages | grep ptp
```

## –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥—Ä–∞–π–≤–µ—Ä–∞

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥—Ä–∞–π–≤–µ—Ä–∞
sudo systemctl stop ptp4l
sudo rmmod ptp_ocp

# –ü–æ–ª—É—á–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
git pull origin main

# –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞
cd –î–†–ê–ô–í–ï–†–ê
make clean
make
sudo make install

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –¥—Ä–∞–π–≤–µ—Ä–∞
sudo modprobe ptp_ocp
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ DKMS

```bash
# –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä–æ–π –≤–µ—Ä—Å–∏–∏
sudo dkms remove -m ptp-ocp -v 1.0 --all

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏
sudo dkms install -m ptp-ocp -v 1.1
```

## –î–µ–∏–Ω—Å—Ç–∞–ª–ª—è—Ü–∏—è

### –£–¥–∞–ª–µ–Ω–∏–µ –¥—Ä–∞–π–≤–µ—Ä–∞

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤
sudo systemctl stop ptp4l
sudo systemctl disable ptp-ocp.service

# –í—ã–≥—Ä—É–∑–∫–∞ –º–æ–¥—É–ª—è
sudo rmmod ptp_ocp

# –£–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
sudo rm -f /lib/modules/$(uname -r)/kernel/drivers/ptp/ptp_ocp.ko
sudo rm -f /etc/systemd/system/ptp-ocp.service
sudo rm -f /etc/udev/rules.d/99-ptp-ocp.rules
sudo rm -f /etc/modprobe.d/ptp-ocp.conf

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–∑—ã –º–æ–¥—É–ª–µ–π
sudo depmod -a

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ udev
sudo udevadm control --reload-rules
```

### –£–¥–∞–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ DKMS

```bash
sudo dkms remove -m ptp-ocp -v 1.0 --all
sudo rm -rf /usr/src/ptp-ocp-1.0
```

---

### 31. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ C: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ LinuxPTP ‚Äî –ø–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç

# –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Ä–∞–±–æ—Ç–µ —Å LinuxPTP

## –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ
1. [–í–≤–µ–¥–µ–Ω–∏–µ –≤ LinuxPTP](#–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-linuxptp)
2. [–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–∏-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞)
3. [PTP4L - –æ—Å–Ω–æ–≤–Ω–æ–π –¥–µ–º–æ–Ω PTP](#ptp4l---–æ—Å–Ω–æ–≤–Ω–æ–π-–¥–µ–º–æ–Ω-ptp)
4. [PHC2SYS - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —á–∞—Å–æ–≤](#phc2sys---—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è-—Å–∏—Å—Ç–µ–º–Ω—ã—Ö-—á–∞—Å–æ–≤)
5. [TS2PHC - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –≤—Ä–µ–º–µ–Ω–∏](#ts2phc---—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è-—Å-–≤–Ω–µ—à–Ω–∏–º-–∏—Å—Ç–æ—á–Ω–∏–∫–æ–º-–≤—Ä–µ–º–µ–Ω–∏)
6. [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã](#–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ-—Ñ–∞–π–ª—ã)
7. [–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã](#–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ-–ø—Ä–∏–º–µ—Ä—ã)
8. [–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ—Ç–ª–∞–¥–∫–∞](#–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–∏-–æ—Ç–ª–∞–¥–∫–∞)
9. [–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º](#—Ä–µ—à–µ–Ω–∏–µ-–ø—Ä–æ–±–ª–µ–º)

## –í–≤–µ–¥–µ–Ω–∏–µ –≤ LinuxPTP

LinuxPTP - —ç—Ç–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ Precision Time Protocol (PTP) –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã Linux —Å–æ–≥–ª–∞—Å–Ω–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É IEEE 1588-2008. –ü–∞–∫–µ—Ç –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —É—Ç–∏–ª–∏—Ç –¥–ª—è –≤—ã—Å–æ–∫–æ—Ç–æ—á–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –≤—Ä–µ–º–µ–Ω–∏ –≤ —Å–µ—Ç–∏.

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- **ptp4l** - –¥–µ–º–æ–Ω PTP –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å–µ—Ç–µ–≤—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤
- **phc2sys** - —É—Ç–∏–ª–∏—Ç–∞ –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —á–∞—Å–æ–≤ —Å PHC (PTP Hardware Clock)
- **ts2phc** - —É—Ç–∏–ª–∏—Ç–∞ –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ PHC —Å –≤–Ω–µ—à–Ω–∏–º –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –≤—Ä–µ–º–µ–Ω–∏

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ PTP:
- –°—É–±–º–∏–∫—Ä–æ—Å–µ–∫—É–Ω–¥–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è –∑–∞–¥–µ—Ä–∂–µ–∫ —Å–µ—Ç–∏
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã—Ö –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫
- –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å –¥–ª—è –±–æ–ª—å—à–∏—Ö —Å–µ—Ç–µ–π

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏–∑ –ø–∞–∫–µ—Ç–Ω–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞

**Ubuntu/Debian:**
```bash
sudo apt update
sudo apt install linuxptp
```

**RHEL/CentOS/Fedora:**
```bash
sudo yum install linuxptp
# –∏–ª–∏ –¥–ª—è –Ω–æ–≤—ã—Ö –≤–µ—Ä—Å–∏–π
sudo dnf install linuxptp
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–µ—Ç–µ–≤–∞—è –∫–∞—Ä—Ç–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç PTP:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ PTP –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫
ethtool -T eth0

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è PHC
ls /dev/ptp*
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π

```bash
# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –≥—Ä—É–ø–ø—É –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ PTP —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º
sudo usermod -a -G dialout $USER
```

## PTP4L - –æ—Å–Ω–æ–≤–Ω–æ–π –¥–µ–º–æ–Ω PTP

### –û–ø–∏—Å–∞–Ω–∏–µ
`ptp4l` - —ç—Ç–æ –æ—Å–Ω–æ–≤–Ω–æ–π –¥–µ–º–æ–Ω LinuxPTP, –∫–æ—Ç–æ—Ä—ã–π —Ä–µ–∞–ª–∏–∑—É–µ—Ç –ø—Ä–æ—Ç–æ–∫–æ–ª PTP –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —á–∞—Å–æ–≤ –º–µ–∂–¥—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏ –≤ —Å–µ—Ç–∏.

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã

#### 1. –û–±—ã—á–Ω—ã–π —Ä–µ–∂–∏–º (Ordinary Clock)
–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ª–∏–±–æ –º–∞—Å—Ç–µ—Ä–æ–º, –ª–∏–±–æ —Å–ª–µ–π–≤–æ–º:
```bash
# –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ –∞–≤—Ç–æ-–≤—ã–±–æ—Ä–∞
sudo ptp4l -i eth0 -m

# –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π —Ä–µ–∂–∏–º —Å–ª–µ–π–≤–∞
sudo ptp4l -i eth0 -s -m

# –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π —Ä–µ–∂–∏–º –º–∞—Å—Ç–µ—Ä–∞ (—á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª)
sudo ptp4l -i eth0 -f /etc/ptp4l-master.conf -m
```

#### 2. –ì—Ä–∞–Ω–∏—á–Ω—ã–µ —á–∞—Å—ã (Boundary Clock)
–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è —Å –æ–¥–Ω–∏–º –ø–æ—Ä—Ç–æ–º –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≤—Ä–µ–º—è —á–µ—Ä–µ–∑ –¥—Ä—É–≥–∏–µ:
```bash
sudo ptp4l -i eth0 -i eth1 -m
```

#### 3. –ü—Ä–æ–∑—Ä–∞—á–Ω—ã–µ —á–∞—Å—ã (Transparent Clock)
–ü–µ—Ä–µ—Å—ã–ª–∞–µ—Ç PTP —Å–æ–æ–±—â–µ–Ω–∏—è —Å –∫–æ—Ä—Ä–µ–∫—Ü–∏–µ–π –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è:
```bash
sudo ptp4l -i eth0 -E -m
```

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| `-i <interface>` | –°–µ—Ç–µ–≤–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è PTP |
| `-m` | –í—ã–≤–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ stdout |
| `-s` | –†–µ–∂–∏–º —Å–ª–µ–π–≤–∞ |
| `-f <config>` | –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª |
| `-l <level>` | –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (0-7) |
| `-q` | –¢–∏—Ö–∏–π —Ä–µ–∂–∏–º |
| `-v` | –ü–æ–¥—Ä–æ–±–Ω—ã–π –≤—ã–≤–æ–¥ |
| `-H` | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã—Ö –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫ |
| `-S` | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã—Ö –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫ |
| `-E` | –†–µ–∂–∏–º E2E (End-to-End) |
| `-P` | –†–µ–∂–∏–º P2P (Peer-to-Peer) |

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```bash
# –ë–∞–∑–æ–≤—ã–π –∑–∞–ø—É—Å–∫ —Å –∞–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º —Ä–æ–ª–∏
sudo ptp4l -i eth0 -m

# –ó–∞–ø—É—Å–∫ —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–º —Ñ–∞–π–ª–æ–º
sudo ptp4l -f /etc/ptp4l.conf -m

# –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ —Å–ª–µ–π–≤–∞ —Å –≤—ã—Å–æ–∫–∏–º —É—Ä–æ–≤–Ω–µ–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
sudo ptp4l -i eth0 -s -l 7 -m

# –ó–∞–ø—É—Å–∫ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞–º–∏ (Boundary Clock)
sudo ptp4l -i eth0 -i eth1 -f /etc/ptp4l.conf -m
```

## PHC2SYS - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —á–∞—Å–æ–≤

### –û–ø–∏—Å–∞–Ω–∏–µ
`phc2sys` —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–µ —á–∞—Å—ã Linux —Å PTP Hardware Clock (PHC) –∏–ª–∏ –Ω–∞–æ–±–æ—Ä–æ—Ç.

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã

#### 1. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —á–∞—Å–æ–≤ —Å PHC
```bash
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ª—É—á—à–µ–≥–æ PHC
sudo phc2sys -a -r

# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º PHC
sudo phc2sys -s /dev/ptp0 -w
```

#### 2. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è PHC —Å —Å–∏—Å—Ç–µ–º–Ω—ã–º–∏ —á–∞—Å–∞–º–∏
```bash
# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è PHC —Å —Å–∏—Å—Ç–µ–º–Ω—ã–º–∏ —á–∞—Å–∞–º–∏
sudo phc2sys -s CLOCK_REALTIME -c /dev/ptp0 -w
```

#### 3. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–µ–∂–¥—É PHC
```bash
# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –æ–¥–Ω–æ–≥–æ PHC —Å –¥—Ä—É–≥–∏–º
sudo phc2sys -s /dev/ptp0 -c /dev/ptp1 -w
```

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| `-a` | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∂–∏–º |
| `-r` | –¢–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ, –±–µ–∑ –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏ |
| `-s <clock>` | –ò—Å—Ç–æ—á–Ω–∏–∫ –≤—Ä–µ–º–µ–Ω–∏ |
| `-c <clock>` | –¶–µ–ª–µ–≤—ã–µ —á–∞—Å—ã |
| `-w` | –û–∂–∏–¥–∞–Ω–∏–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ ptp4l |
| `-O <offset>` | –°–º–µ—â–µ–Ω–∏–µ –≤ –Ω–∞–Ω–æ—Å–µ–∫—É–Ω–¥–∞—Ö |
| `-R <rate>` | –ß–∞—Å—Ç–æ—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (–ì—Ü) |
| `-n <domain>` | PTP –¥–æ–º–µ–Ω |
| `-u <summary>` | –ò–Ω—Ç–µ—Ä–≤–∞–ª —Å–≤–æ–¥–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ |
| `-m` | –í—ã–≤–æ–¥ –≤ stdout |

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```bash
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º
sudo phc2sys -a -r -m

# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —á–∞—Å–æ–≤ —Å eth0
sudo phc2sys -s eth0 -w -m

# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–æ–π —á–∞—Å—Ç–æ—Ç–æ–π
sudo phc2sys -s /dev/ptp0 -c CLOCK_REALTIME -R 8 -m

# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º —Å–º–µ—â–µ–Ω–∏—è
sudo phc2sys -s /dev/ptp0 -c CLOCK_REALTIME -O 1000000 -m
```

## TS2PHC - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –≤—Ä–µ–º–µ–Ω–∏

### –û–ø–∏—Å–∞–Ω–∏–µ
`ts2phc` —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç PTP Hardware Clock —Å –≤–Ω–µ—à–Ω–∏–º –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –≤—Ä–µ–º–µ–Ω–∏, —Ç–∞–∫–∏–º –∫–∞–∫ GPS –∏–ª–∏ –¥—Ä—É–≥–∏–µ –≤—ã—Å–æ–∫–æ—Ç–æ—á–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏.

### –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –≤–Ω–µ—à–Ω–∏–π —Å–∏–≥–Ω–∞–ª PPS (Pulse Per Second)
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç PHC —Å –≤–Ω–µ—à–Ω–∏–º –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º
- –ú–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è ptp4l

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| `-c <phc>` | –¶–µ–ª–µ–≤–æ–π PHC –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ |
| `-s <source>` | –ò—Å—Ç–æ—á–Ω–∏–∫ –≤—Ä–µ–º–µ–Ω–∏ |
| `-f <config>` | –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª |
| `-l <level>` | –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è |
| `-m` | –í—ã–≤–æ–¥ –≤ stdout |
| `-q` | –¢–∏—Ö–∏–π —Ä–µ–∂–∏–º |

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è GPS

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –¥–ª—è GPS
cat << EOF > /etc/ts2phc.conf
[global]
use_syslog 1
verbose 1
logging_level 6

[/dev/ptp0]
ts2phc.pin_index 0
ts2phc.channel 0
ts2phc.extts_polarity rising
ts2phc.extts_correction 0

[/dev/pps0]
ts2phc.master 1
EOF
```

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```bash
# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è PHC —Å GPS —á–µ—Ä–µ–∑ PPS
sudo ts2phc -c /dev/ptp0 -s /dev/pps0 -m

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
sudo ts2phc -f /etc/ts2phc.conf -m

# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö PHC
sudo ts2phc -c /dev/ptp0 -c /dev/ptp1 -s /dev/pps0 -m
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è ptp4l (/etc/ptp4l.conf)

```ini
[global]
# –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
dataset_comparison                 ieee1588
domainNumber                       0
priority1                          128
priority2                          128
clockClass                         248
clockAccuracy                      0xFE
offsetScaledLogVariance           0xFFFF
free_running                       0
freq_est_interval                  1
dscp_event                         0
dscp_general                       0
assume_two_step                    0

# –°–µ—Ç–µ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
network_transport                  UDPv4
udp_ttl                           1
udp6_scope                        0x0E
uds_address                       /var/run/ptp4l

# –í—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã (–≤ —Å—Ç–µ–ø–µ–Ω—è—Ö –¥–≤–æ–π–∫–∏ —Å–µ–∫—É–Ω–¥)
logAnnounceInterval               1
logSyncInterval                   0
logMinDelayReqInterval            0
logMinPdelayReqInterval           0

# –¢–∞–π–º-–∞—É—Ç—ã
announceReceiptTimeout            3
syncReceiptTimeout                0
delayAsymmetry                    0
fault_reset_interval              4
fault_badpeernet_interval         16

# –ê–ª–≥–æ—Ä–∏—Ç–º –≤—ã–±–æ—Ä–∞ –º–∞—Å—Ç–µ—Ä–∞
G.8275.defaultDS.localPriority    128

# –ß–∞—Å—ã –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏
time_stamping                     hardware
twoStepFlag                       1
slaveOnly                         0
gmCapable                         1
p2p_dst_mac                       01:1B:19:00:00:00
p2p_dst_mac                       01:80:C2:00:00:0E

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
delay_mechanism                   E2E
egressLatency                     0
ingressLatency                    0
boundary_clock_jbod               0

# –ê–ª–≥–æ—Ä–∏—Ç–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —á–∞—Å–∞–º–∏
pi_proportional_const             0.0
pi_integral_const                 0.0
pi_proportional_scale             0.0
pi_proportional_exponent          -0.3
pi_proportional_norm_max          0.7
pi_integral_scale                 0.0
pi_integral_exponent              0.4
pi_integral_norm_max              0.3
step_threshold                    0.0
max_frequency                     900000000

# –í–µ–¥–µ–Ω–∏–µ –∂—É—Ä–Ω–∞–ª–∞
use_syslog                        1
verbose                           0
summary_interval                  0
kernel_leap                       1
check_fup_sync                    0
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏—Ö —Å–ª—É—á–∞–µ–≤

#### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Grandmaster Clock
```ini
[global]
priority1                         0
clockClass                        6
clockAccuracy                     0x20
free_running                      0
slaveOnly                         0
```

#### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Slave Clock
```ini
[global]
slaveOnly                         1
priority1                         255
clockClass                        255
```

#### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Boundary Clock
```ini
[global]
boundary_clock_jbod               1

[eth0]
masterOnly                        0
hybrid_e2e                        1

[eth1]
masterOnly                        1
```

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü—Ä–æ—Å—Ç–∞—è –∫–ª–∏–µ–Ω—Ç-—Å–µ—Ä–≤–µ—Ä–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

**–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ (Master):**
```bash
# –ó–∞–ø—É—Å–∫ ptp4l –≤ —Ä–µ–∂–∏–º–µ –º–∞—Å—Ç–µ—Ä–∞ (—á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª)
sudo ptp4l -i eth0 -f /etc/ptp4l-master.conf -m &

# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —á–∞—Å–æ–≤ —Å PHC
sudo phc2sys -s eth0 -w -m &
```

**–ù–∞ –∫–ª–∏–µ–Ω—Ç–µ (Slave):**
```bash
# –ó–∞–ø—É—Å–∫ ptp4l –≤ —Ä–µ–∂–∏–º–µ —Å–ª–µ–π–≤–∞
sudo ptp4l -i eth0 -s -m &

# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —á–∞—Å–æ–≤ —Å PHC
sudo phc2sys -s eth0 -w -m &
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: GPS-—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π Grandmaster

```bash
# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è PHC —Å GPS
sudo ts2phc -c /dev/ptp0 -s /dev/pps0 -m &

# –ó–∞–ø—É—Å–∫ ptp4l –∫–∞–∫ Grandmaster
sudo ptp4l -i eth0 -f /etc/ptp4l-gm.conf -m &

# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —á–∞—Å–æ–≤
sudo phc2sys -s /dev/ptp0 -w -m &
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: Boundary Clock

```bash
# –ó–∞–ø—É—Å–∫ boundary clock —Å –¥–≤—É–º—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞–º–∏
sudo ptp4l -i eth0 -i eth1 -f /etc/ptp4l-bc.conf -m &

# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —á–∞—Å–æ–≤ —Å –ª—É—á—à–∏–º PHC
sudo phc2sys -a -r -m &
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: Redundant Masters

**–ü–µ—Ä–≤—ã–π –º–∞—Å—Ç–µ—Ä (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1):**
```ini
# /etc/ptp4l-master1.conf
[global]
priority1    100
clockClass   6
```

**–í—Ç–æ—Ä–æ–π –º–∞—Å—Ç–µ—Ä (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2):**
```ini
# /etc/ptp4l-master2.conf
[global]
priority1    110
clockClass   6
```


## –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

#### 1. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

**–ü—Ä–æ–±–ª–µ–º–∞:** ptp4l –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã—Ö –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫
ethtool -T eth0

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ PTP
sudo tcpdump -i eth0 port 319 or port 320

# –ü—Ä–æ–≤–µ—Ä–∫–∞ firewall
sudo iptables -L | grep -E "(319|320)"
```

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –û—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ—Ä—Ç–æ–≤ PTP
sudo iptables -A INPUT -p udp --dport 319 -j ACCEPT
sudo iptables -A INPUT -p udp --dport 320 -j ACCEPT

# –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã—Ö –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫
sudo ptp4l -i eth0 -S -m
```

#### 2. –ë–æ–ª—å—à–æ–µ —Å–º–µ—â–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏

**–ü—Ä–æ–±–ª–µ–º–∞:** –ë–æ–ª—å—à–æ–π offset –º–µ–∂–¥—É —á–∞—Å–∞–º–∏
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ PI –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞
grep -E "pi_(proportional|integral)" /etc/ptp4l.conf

# –ü—Ä–æ–≤–µ—Ä–∫–∞ step_threshold
grep step_threshold /etc/ptp4l.conf
```

**–†–µ—à–µ–Ω–∏–µ:**
```ini
# –ë–æ–ª–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ PI –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞
pi_proportional_const     0.7
pi_integral_const         0.3
step_threshold           20.0
```

#### 3. –ü—Ä–æ–±–ª–µ–º—ã —Å multicast

**–ü—Ä–æ–±–ª–µ–º–∞:** PTP —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–µ –¥–æ—Ö–æ–¥—è—Ç
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ multicast –º–∞—Ä—à—Ä—É—Ç–æ–≤
ip route show | grep 224.0.1.129

# –ü—Ä–æ–≤–µ—Ä–∫–∞ IGMP
cat /proc/net/igmp
```

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ multicast –º–∞—Ä—à—Ä—É—Ç–∞
sudo ip route add 224.0.1.129/32 dev eth0

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ unicast –≤–º–µ—Å—Ç–æ multicast
# –í –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ ptp4l:
# unicast_list–µ–Ω 1
# unicast_req_duration 3600
```

#### 4. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å PHC

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ PHC
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ —á–∞—Å—Ç–æ—Ç—ã
watch -n 1 'phc_ctl /dev/ptp0 freq'

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–∂–∏—Ç—Ç–µ—Ä–∞
./monitor_offset.sh | awk '{print $6}' | sort -n | tail -20
```

**–†–µ—à–µ–Ω–∏–µ:**
```ini
# –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
logSyncInterval          1
logMinDelayReqInterval   1
freq_est_interval        2
```

### –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã PTP
cat << 'EOF' > ptp_diagnostics.sh
#!/bin/bash
echo "=== PTP System Diagnostics ==="
echo

echo "1. Network Interface Hardware Timestamping:"
for iface in $(ip link show | grep -o 'eth[0-9]*'); do
    echo "Interface $iface:"
    ethtool -T $iface 2>/dev/null | grep -E "(hardware-transmit|hardware-receive|hardware-raw-clock)"
done
echo

echo "2. Available PTP Hardware Clocks:"
ls -la /dev/ptp* 2>/dev/null
echo

echo "3. PTP Processes:"
ps aux | grep -E "(ptp4l|phc2sys|ts2phc)" | grep -v grep
echo

echo "4. Current PTP Status:"
sudo pmc -u -b 0 'GET CURRENT_DATA_SET' 2>/dev/null
echo

echo "5. Port States:"
sudo pmc -u -b 0 'GET PORT_DATA_SET' 2>/dev/null
echo

echo "6. Network Traffic (last 10 seconds):"
timeout 10 sudo tcpdump -i any -c 10 port 319 or port 320 2>/dev/null
echo

echo "7. System Clock vs PHC:"
for ptp in /dev/ptp*; do
    [ -e "$ptp" ] && echo "$ptp: $(phc_ctl $ptp cmp 2>/dev/null)"
done
EOF

chmod +x ptp_diagnostics.sh
sudo ./ptp_diagnostics.sh
```

### –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∏ systemd

#### –°–æ–∑–¥–∞–Ω–∏–µ systemd —Å–µ—Ä–≤–∏—Å–æ–≤

**ptp4l.service:**
```ini
[Unit]
Description=PTP Boundary/Ordinary Clock
After=network.target
Documentation=man:ptp4l

[Service]
Type=simple
ExecStart=/usr/sbin/ptp4l -f /etc/ptp4l.conf
Restart=always
RestartSec=5

[Install]
WantedBy=multi-user.target
```

**phc2sys.service:**
```ini
[Unit]
Description=Synchronize PHC with system clock
After=ptp4l.service
Requires=ptp4l.service
Documentation=man:phc2sys

[Service]
Type=simple
ExecStart=/usr/sbin/phc2sys -a -r
Restart=always
RestartSec=5

[Install]
WantedBy=multi-user.target
```

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤:**
```bash
sudo systemctl daemon-reload
sudo systemctl enable ptp4l phc2sys
sudo systemctl start ptp4l phc2sys
```

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

LinuxPTP –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –º–æ—â–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –≤—ã—Å–æ–∫–æ—Ç–æ—á–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –≤—Ä–µ–º–µ–Ω–∏ –≤ Linux-—Å–∏—Å—Ç–µ–º–∞—Ö. –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ–∑–≤–æ–ª—è—é—Ç –¥–æ—Å—Ç–∏—á—å —Å—É–±–º–∏–∫—Ä–æ—Å–µ–∫—É–Ω–¥–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏, —á—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –º–Ω–æ–≥–∏—Ö –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã—Ö –∏ —Ç–µ–ª–µ–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.

–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã –¥–ª—è —É—Å–ø–µ—à–Ω–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è:
1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã—Ö –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫
2. –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ç–µ–≤–æ–≥–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è
3. –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–∞—á–µ—Å—Ç–≤–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
4. –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ systemd –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å –∫ man-—Å—Ç—Ä–∞–Ω–∏—Ü–∞–º:
- `man ptp4l`
- `man phc2sys` 
- `man ts2phc`
- `man pmc`

---

### 32. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ D: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥—Ä–∞–π–≤–µ—Ä–∞ ‚Äî –ø–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç

# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ PTP OCP –¥—Ä–∞–π–≤–µ—Ä–∞

## –û–±–∑–æ—Ä

–î—Ä–∞–π–≤–µ—Ä PTP OCP –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–∞—Ä—Ç–∞–º–∏ —Ç–æ—á–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –≤ Linux. –û–Ω –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≤—ã—Å–æ–∫–æ—Ç–æ—á–Ω—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –≤—Ä–µ–º–µ–Ω–∏, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–≤ –∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤, –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≥–∏–±–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—Å–µ–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –∫–∞—Ä—Ç—ã.

## –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

- **Quantum-PCI TimeCard** (PCI ID: 0x1d9b:0x0400)
- **Orolia ART Card** (PCI ID: 0x1ad7:0xa000)
- **ADVA Timecard** (PCI ID: 0x0b0b:0x0410)

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –í—Ä–µ–º–µ–Ω–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ PTP (Precision Time Protocol)
- –ê–ø–ø–∞—Ä–∞—Ç–Ω—ã–µ —á–∞—Å—ã PHC (Physical Hardware Clock)
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å GNSS (GPS/–ì–õ–û–ù–ê–°–°)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∞—Ç–æ–º–Ω—ã—Ö —á–∞—Å–æ–≤ (MAC - Miniature Atomic Clock)

### –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
- **–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ—Ä—Ç—ã**: GNSS, MAC, NMEA
- **I2C —à–∏–Ω–∞**: –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–Ω–µ—à–Ω–∏–º–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏
- **SPI**: –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å flash-–ø–∞–º—è—Ç—å—é
- **GPIO**: –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∏–≥–Ω–∞–ª–∞–º–∏

### –°–∏–≥–Ω–∞–ª—ã –≤—Ä–µ–º–µ–Ω–∏
- **PPS (Pulse Per Second)**: –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ –ø—Ä–∏–µ–º –∏–º–ø—É–ª—å—Å–æ–≤ —Ä–∞–∑ –≤ —Å–µ–∫—É–Ω–¥—É
- **IRIG-B**: –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞ IRIG-B
- **DCF77**: –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–¥–∏–æ—Å–∏–≥–Ω–∞–ª–∞ –≤—Ä–µ–º–µ–Ω–∏ DCF77
- **10 –ú–ì—Ü**: –æ–ø–æ—Ä–Ω–∞—è —á–∞—Å—Ç–æ—Ç–∞

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥—Ä–∞–π–≤–µ—Ä–∞

### –†–µ–≥–∏—Å—Ç—Ä—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- `ocp_reg`: –æ—Å–Ω–æ–≤–Ω—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —á–∞—Å–∞–º–∏
- `tod_reg`: —Ä–µ–≥–∏—Å—Ç—Ä—ã Time of Day
- `ts_reg`: —Ä–µ–≥–∏—Å—Ç—Ä—ã –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫
- `pps_reg`: —Ä–µ–≥–∏—Å—Ç—Ä—ã PPS
- `signal_reg`: —Ä–µ–≥–∏—Å—Ç—Ä—ã –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ —Å–∏–≥–Ω–∞–ª–æ–≤

### –†–µ—Å—É—Ä—Å—ã —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
–î—Ä–∞–π–≤–µ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–∏—Å—Ç–µ–º—É —Ä–µ—Å—É—Ä—Å–æ–≤ –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –∫–∞—Ä—Ç—ã:
- –ü–∞–º—è—Ç—å MMIO –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤
- –í–µ–∫—Ç–æ—Ä—ã –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π MSI/MSI-X
- –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (UART, I2C, SPI)

## –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–µ–º
- `ptp_ocp_gettime()`: —á—Ç–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
- `ptp_ocp_settime()`: —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Ä–µ–º–µ–Ω–∏
- `ptp_ocp_adjtime()`: –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –≤—Ä–µ–º–µ–Ω–∏
- `ptp_ocp_adjfine()`: —Ç–æ—á–Ω–∞—è –ø–æ–¥—Å—Ç—Ä–æ–π–∫–∞ —á–∞—Å—Ç–æ—Ç—ã

### PTM (Precision Time Measurement)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ PCIe PTM –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –≤—Ä–µ–º–µ–Ω–∏ —á–µ—Ä–µ–∑ —à–∏–Ω—É PCIe
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç –∑–∞–¥–µ—Ä–∂–µ–∫ –ø–µ—Ä–µ–¥–∞—á–∏

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–∞–º–∏
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤—Ö–æ–¥–æ–≤/–≤—ã—Ö–æ–¥–æ–≤ SMA (SubMiniature version A)
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏—Ö —Å–∏–≥–Ω–∞–ª–æ–≤
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–Ω–µ—à–Ω–∏—Ö –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫

## –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å sysfs

–î—Ä–∞–π–≤–µ—Ä —Å–æ–∑–¥–∞–µ—Ç –∫–ª–∞—Å—Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ `/sys/class/timecard/ocpN/`, –≥–¥–µ N - –ø–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (–Ω–∞—á–∏–Ω–∞—è —Å 0). –≠—Ç–æ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –∞—Ç—Ä–∏–±—É—Ç—ã:

### –û—Å–Ω–æ–≤–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
- `clock_source` - –≤—ã–±–æ—Ä –∏—Å—Ç–æ—á–Ω–∏–∫–∞ —á–∞—Å–æ–≤ (GNSS, MAC, IRIG-B, external)
- `available_clock_sources` - —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –≤—Ä–µ–º–µ–Ω–∏
- `sma[1-4]_in/out` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è SMA –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä–æ–≤ –∫–∞–∫ –≤—Ö–æ–¥–æ–≤ –∏–ª–∏ –≤—ã—Ö–æ–¥–æ–≤
- `available_sma_inputs/outputs` - –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã –¥–ª—è SMA –ø–æ—Ä—Ç–æ–≤

### –ê—Ç—Ä–∏–±—É—Ç—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∏ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏:
- `gnss_sync` - —Å—Ç–∞—Ç—É—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å GNSS —Å–ø—É—Ç–Ω–∏–∫–∞–º–∏
- `external_pps_cable_delay` - –∑–∞–¥–µ—Ä–∂–∫–∞ –≤–Ω–µ—à–Ω–µ–≥–æ PPS –∫–∞–±–µ–ª—è (–Ω—Å)
- `internal_pps_cable_delay` - –∑–∞–¥–µ—Ä–∂–∫–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ PPS –∫–∞–±–µ–ª—è (–Ω—Å)
- ~~`pci_delay`~~ - –∑–∞–¥–µ—Ä–∂–∫–∞ PCIe —à–∏–Ω—ã (**–ù–ï –ü–û–î–î–ï–†–ñ–ò–í–ê–ï–¢–°–Ø** –≤ —Ç–µ–∫—É—â–µ–º –¥—Ä–∞–π–≤–µ—Ä–µ)
- `utc_tai_offset` - —Å–º–µ—â–µ–Ω–∏–µ UTC –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ TAI (—Å–µ–∫—É–Ω–¥—ã)

### –°–ª—É–∂–µ–±–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã:
- `serialnum` - —Å–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- `irig_b_mode` - —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã IRIG-B
- `uevent` - —Å–æ–±—ã—Ç–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

### –°–∏–º–≤–æ–ª–∏—á–µ—Å–∫–∏–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞:
- `device` -> `../../../XXXX:XX:XX.X` - —Å—Å—ã–ª–∫–∞ –Ω–∞ PCI —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
- `ptp` -> `../../ptp/ptpX` - —Å—Å—ã–ª–∫–∞ –Ω–∞ PTP —á–∞—Å—ã
- `ttyGNSS` -> `../../tty/ttyX` - —Å—Å—ã–ª–∫–∞ –Ω–∞ GNSS –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –ø–æ—Ä—Ç
- `ttyMAC` -> `../../tty/ttyX` - —Å—Å—ã–ª–∫–∞ –Ω–∞ MAC –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –ø–æ—Ä—Ç
- `ttyNMEA` -> `../../tty/ttyX` - —Å—Å—ã–ª–∫–∞ –Ω–∞ NMEA –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –ø–æ—Ä—Ç
- `subsystem` -> `../../../../../../class/timecard` - —Å—Å—ã–ª–∫–∞ –Ω–∞ –∫–ª–∞—Å—Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

### –î–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏:
- `power/` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∏—Ç–∞–Ω–∏–µ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–æ—à–∏–≤–æ–∫
- –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—à–∏–≤–∫–∏ —á–µ—Ä–µ–∑ devlink
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –ø—Ä–æ—à–∏–≤–∫–∏ —Å –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ–º
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è FPGA –∏ SOM

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- –°—Ç–æ—Ä–æ–∂–µ–≤–æ–π —Ç–∞–π–º–µ—Ä –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ —Å–±–æ—è—Ö
- –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ MSI-X –¥–ª—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–¥–µ—Ä–∂–µ–∫ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π
- –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ —Ä–µ–≥–∏—Å—Ç—Ä–∞–º —á–µ—Ä–µ–∑ MMIO
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

### –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ –ø–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é –ø–∏—Ç–∞–Ω–∏–µ–º
- –ù–∞ —Ç–µ–∫—É—â–∏–π –º–æ–º–µ–Ω—Ç `suspend/resume` –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã; —Å–º. —Ä–∞–∑–¥–µ–ª —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é.

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–î—Ä–∞–π–≤–µ—Ä ptp_ocp –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–∞—Ä—Ç–∞–º–∏ —Ç–æ—á–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –≤ Linux. –û–Ω –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≤—ã—Å–æ–∫–æ—Ç–æ—á–Ω—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –≤—Ä–µ–º–µ–Ω–∏, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–≤ –∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤, –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≥–∏–±–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—Å–µ–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –∫–∞—Ä—Ç—ã.

---

### 33. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ E: –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ Chrony ‚Äî –ø–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç

# –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ Chrony

## –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ
1. [–í–≤–µ–¥–µ–Ω–∏–µ –≤ Chrony](#–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-chrony)
2. [–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–∏-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞)
3. [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã](#–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ-—Ñ–∞–π–ª—ã)
4. [–ö–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è](#–∫–æ–º–∞–Ω–¥—ã-—É–ø—Ä–∞–≤–ª–µ–Ω–∏—è)
5. [–†–∞–±–æ—Ç–∞ —Å PTP —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏](#—Ä–∞–±–æ—Ç–∞-—Å-ptp-—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏)
6. [–°–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏](#—Å–∫—Ä–∏–ø—Ç—ã-–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏)
7. [–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞](#–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–∏-–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞)
8. [–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫](#—É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ-–Ω–µ–ø–æ–ª–∞–¥–æ–∫)
9. [–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å TimeCard](#–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-—Å-timecard)

## –í–≤–µ–¥–µ–Ω–∏–µ –≤ Chrony

Chrony - —ç—Ç–æ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ NTP (Network Time Protocol), –∫–æ—Ç–æ—Ä–∞—è –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ç–æ—á–Ω—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —á–∞—Å–æ–≤ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ —Å NTP —Å–µ—Ä–≤–µ—Ä–∞–º–∏, —Ä–µ—Ñ–µ—Ä–µ–Ω—Å–Ω—ã–º–∏ —á–∞—Å–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, GPS –ø—Ä–∏–µ–º–Ω–∏–∫–æ–º) –∏–ª–∏ —Ä—É—á–Ω—ã–º –≤–≤–æ–¥–æ–º –≤—Ä–µ–º–µ–Ω–∏.

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- **chronyd** - –¥–µ–º–æ–Ω, –≤—ã–ø–æ–ª–Ω—è—é—â–∏–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é
- **chronyc** - —É—Ç–∏–ª–∏—Ç–∞ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Chrony:
- –ë—ã—Å—Ç—Ä–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏
- –†–∞–±–æ—Ç–∞ —Å –ø—Ä–µ—Ä—ã–≤–∏—Å—Ç—ã–º —Å–µ—Ç–µ–≤—ã–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ–º
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã—Ö —á–∞—Å–æ–≤ (PHC)
- –ù–∏–∑–∫–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
- –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–º–∏ –º–∞—à–∏–Ω–∞–º–∏

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏–∑ –ø–∞–∫–µ—Ç–Ω–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞

#### Debian/Ubuntu:
```bash
sudo apt update
sudo apt install chrony
```

#### RHEL/CentOS/Fedora:
```bash
sudo yum install chrony
# –∏–ª–∏ –¥–ª—è –Ω–æ–≤—ã—Ö –≤–µ—Ä—Å–∏–π
sudo dnf install chrony
```

#### openSUSE:
```bash
sudo zypper install chrony
```

### –ë–∞–∑–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ:

1. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª `/etc/chrony/chrony.conf`
2. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–ª—É–∂–±—É chronyd
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

```bash
# –ó–∞–ø—É—Å–∫ —Å–ª—É–∂–±—ã
sudo systemctl start chronyd
sudo systemctl enable chronyd

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
chronyc tracking
chronyc sources
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π

–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–æ–º–∞–Ω–¥ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –¥–æ—Å—Ç—É–ø:

```bash
# –í /etc/chrony/chrony.conf –¥–æ–±–∞–≤–∏—Ç—å:
allow 127.0.0.1
bindcmdaddress 127.0.0.1
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

–§–∞–π–ª `/etc/chrony/chrony.conf` —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ chronyd.

#### –ë–∞–∑–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:
```bash
# –°–µ—Ä–≤–µ—Ä—ã –≤—Ä–µ–º–µ–Ω–∏
pool 2.pool.ntp.org iburst
server time1.google.com iburst
server time2.google.com iburst

# –§–∞–π–ª –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –¥—Ä–µ–π—Ñ–µ —á–∞—Å–æ–≤
driftfile /var/lib/chrony/drift

# –†–∞–∑—Ä–µ—à–∏—Ç—å –ø–æ—à–∞–≥–æ–≤—É—é –∫–æ—Ä—Ä–µ–∫—Ü–∏—é –≤—Ä–µ–º–µ–Ω–∏
makestep 1.0 3

# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è RTC
rtcsync

# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
log tracking measurements statistics
logdir /var/log/chrony
```

### –†–∞–±–æ—Ç–∞ —Å PTP —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏

–î–ª—è —Ä–∞–±–æ—Ç—ã —Å PTP Hardware Clock (PHC):

```bash
# /etc/chrony/chrony.conf

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ PHC –∫–∞–∫ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –≤—Ä–µ–º–µ–Ω–∏
refclock PHC /dev/ptp0 poll 0 dpoll -2 offset 0 stratum 1 precision 1e-9

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ PPS —Å–∏–≥–Ω–∞–ª–∞
refclock PPS /dev/pps0 refid PPS precision 1e-9

# –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ PHC –∏ PPS
refclock PHC /dev/ptp0 poll 0 dpoll -2 offset 0 noselect
refclock PPS /dev/pps0 lock PHC precision 1e-9
```

## –ö–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã chronyc

```bash
# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–∫—É—â–µ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
chronyc tracking

# –°–ø–∏—Å–æ–∫ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –≤—Ä–µ–º–µ–Ω–∏
chronyc sources -v

# –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
chronyc sourcestats

# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —á–∞—Å–∞—Ö
chronyc rtcdata

# –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
chronyc makestep

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
chronyc add server time.example.com

# –£–¥–∞–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞
chronyc delete time.example.com
```


## –†–∞–±–æ—Ç–∞ —Å PTP —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å LinuxPTP

Chrony –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å–æ–≤–º–µ—Å—Ç–Ω–æ —Å LinuxPTP –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –≤—ã—Å–æ–∫–æ—Ç–æ—á–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:

```bash
# –ó–∞–ø—É—Å–∫ ptp4l –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ PHC
sudo ptp4l -i eth0 -m

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ PHC –≤ chrony
# /etc/chrony/chrony.conf
refclock PHC /dev/ptp0 poll 0 dpoll -2 offset 0
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è TimeCard

–°–ø–µ—Ü–∏—Ñ–∏—á–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è TimeCard —É—Å—Ç—Ä–æ–π—Å—Ç–≤:

```bash
# /etc/chrony/chrony.conf

# TimeCard PHC –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫
refclock PHC /dev/ptp0 poll 0 dpoll -2 offset 0 stratum 1 prefer

# –†–µ–∑–µ—Ä–≤–Ω—ã–µ NTP —Å–µ—Ä–≤–µ—Ä—ã
server 0.pool.ntp.org iburst
server 1.pool.ntp.org iburst

# –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—á–∞–ª—å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
makestep 1.0 3

# –¢–æ—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
maxupdateskew 100.0
corrtimeratio 3
maxdrift 500
```

## –°–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

```bash
#!/bin/bash
# install_chrony.sh - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –±–∞–∑–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Chrony

set -e

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤–∞
detect_distro() {
    if [ -f /etc/os-release ]; then
        . /etc/os-release
        echo $ID
    else
        echo "unknown"
    fi
}

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Chrony
install_chrony() {
    local distro=$(detect_distro)
    
    echo "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ Chrony –¥–ª—è –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤–∞: $distro"
    
    case $distro in
        ubuntu|debian)
            sudo apt update
            sudo apt install -y chrony
            ;;
        rhel|centos|fedora)
            sudo yum install -y chrony || sudo dnf install -y chrony
            ;;
        opensuse*)
            sudo zypper install -y chrony
            ;;
        *)
            echo "–ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤: $distro"
            exit 1
            ;;
    esac
}

# –ë–∞–∑–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
configure_chrony() {
    echo "–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏..."
    
    # Backup –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ñ–∏–≥–∞
    sudo cp /etc/chrony/chrony.conf /etc/chrony/chrony.conf.backup
    
    # –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
    cat << EOF | sudo tee /etc/chrony/chrony.conf
# Chrony configuration
# Generated by install_chrony.sh

# NTP servers
pool 2.pool.ntp.org iburst
server time1.google.com iburst
server time2.google.com iburst
server time3.google.com iburst

# Record the rate at which the system clock gains/losses time
driftfile /var/lib/chrony/drift

# Allow the system clock to be stepped in the first three updates
makestep 1.0 3

# Enable kernel synchronisation of the real-time clock
rtcsync

# Increase the minimum number of selectable sources
minsources 2

# Allow NTP client access from local network
allow 192.168.0.0/16
allow 10.0.0.0/8

# Serve time even if not synchronized to a time source
local stratum 10

# Specify file containing keys for NTP authentication
keyfile /etc/chrony/chrony.keys

# Specify directory for log files
logdir /var/log/chrony

# Select which information is logged
log measurements statistics tracking
EOF
}

# –ó–∞–ø—É—Å–∫ –∏ –≤–∫–ª—é—á–µ–Ω–∏–µ —Å–ª—É–∂–±—ã
start_service() {
    echo "–ó–∞–ø—É—Å–∫ —Å–ª—É–∂–±—ã chronyd..."
    sudo systemctl restart chronyd
    sudo systemctl enable chronyd
}

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã
verify_installation() {
    echo "–ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏..."
    sleep 5
    
    if systemctl is-active --quiet chronyd; then
        echo "‚úì –°–ª—É–∂–±–∞ chronyd –∞–∫—Ç–∏–≤–Ω–∞"
    else
        echo "‚úó –°–ª—É–∂–±–∞ chronyd –Ω–µ –∑–∞–ø—É—â–µ–Ω–∞"
        return 1
    fi
    
    echo -e "\n–°—Ç–∞—Ç—É—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:"
    chronyc tracking
    
    echo -e "\n–ò—Å—Ç–æ—á–Ω–∏–∫–∏ –≤—Ä–µ–º–µ–Ω–∏:"
    chronyc sources
}

# –û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ—Ü–µ—Å—Å
main() {
    echo "=== –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Chrony ==="
    
    install_chrony
    configure_chrony
    start_service
    verify_installation
    
    echo -e "\n=== –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ ==="
    echo "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ 'chronyc' –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞"
}

main "$@"
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å PTP

```bash
#!/bin/bash
# setup_chrony_ptp.sh - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Chrony –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å PTP —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏

set -e

PTP_DEVICE=${1:-/dev/ptp0}
CHRONY_CONF="/etc/chrony/chrony.conf"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è PTP —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
check_ptp_device() {
    if [ ! -c "$PTP_DEVICE" ]; then
        echo "–û—à–∏–±–∫–∞: PTP —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ $PTP_DEVICE –Ω–µ –Ω–∞–π–¥–µ–Ω–æ"
        echo "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: $0 [/dev/ptp_device]"
        exit 1
    fi
    
    echo "–ù–∞–π–¥–µ–Ω–æ PTP —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ: $PTP_DEVICE"
}

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ PTP —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
detect_ptp_type() {
    local ptp_name=$(basename $PTP_DEVICE)
    local sys_path="/sys/class/ptp/$ptp_name"
    
    if [ -f "$sys_path/clock_name" ]; then
        local clock_name=$(cat "$sys_path/clock_name")
        echo "–¢–∏–ø —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞: $clock_name"
        
        if [[ "$clock_name" == *"OCP"* ]]; then
            echo "–û–±–Ω–∞—Ä—É–∂–µ–Ω–æ TimeCard —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ"
            return 0
        fi
    fi
    
    return 1
}

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Chrony –¥–ª—è PTP
configure_chrony_ptp() {
    echo "–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Chrony –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å PTP..."
    
    # Backup
    sudo cp $CHRONY_CONF ${CHRONY_CONF}.backup.$(date +%Y%m%d_%H%M%S)
    
    # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ PTP –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
    cat << EOF | sudo tee -a $CHRONY_CONF

# PTP Hardware Clock configuration
# Added by setup_chrony_ptp.sh

# Primary time source - PTP Hardware Clock
refclock PHC $PTP_DEVICE poll 0 dpoll -2 offset 0 stratum 1 precision 1e-9 prefer

# Optional: PPS signal if available
# refclock PPS /dev/pps0 lock PHC precision 1e-9

# Backup NTP servers
server 0.pool.ntp.org iburst
server 1.pool.ntp.org iburst
server 2.pool.ntp.org iburst

# Increase clock adjustment speed for PTP
corrtimeratio 10
maxdrift 100

# Log PTP statistics
log refclocks measurements statistics
EOF
}

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è TimeCard
configure_timecard_specific() {
    echo "–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ –¥–ª—è TimeCard..."
    
    cat << EOF | sudo tee -a $CHRONY_CONF

# TimeCard specific settings
# High precision mode
maxupdateskew 5.0
maxslewrate 1000.0

# Prefer hardware timestamps
hwtimestamp *
EOF
}

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ Chrony
restart_chrony() {
    echo "–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ chronyd..."
    sudo systemctl restart chronyd
    sleep 3
}

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
verify_config() {
    echo -e "\n–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏..."
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
    chronyc sources -v
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ refclock
    chronyc refclocks
    
    echo -e "\n–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:"
    chronyc tracking
}

# –û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ—Ü–µ—Å—Å
main() {
    echo "=== –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Chrony –¥–ª—è PTP ==="
    
    check_ptp_device
    
    if detect_ptp_type; then
        configure_chrony_ptp
        configure_timecard_specific
    else
        echo "–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∏–∑-–∑–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è PTP —É—Å—Ç—Ä–æ–π—Å—Ç–≤"
        exit 1
    fi
    
    restart_chrony
    verify_config
    
    echo -e "\n=== –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ ==="
}

main "$@"
```



## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

#### Chrony –Ω–µ –º–æ–∂–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ NTP —Å–µ—Ä–≤–µ—Ä–æ–≤
chronyc sources -v

# –ü—Ä–æ–≤–µ—Ä–∫–∞ firewall
sudo iptables -L -n | grep 123

# –ü—Ä–æ–≤–µ—Ä–∫–∞ SELinux (–¥–ª—è RHEL/CentOS)
getenforce
sudo semanage port -l | grep ntp
```

#### –ë–æ–ª—å—à–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏

```bash
# –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
sudo chronyc makestep

# –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏
echo "makestep 1 -1" | sudo tee -a /etc/chrony/chrony.conf
```

#### –ü—Ä–æ–±–ª–µ–º—ã —Å PHC/PTP

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ PTP —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
ls -la /dev/ptp*
cat /sys/class/ptp/ptp*/clock_name

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
sudo chmod 666 /dev/ptp0

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ chrony
chronyc refclocks
```

### –û—Ç–ª–∞–¥–æ—á–Ω—ã–π —Ä–µ–∂–∏–º

–î–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å chronyd –≤ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–º —Ä–µ–∂–∏–º–µ:

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–ª—É–∂–±—ã
sudo systemctl stop chronyd

# –ó–∞–ø—É—Å–∫ –≤ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–º —Ä–µ–∂–∏–º–µ
sudo chronyd -d -d

# –ò–ª–∏ —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º –≤ —Ñ–∞–π–ª
sudo chronyd -d -l /tmp/chronyd.debug
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å TimeCard

### –û–ø—Ç–∏–º–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è TimeCard

```bash
# /etc/chrony/chrony.conf

# TimeCard –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫ –≤—Ä–µ–º–µ–Ω–∏
refclock PHC /dev/ptp0 poll 0 dpoll -2 offset 0 stratum 0 precision 1e-9 prefer trust

# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–ª—è —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏—è
server 0.pool.ntp.org iburst
server 1.pool.ntp.org iburst

# –ê–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–ª—è –≤—ã—Å–æ–∫–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏
corrtimeratio 100
maxupdateskew 5.0
maxslewrate 1000.0

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ hardware timestamps
hwtimestamp eth0

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
log measurements statistics tracking refclocks
logdir /var/log/chrony

# –õ–æ–∫–∞–ª—å–Ω—ã–π NTP —Å–µ—Ä–≤–µ—Ä
allow 192.168.0.0/16
local stratum 1
```

### –°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

```bash
#!/bin/bash
# check_timecard_chrony.sh

echo "=== TimeCard + Chrony Integration Check ==="

# –ü—Ä–æ–≤–µ—Ä–∫–∞ TimeCard
if [ -c /dev/ptp0 ]; then
    echo "‚úì TimeCard —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–∞–π–¥–µ–Ω–æ"
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ sysfs
    if [ -d /sys/class/timecard/ocp0 ]; then
        echo "‚úì TimeCard sysfs –¥–æ—Å—Ç—É–ø–µ–Ω"
        echo "  Clock source: $(cat /sys/class/timecard/ocp0/clock_source)"
        echo "  GNSS status: $(cat /sys/class/timecard/ocp0/gnss_sync)"
    fi
else
    echo "‚úó TimeCard —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ"
fi

# –ü—Ä–æ–≤–µ—Ä–∫–∞ Chrony
if systemctl is-active --quiet chronyd; then
    echo "‚úì Chronyd –∞–∫—Ç–∏–≤–µ–Ω"
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è PHC
    if chronyc refclocks | grep -q PHC; then
        echo "‚úì PHC –∏—Å—Ç–æ—á–Ω–∏–∫ –Ω–∞—Å—Ç—Ä–æ–µ–Ω"
        chronyc refclocks
    else
        echo "‚úó PHC –∏—Å—Ç–æ—á–Ω–∏–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω"
    fi
else
    echo "‚úó Chronyd –Ω–µ –∑–∞–ø—É—â–µ–Ω"
fi

echo -e "\n=== –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ ==="
chronyc tracking
```

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

Chrony –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≥–∏–±–∫—É—é –∏ –Ω–∞–¥–µ–∂–Ω—É—é —Å–∏—Å—Ç–µ–º—É —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –≤—Ä–µ–º–µ–Ω–∏, –æ—Å–æ–±–µ–Ω–Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã–º–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏ –≤—Ä–µ–º–µ–Ω–∏, —Ç–∞–∫–∏–º–∏ –∫–∞–∫ TimeCard. –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ–∑–≤–æ–ª—è—é—Ç –¥–æ—Å—Ç–∏—á—å –º–∏–∫—Ä–æ—Å–µ–∫—É–Ω–¥–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏.

### –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏
- [–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Chrony](https://chrony.tuxfamily.org/documentation.html)
- [Chrony FAQ](https://chrony.tuxfamily.org/faq.html)
- [–°—Ä–∞–≤–Ω–µ–Ω–∏–µ Chrony –∏ NTPd](https://chrony.tuxfamily.org/comparison.html)

---

### 34. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ F: –î–µ—Ç–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è ‚Äî –ø–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç

# –î–µ—Ç–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

## –û–±–∑–æ—Ä

–ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –¥—Ä–∞–π–≤–µ—Ä–∞ PTP OCP –∏ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è    ‚îÇ    ‚îÇ   LinuxPTP      ‚îÇ    ‚îÇ   Chrony/NTP    ‚îÇ
‚îÇ                 ‚îÇ    ‚îÇ   (ptp4l)       ‚îÇ    ‚îÇ                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ                       ‚îÇ                       ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                        –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ                       ‚îÇ                       ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                           –Ø–¥—Ä–æ Linux                            ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ PTP Core    ‚îÇ    ‚îÇ Network     ‚îÇ    ‚îÇ   Timekeeping       ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ Subsystem   ‚îÇ    ‚îÇ Stack       ‚îÇ    ‚îÇ   Subsystem         ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                       PTP OCP Driver                           ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê              ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ TimeCard Class  ‚îÇ              ‚îÇ    PTP Interface        ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ /sys/class/     ‚îÇ              ‚îÇ    /sys/class/ptp/      ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ timecard/ocpN/  ‚îÇ  <-------->  ‚îÇ    /dev/ptp*           ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò              ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                       PCI Hardware                             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥—Ä–∞–π–≤–µ—Ä–∞

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥—É–ª—è

#### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

```bash
# –§–∞–π–ª: /etc/modprobe.d/ptp-ocp.conf

# –£—Ä–æ–≤–µ–Ω—å –æ—Ç–ª–∞–¥–∫–∏ (0-7)
options ptp_ocp debug=0

# –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –≤–∫–ª—é—á–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
options ptp_ocp force_enable=0

# –¢–∞–π–º–∞—É—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (–≤ —Å–µ–∫—É–Ω–¥–∞—Ö)
options ptp_ocp init_timeout=30

# –†–µ–∂–∏–º GPIO
options ptp_ocp gpio_mode=auto
```

#### –û—Ç–ª–∞–¥–æ—á–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

```bash
# –î–µ—Ç–∞–ª—å–Ω–∞—è –æ—Ç–ª–∞–¥–∫–∞
options ptp_ocp debug=7

# –û—Ç–ª–∞–¥–∫–∞ —Ç–æ–ª—å–∫–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
options ptp_ocp debug=1

# –û—Ç–ª–∞–¥–∫–∞ GPIO –æ–ø–µ—Ä–∞—Ü–∏–π
options ptp_ocp gpio_debug=1
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ sysfs

#### –û—Å–Ω–æ–≤–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã

```bash
# –ë–∞–∑–æ–≤—ã–π –ø—É—Ç—å –∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤—É
PTP_DEVICE="/sys/class/ptp/ptp0"

# –ß—Ç–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —á–∞—Å–∞—Ö
cat $PTP_DEVICE/clock_name
cat $PTP_DEVICE/max_adjustment

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–∏–Ω–æ–≤
echo "1 2 0" > $PTP_DEVICE/pins/pin0
echo "2 3 0" > $PTP_DEVICE/pins/pin1
```

#### GPIO –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```bash
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ GPIO –ø–∏–Ω–æ–≤
GPIO_BASE="/sys/class/ptp/ptp0"

# –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø–∏–Ω–æ–≤
ls $GPIO_BASE/pins/

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–∏–Ω–∞ –∫–∞–∫ –≤—ã—Ö–æ–¥
echo "perout 0 0" > $GPIO_BASE/pins/SMA1

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–∏–Ω–∞ –∫–∞–∫ –≤—Ö–æ–¥
echo "extts 0 0" > $GPIO_BASE/pins/SMA2
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è TimeCard

#### –û—Å–Ω–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å TimeCard

```bash
# –ë–∞–∑–æ–≤—ã–π –ø—É—Ç—å –∫ TimeCard —É—Å—Ç—Ä–æ–π—Å—Ç–≤—É
TIMECARD_BASE="/sys/class/timecard/ocp0"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
if [ -d "$TIMECARD_BASE" ]; then
    echo "TimeCard device found"
else
    echo "TimeCard device not found"
    exit 1
fi

# –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –≤—Ä–µ–º–µ–Ω–∏
cat $TIMECARD_BASE/available_clock_sources

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –≤—Ä–µ–º–µ–Ω–∏
echo "GNSS" > $TIMECARD_BASE/clock_source

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ GNSS
cat $TIMECARD_BASE/gnss_sync
```

#### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è SMA –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä–æ–≤

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤
cat $TIMECARD_BASE/available_sma_inputs
cat $TIMECARD_BASE/available_sma_outputs

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SMA1 –∫–∞–∫ –≤—Ö–æ–¥ –¥–ª—è 10MHz
echo "10MHz" > $TIMECARD_BASE/sma1_in

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SMA2 –∫–∞–∫ –≤—Ö–æ–¥ –¥–ª—è PPS
echo "PPS" > $TIMECARD_BASE/sma2

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SMA3 –∫–∞–∫ –≤—ã—Ö–æ–¥ 10MHz
echo "10MHz" > $TIMECARD_BASE/sma3

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SMA4 –∫–∞–∫ –≤—ã—Ö–æ–¥ PPS
echo "PPS" > $TIMECARD_BASE/sma4
```

#### –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –∑–∞–¥–µ—Ä–∂–µ–∫

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–µ—Ä–∂–∫–∏ –≤–Ω–µ—à–Ω–µ–≥–æ PPS –∫–∞–±–µ–ª—è (–≤ –Ω–∞–Ω–æ—Å–µ–∫—É–Ω–¥–∞—Ö)
echo "100" > $TIMECARD_BASE/external_pps_cable_delay

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–µ—Ä–∂–∫–∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ PPS
echo "50" > $TIMECARD_BASE/internal_pps_cable_delay

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–µ—Ä–∂–∫–∏ PCIe
# echo "25" > $TIMECARD_BASE/pci_delay  # –ù–ï –ü–û–î–î–ï–†–ñ–ò–í–ê–ï–¢–°–Ø

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–º–µ—â–µ–Ω–∏—è UTC-TAI (–≤ —Å–µ–∫—É–Ω–¥–∞—Ö)
echo "37" > $TIMECARD_BASE/utc_tai_offset

# –ö–æ—Ä—Ä–µ–∫—Ü–∏—è –æ–∫–Ω–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫ (–≤ –Ω–∞–Ω–æ—Å–µ–∫—É–Ω–¥–∞—Ö)
echo "0" > $TIMECARD_BASE/ts_window_adjust 2>/dev/null || echo "ts_window_adjust –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω"

# –ö–æ—Ä—Ä–µ–∫—Ü–∏—è TOD (–≤ –Ω–∞–Ω–æ—Å–µ–∫—É–Ω–¥–∞—Ö)
echo "0" > $TIMECARD_BASE/tod_correction 2>/dev/null || echo "tod_correction –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω"
```

#### –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ

```bash
# –°–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä
cat $TIMECARD_BASE/serialnum

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è IRIG-B
cat $TIMECARD_BASE/irig_b_mode
echo "B003" > $TIMECARD_BASE/irig_b_mode

# –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
PTP_DEV=$(basename $(readlink $TIMECARD_BASE/ptp))
GNSS_TTY=$(basename $(readlink $TIMECARD_BASE/ttyGNSS))
MAC_TTY=$(basename $(readlink $TIMECARD_BASE/ttyMAC))
NMEA_TTY=$(basename $(readlink $TIMECARD_BASE/ttyNMEA))

echo "PTP device: /dev/$PTP_DEV"
echo "GNSS port: /dev/$GNSS_TTY"
echo "MAC port: /dev/$MAC_TTY"
echo "NMEA port: /dev/$NMEA_TTY"

# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ—Ä—Ç—ã (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã)
GNSS2_TTY=$(basename $(readlink $TIMECARD_BASE/ttyGNSS2 2>/dev/null)) 2>/dev/null
[ -n "$GNSS2_TTY" ] && echo "GNSS2 port: /dev/$GNSS2_TTY"

# I2C —à–∏–Ω–∞ (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–∞)
I2C_BUS=$(basename $(readlink $TIMECARD_BASE/i2c 2>/dev/null)) 2>/dev/null
[ -n "$I2C_BUS" ] && echo "I2C bus: /dev/$I2C_BUS"
```

#### –†–∞–±–æ—Ç–∞ —Å –±–∏–Ω–∞—Ä–Ω—ã–º–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è–º–∏

```bash
# –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
cp $TIMECARD_BASE/config /backup/timecard_config_$(date +%Y%m%d).bin

# –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
cp $TIMECARD_BASE/disciplining_config /backup/disciplining_config_$(date +%Y%m%d).bin

# –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã
cp $TIMECARD_BASE/temperature_table /backup/temperature_table_$(date +%Y%m%d).bin

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–æ–≤ —Ñ–∞–π–ª–æ–≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
ls -la $TIMECARD_BASE/{config,disciplining_config,temperature_table} 2>/dev/null

# –í–ù–ò–ú–ê–ù–ò–ï: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π —Ç—Ä–µ–±—É–µ—Ç –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç–∏!
# cp /backup/timecard_config_YYYYMMDD.bin $TIMECARD_BASE/config
```

#### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ MAC I2C (–∞—Ç–æ–º–Ω—ã–µ —á–∞—Å—ã)

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ MAC I2C –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
if [ -f $TIMECARD_BASE/mac_i2c ]; then
    echo "MAC I2C interface available"
    
    # –ß—Ç–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è MAC I2C
    cat $TIMECARD_BASE/mac_i2c
    
    # –ü—Ä–∏–º–µ—Ä—ã –∫–æ–º–∞–Ω–¥ MAC I2C (–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ!)
    # echo "command" > $TIMECARD_BASE/mac_i2c
else
    echo "MAC I2C interface not available"
fi
```

#### –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```bash
#!/bin/bash
# –§–∞–π–ª: /usr/local/bin/configure-timecard.sh

TIMECARD_BASE="/sys/class/timecard/ocp0"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
if [ ! -d "$TIMECARD_BASE" ]; then
    echo "Error: TimeCard device not found"
    exit 1
fi

# –ë–∞–∑–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
echo "GNSS" > $TIMECARD_BASE/clock_source
echo "10MHz" > $TIMECARD_BASE/sma1_in
echo "PPS" > $TIMECARD_BASE/sma2
echo "10MHz" > $TIMECARD_BASE/sma3
echo "PPS" > $TIMECARD_BASE/sma4

# –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –∑–∞–¥–µ—Ä–∂–µ–∫ (–Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–æ–¥ –≤–∞—à–∏ –∫–∞–±–µ–ª–∏)
echo "100" > $TIMECARD_BASE/external_pps_cable_delay
echo "50" > $TIMECARD_BASE/internal_pps_cable_delay
# echo "25" > $TIMECARD_BASE/pci_delay  # –ù–ï –ü–û–î–î–ï–†–ñ–ò–í–ê–ï–¢–°–Ø
echo "37" > $TIMECARD_BASE/utc_tai_offset

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ IRIG-B
echo "B003" > $TIMECARD_BASE/irig_b_mode

echo "TimeCard configured successfully"

# –û–∂–∏–¥–∞–Ω–∏–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ GNSS
echo "Waiting for GNSS sync..."
timeout=60
while [ $timeout -gt 0 ]; do
    sync_status=$(cat $TIMECARD_BASE/gnss_sync)
    if [ "$sync_status" = "locked" ]; then
        echo "GNSS synchronized"
        break
    fi
    sleep 1
    timeout=$((timeout - 1))
done

if [ $timeout -eq 0 ]; then
    echo "Warning: GNSS sync timeout"
fi
```

## PTP –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ë–∞–∑–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è ptp4l

#### –§–∞–π–ª /etc/ptp4l.conf

```ini
[global]
# –û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
verbose                    1
time_stamping              hardware
tx_timestamp_timeout       50
use_syslog                 1
logSyncInterval           -3
logMinDelayReqInterval    -3
logAnnounceInterval        1
announceReceiptTimeout     3
syncReceiptTimeout         0
delay_mechanism            E2E
network_transport          UDPv4

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–æ–º–µ–Ω–∞
domainNumber               0
priority1                  128
priority2                  128
clockClass                 248
clockAccuracy              0xFE
offsetScaledLogVariance    0xFFFF

# –ü—Ä–æ—Ñ–∏–ª—å –≤—Ä–µ–º–µ–Ω–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
dataset_comparison         ieee1588
G.8275.defaultDS.localPriority 128

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞
serverOnly                 0
slaveOnly                  0
free_running               0

# –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ —Å–µ—Ä–≤–æ—Å–∏—Å—Ç–µ–º–∞
step_threshold             0.000002
first_step_threshold       0.000020
max_frequency              900000000
clock_servo                pi
pi_proportional_const      0.0
pi_integral_const          0.0
pi_proportional_scale      0.0
pi_proportional_exponent   -0.3
pi_proportional_norm_max   0.7
pi_integral_scale          0.0
pi_integral_exponent       0.4
pi_integral_norm_max       0.3

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ç–∏
dscp_event                 46
dscp_general               34
socket_priority            0

[eth0]
# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ç–µ–≤–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
network_transport          UDPv4
delay_mechanism            E2E
```

### –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

#### –¢–µ–ª–µ–∫–æ–º –ø—Ä–æ—Ñ–∏–ª—å (G.8275.1)

```ini
[global]
dataset_comparison         G.8275.x
G.8275.defaultDS.localPriority 128
domainNumber               24
priority1                  128
priority2                  128
clockClass                 165
clockAccuracy              0x21
offsetScaledLogVariance    0x4E5D
free_running               0
freq_est_interval          1
assume_two_step            0
tx_timestamp_timeout       10
check_fup_sync             0
clock_servo                linreg
step_threshold             0.000002
first_step_threshold       0.000020
max_frequency              900000000
sanity_freq_limit          200000000
ntpshm_segment             0
msg_interval_request       0
servo_num_offset_values    10
servo_offset_threshold     0
write_phase_mode           0
network_transport          L2
ptp_dst_mac                01:1B:19:00:00:00
p2p_dst_mac                01:80:C2:00:00:0E
udp6_scope                 0x0E
uds_address                /var/run/ptp4l
logging_level              6
verbose                    0
use_syslog                 1
userDescription            "PTP OCP Telecom Profile"
manufacturerIdentity       00:00:00
summary_interval           0
kernel_leap                1
check_fup_sync             0
clock_class_threshold      7
G.8275.portDS.localPriority 128

[eth0]
logAnnounceInterval        0
logSyncInterval           -4
logMinDelayReqInterval    -4
logMinPdelayReqInterval   -4
announceReceiptTimeout     3
syncReceiptTimeout         3
delay_mechanism            P2P
network_transport          L2
masterOnly                 0
G.8275.portDS.localPriority 128
```

#### High Accuracy Profile

```ini
[global]
dataset_comparison         ieee1588
domainNumber               0
priority1                  128
priority2                  128
clockClass                 6
clockAccuracy              0x20
offsetScaledLogVariance    0x436A
free_running               0
freq_est_interval          1
assume_two_step            0
tx_timestamp_timeout       1
check_fup_sync             0
clock_servo                pi
step_threshold             0.000000002
first_step_threshold       0.000000020
max_frequency              900000000
pi_proportional_const      0.0
pi_integral_const          0.0
pi_proportional_scale      0.0
pi_proportional_exponent   -0.3
pi_proportional_norm_max   0.7
pi_integral_scale          0.0
pi_integral_exponent       0.4
pi_integral_norm_max       0.3
servo_num_offset_values    10
servo_offset_threshold     0
write_phase_mode           0
network_transport          UDPv4
delay_mechanism            E2E
time_stamping              hardware
twoStepFlag                1
summary_interval           0
kernel_leap                1
check_fup_sync             0

[eth0]
logAnnounceInterval       -2
logSyncInterval           -5
logMinDelayReqInterval    -5
announceReceiptTimeout     3
syncReceiptTimeout         3
delay_mechanism            E2E
network_transport          UDPv4
```

## –°–µ—Ç–µ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ç–µ–≤–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

#### Hardware timestamping

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏
ethtool -T eth0

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –¥–ª—è PTP
sudo ethtool -s eth0 speed 1000 duplex full autoneg off

# –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –±—É—Ñ–µ—Ä–æ–≤
sudo ethtool -G eth0 rx 4096 tx 4096
sudo ethtool -C eth0 rx-usecs 1 tx-usecs 1
```

#### Multicast –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```bash
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ multicast –¥–ª—è PTP
sudo ip maddr add 01:1b:19:00:00:00 dev eth0
sudo ip maddr add 01:80:c2:00:00:0e dev eth0

# –ü—Ä–æ–≤–µ—Ä–∫–∞ multicast –≥—Ä—É–ø–ø
ip maddr show dev eth0
```

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

#### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ IRQ affinity

```bash
#!/bin/bash
# –°–∫—Ä–∏–ø—Ç –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ IRQ affinity

# –ù–∞–π—Ç–∏ IRQ –¥–ª—è —Å–µ—Ç–µ–≤–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
ETH_IRQ=$(grep eth0 /proc/interrupts | awk -F: '{print $1}' | tr -d ' ')

# –ü—Ä–∏–≤—è–∑–∞—Ç—å IRQ –∫ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º—É CPU
echo 2 > /proc/irq/$ETH_IRQ/smp_affinity

# –ò–∑–æ–ª—è—Ü–∏—è CPU –¥–ª—è real-time –æ–±—Ä–∞–±–æ—Ç–∫–∏
echo 2 > /sys/devices/system/cpu/cpu1/cpufreq/scaling_governor
```

#### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —è–¥—Ä–∞ –¥–ª—è real-time

```bash
# –§–∞–π–ª: /etc/default/grub
GRUB_CMDLINE_LINUX_DEFAULT="quiet splash isolcpus=1,2 nohz_full=1,2 rcu_nocbs=1,2"

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ grub
sudo update-grub
```

## Chrony –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è chronyd

#### –§–∞–π–ª /etc/chrony/chrony.conf

```bash
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ PTP –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –≤—Ä–µ–º–µ–Ω–∏
refclock PHC /dev/ptp0 poll 0 dpoll -2 offset 0 stratum 1

# –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏
server 0.pool.ntp.org iburst
server 1.pool.ntp.org iburst
server 2.pool.ntp.org iburst

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
makestep 1.0 3
rtcsync
driftfile /var/lib/chrony/drift
logdir /var/log/chrony

# –†–∞–∑—Ä–µ—à–µ–Ω–∏—è
allow 192.168.0.0/16
allow 10.0.0.0/8

# –õ–æ–∫–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
local stratum 2
smoothtime 400 0.01 leaponly
```

### phc2sys –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

#### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

```bash
# Systemd —Å–µ—Ä–≤–∏—Å: /etc/systemd/system/phc2sys.service
[Unit]
Description=Synchronize system clock to PTP hardware clock
After=ptp4l.service
Requires=ptp4l.service

[Service]
ExecStart=/usr/sbin/phc2sys -s /dev/ptp0 -c CLOCK_REALTIME -w -m -q -R 256
Restart=always
RestartSec=5

[Install]
WantedBy=multi-user.target
```


## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ firewall

```bash
# PTP –ø–æ—Ä—Ç—ã
sudo ufw allow 319/udp comment "PTP Event"
sudo ufw allow 320/udp comment "PTP General"

# –î–ª—è multicast (–µ—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ)
sudo iptables -I INPUT -d 224.0.1.129 -j ACCEPT
sudo iptables -I INPUT -d 224.0.0.107 -j ACCEPT
```

### –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞

```bash
# –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ PTP —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º
# –§–∞–π–ª: /etc/security/limits.conf
@ptp    hard    rtprio    99
@ptp    soft    rtprio    99

# –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã –¥–ª—è PTP
sudo groupadd ptp
sudo usermod -a -G ptp ptp4l_user
```

## –ü—Ä–æ—Ñ–∏–ª–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π

### Telecom –ø—Ä–æ—Ñ–∏–ª—å

–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è —Ç–µ–ª–µ–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã—Ö –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–π —Å –≤—ã—Å–æ–∫–∏–º–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ –∫ —Ç–æ—á–Ω–æ—Å—Ç–∏.

### Industrial –ø—Ä–æ—Ñ–∏–ª—å

–ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã—Ö –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Å–∏—Å—Ç–µ–º —Å —É–º–µ—Ä–µ–Ω–Ω—ã–º–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ –∫ —Ç–æ—á–Ω–æ—Å—Ç–∏.

### Datacenter –ø—Ä–æ—Ñ–∏–ª—å

–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –≤ –¥–∞—Ç–∞-—Ü–µ–Ω—Ç—Ä–∞—Ö —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Å–µ—Ä–≤–µ—Ä–æ–≤.

### Testing –ø—Ä–æ—Ñ–∏–ª—å

–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ—Ç–ª–∞–¥–∫–∏ —Å–∏—Å—Ç–µ–º—ã.
