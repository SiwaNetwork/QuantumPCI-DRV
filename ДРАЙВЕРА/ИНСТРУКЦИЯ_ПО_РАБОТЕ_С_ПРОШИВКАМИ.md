# Работа с прошивками

## Типы прошивок

- **Quantum Platforms** — магический заголовок "SHIW"

## Принцип работы

Используются разные магические заголовки в прошивке для идентификации типа устройства. Это позволяет:
1. Сохранить совместимость с существующими картами
2. Добавить поддержку Quantum Platforms карт
3. Избежать изменений в системных файлах

## Инструменты

- `simple_modify_firmware.sh` — создание прошивок и прошивка устройства
- `check_firmware_type.sh` — определение типа прошивки
- `switch_firmware_type.sh` — переключение типа прошивки

## Пошаговая инструкция

### 1. Создание прошивок

```bash
# Quantum Platforms
sudo ./simple_modify_firmware.sh quantum firmware_original.bin firmware_quantum.bin

```

### 2. Прошивка устройства

```bash
# Quantum Platforms
sudo ./simple_modify_firmware.sh flash firmware_quantum.bin "Quantum Platforms"

```

## Проверка результата

```bash
# Проверка типа прошивки
sudo ./check_firmware_type.sh

# Проверка через sysfs
cat /sys/devices/pci0000:00/0000:00:01.0/0000:01:00.0/timecard/ocp0/firmware_type
```

## Преимущества

1. Совместимость с существующими картами
2. Гибкость переключения между типами прошивок
3. Безопасность — не изменяет системные файлы
4. Простота управления через скрипты

## Устранение неполадок

### Ошибка "No firmware header found"
- Проверьте правильность магического заголовка
- Убедитесь, что драйвер поддерживает оба типа заголовков

### Ошибка при прошивке
- Проверьте права доступа к MTD-устройству
- Убедитесь, что устройство не занято другими процессами
